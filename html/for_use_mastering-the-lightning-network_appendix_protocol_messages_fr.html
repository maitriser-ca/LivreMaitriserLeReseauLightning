<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Messages du Wire Protocol</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-5">
<h2 id="messages">Appendix A: Messages du Wire Protocol</h2>
<div class="sectionbody">
<div class="paragraph data-line-7">
<p>Cette annexe répertorie tous les types de messages actuellement définis utilisés dans le protocole Lightning P2P. De plus, nous montrons la structure de chaque message, en regroupant les messages en groupes logiques basés sur les flux de protocole.</p>
</div>
<div class="admonitionblock note data-line-10">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-11">
<p>Les messages du protocole Lightning sont extensibles et leur structure peut être modifiée lors de mises à jour globales du réseau. Pour les informations faisant autorité, consultez la dernière version des BOLT se trouvant dans le <a href="https://github.com/lightningnetwork/lightning-rfc" data-href="https://github.com/lightningnetwork/lightning-rfc">dépôt GitHub Lightning-RFC</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2 data-line-14">
<h3 id="_types_de_messages">Types de messages</h3>
<div class="paragraph data-line-16">
<p>Les types de messages actuellement définis sont répertoriés dans <a href="#apdx_message_types">Types de messages</a>.</p>
</div>
<table id="apdx_message_types" class="tableblock frame-all grid-all stretch data-line-21">
<caption class="title">Table 1. Types de messages</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type entier</th>
<th class="tableblock halign-left valign-top">Nom du message</th>
<th class="tableblock halign-left valign-top">Catégorie</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>init</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Établissement de connexion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Erreur de communication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Liveness de la connexion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pong</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Liveness de la connexion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>open_channel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Financement de canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">33</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>accept_channel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Financement de canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">34</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>funding_created</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Financement de canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">35</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>funding_signed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Financement de canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>funding_locked</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Financement de canal + Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">38</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shutdown</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fermeture de canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">39</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>closing_signed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fermeture de canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>update_add_htlc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">130</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>update_fulfill_hltc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">131</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>update_fail_htlc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">132</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>commit_sig</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">133</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>revoke_and_ack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">134</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>update_fee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">135</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>update_fail_malformed_htlc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">136</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>channel_reestablish</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>channel_announcement</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Annonce du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">257</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>node_announcement</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Annonce du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">258</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>channel_update</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Annonce du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">259</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>announce_signatures</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Annonce du canal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">261</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query_short_chan_ids</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synch. du graphe des canaux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">262</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reply_short_chan_ids_end</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synch. du graphe des canaux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">263</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query_channel_range</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synch. du graphe des canaux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">264</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reply_channel_range</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synch. du graphe des canaux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">265</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gossip_timestamp_range</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Synch. du graphe des canaux</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-53">
<p>Dans <a href="#message_types">[message_types]</a>, le champ <code>Catégorie</code> nous permet de catégoriser rapidement un
message basé sur sa fonctionnalité dans le protocole lui-même. À haut niveau,
nous plaçons un message dans l&#8217;une des huit catégories (non exhaustives) comprenant :</p>
</div>
<div class="dlist data-line-57">
<dl>
<dt class="hdlist1">Établissement de connexion</dt>
<dd>
<p>Envoyé lorsqu&#8217;une connexion pair-à-pair est établie
pour la première fois. Également utilisé pour négocier l&#8217;ensemble des fonctionnalités prises en charge
par une nouvelle connexion.</p>
</dd>
<dt class="hdlist1">Erreur de communication</dt>
<dd>
<p>Utilisé par les pairs pour communiquer l&#8217;occurrence d&#8217;erreur
au niveau du protocole entre elles.</p>
</dd>
<dt class="hdlist1">Liveness de la connexion</dt>
<dd>
<p>Utilisé par les pairs pour vérifier qu&#8217;une connexion de
de transport est toujours active.</p>
</dd>
<dt class="hdlist1">Financement du canal</dt>
<dd>
<p>Utilisé par les pairs pour créer un nouveau canal de paiement. Ce
processus est également connu sous le nom de processus de financement de canal.</p>
</dd>
<dt class="hdlist1">Exploitation du canal</dt>
<dd>
<p>L&#8217;acte de mettre à jour un canal donné hors chaîne. Cela
comprend l&#8217;envoi et la réception de paiements, ainsi que le transfert de paiements
au sein du réseau.</p>
</dd>
<dt class="hdlist1">Annonce du canal</dt>
<dd>
<p>Le processus d&#8217;annonce d&#8217;un nouveau canal public au
réseau au sens large afin qu&#8217;il puisse être utilisé à des fins de routage.</p>
</dd>
<dt class="hdlist1">Synchronisation du graphe des canaux</dt>
<dd>
<p>Le processus de téléchargement et de vérification du graphe
des canaux.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-81">
<p>Remarquez comme les messages appartenant à la même catégorie partagent généralement un
<em>type de message</em> adjacent également. Ceci est fait exprès pour regrouper
les messages sémantiquement similaires dans la spécification elle-même.</p>
</div>
</div>
<div class="sect2 data-line-85">
<h3 id="_structure_des_messages">Structure des messages</h3>
<div class="paragraph data-line-87">
<p>Nous détaillons maintenant chaque catégorie de message afin de définir
la structure et la sémantique précises de tous les messages définis sur le protocole
LN.</p>
</div>
<div class="sect3 data-line-91">
<h4 id="_messages_détablissement_de_connexion">Messages d&#8217;établissement de connexion</h4>
<div class="paragraph data-line-93">
<p>Les messages de cette catégorie sont le tout premier message envoyé entre pairs lorsqu&#8217;ils
établissent une connexion de transport. Au moment de la rédaction de ce chapitre,
il n&#8217;existe qu&#8217;un seul message dans cette catégorie, le message <code>init</code>.
Le message <code>init</code> est envoyé par <em>les deux</em> côtés de la connexion après qu&#8217;elle a été
établie préalablement. Aucun autre message ne doit être envoyé avant le message <code>init</code>
ne soit envoyé par les deux parties.</p>
</div>
<div class="sect4 data-line-102">
<h5 id="apdx_init_message">Le message init</h5>
<div class="paragraph data-line-104">
<p>La structure du message <code>init</code> est définie comme suit :</p>
</div>
<div class="ulist data-line-106">
<ul>
<li class="data-line-106">
<p>Type : 16</p>
</li>
<li class="data-line-107">
<p>Champs :</p>
<div class="ulist data-line-108">
<ul>
<li class="data-line-108">
<p><code>uint16</code>: <code>global_features_len</code></p>
</li>
<li class="data-line-109">
<p><code>global_features_len*byte</code>: <code>global_features</code></p>
</li>
<li class="data-line-110">
<p><code>uint16</code>: <code>features_len</code></p>
</li>
<li class="data-line-111">
<p><code>features_len*byte</code>: <code>features</code></p>
</li>
<li class="data-line-112">
<p><code>tlv_stream_tlvs</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-114">
<p>Structurellement, le message <code>init</code> est composé de deux tranches d&#8217;octets de taille variable
qui stockent chacun un ensemble de <em>bits de fonctionnalité</em>. Comme nous le voyons dans <a href="#feature_bits">[feature_bits]</a>, les bits de fonctionnalités sont une
primitive utilisée dans le protocole pour annoncer l&#8217;ensemble de fonctionnalités
du protocole qu&#8217;un nœud comprend (fonctionnalités facultatives) ou exige (fonctionnalités
requises).</p>
</div>
<div class="paragraph data-line-120">
<p>Notez que les implémentations modernes de nœuds n&#8217;utiliseront le champ <code>features</code>, avec
des éléments résidant dans le vecteur <code>global_features</code>, qu&#8217;à des fins <em>historiques</em>
principalement (compatibilité descendante).</p>
</div>
<div class="paragraph data-line-124">
<p>Ce qui suit après le message principal est une série d&#8217;enregistrements Type-Longueur-Valeur (Type-Length-Value ou TLV) qui peuvent être utilisés pour étendre le message d&#8217;une manière compatible de manière ascendante et descendante à l&#8217;avenir. Nous couvrirons ce que sont les enregistrements TLV et comment
ils sont utilisés plus loin dans cette annexe.</p>
</div>
<div class="paragraph data-line-127">
<p>Un message <code>init</code> est ensuite examiné par un pair pour déterminer si la
connexion est bien définie en fonction de l&#8217;ensemble des bits de fonctionnalités facultatives et requise
qui ont été annoncés par les deux côtés.</p>
</div>
<div class="paragraph data-line-131">
<p>Une fonctionnalité facultative signifie qu&#8217;un pair connaît une fonctionnalité, mais qu&#8217;il ne la
considère pas comme essentielle au fonctionnement d&#8217;une nouvelle connexion. Un exemple
serait quelque chose comme la capacité de comprendre la sémantique d&#8217;un nouveau
champ ajouté à un message existant.</p>
</div>
<div class="paragraph data-line-136">
<p>En revanche, les fonctionnalités requises indiquent que si l&#8217;autre pair ne
connaît pas la fonctionnalité, la connexion n&#8217;est pas bien définie. Un exemple de
d&#8217;une telle fonctionnalité serait un nouveau type de canal théorique dans le protocole : si
votre pair ne connaît pas cette fonctionnalité, alors vous ne voulez pas garder la
connexion car ils ne peuvent pas ouvrir votre nouveau type de canal préféré.</p>
</div>
</div>
</div>
<div class="sect3 data-line-142">
<h4 id="_messages_derreur_de_communication">Messages d&#8217;erreur de communication</h4>
<div class="paragraph data-line-144">
<p>Les messages de cette catégorie sont utilisés pour envoyer des erreurs au niveau de la connexion entre deux
pairs. Un autre type d&#8217;erreur existe dans le protocole : une
erreur de niveau de transfert HTLC. Les erreurs de niveau de connexion peuvent signaler des choses comme
une incompatibilité de bits de fonctionnalités ou l&#8217;intention de <em>forcer la fermeture</em> (diffuser
unilatéralement le dernier engagement signé).</p>
</div>
<div class="sect4 data-line-151">
<h5 id="apdx_error_message">Le message d&#8217;erreur</h5>
<div class="paragraph data-line-153">
<p>Le seul message de cette catégorie est le message <code>error</code>.</p>
</div>
<div class="ulist data-line-155">
<ul>
<li class="data-line-155">
<p>Type : 17</p>
</li>
<li class="data-line-156">
<p>Champs :</p>
<div class="ulist data-line-157">
<ul>
<li class="data-line-157">
<p><code>channel_id</code> : <code>chan_id</code></p>
</li>
<li class="data-line-158">
<p><code>uint16</code> : <code>data_len</code></p>
</li>
<li class="data-line-159">
<p><code>data_len*byte</code> : <code>data</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-161">
<p>Un message <code>error</code> peut être envoyé dans le cadre d&#8217;un canal particulier en
définissant le <code>channel_id</code> au <code>channel_id</code> du canal subissant ce
nouvel état d&#8217;erreur. Alternativement, si l&#8217;erreur s&#8217;applique à la connexion en
général, le champ <code>channel_id</code> doit être défini à zéro. Ce <code>channel_id</code>
entièrement à zéro est également connu comme l&#8217;identifiant de niveau de connexion pour une erreur.</p>
</div>
<div class="paragraph data-line-167">
<p>Selon la nature de l&#8217;erreur, l&#8217;envoi d&#8217;un message "error" à un pair avec lequel
vous avez un canal peut indiquer que le canal ne peut pas continuer sans
une intervention manuelle, donc la seule option à ce stade est de forcer la fermeture du
canal en diffusant le dernier état d&#8217;engagement du canal.</p>
</div>
</div>
</div>
<div class="sect3 data-line-172">
<h4 id="_liveness_de_la_connexion">Liveness de la connexion</h4>
<div class="paragraph data-line-174">
<p>Les messages de cette section sont utilisés pour déterminer si une connexion est
encore vivante ou non. Étant donné que le protocole LN fait quelque peu abstraction
du transport sous-jacent utilisé pour transmettre les messages, un ensemble de messages <code>ping</code>
et <code>pong</code> sont définis au niveau du protocole.</p>
</div>
<div class="sect4 data-line-180">
<h5 id="apdx_ping_message">Le message ping</h5>
<div class="paragraph data-line-182">
<p>Le message <code>ping</code> est utilisé pour vérifier si l&#8217;autre partie dans une connexion est "live". Il contient les champs suivants :</p>
</div>
<div class="ulist data-line-184">
<ul>
<li class="data-line-184">
<p>Type : 18</p>
</li>
<li class="data-line-185">
<p>Champs :</p>
<div class="ulist data-line-186">
<ul>
<li class="data-line-186">
<p><code>uint16</code> : <code>num_pong_bytes</code></p>
</li>
<li class="data-line-187">
<p><code>uint16</code> : <code>ping_body_len</code></p>
</li>
<li class="data-line-188">
<p><code>ping_body_len*bytes</code> : <code>ping_body</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-190">
<p>Ensuite son compagnon, le message <code>pong</code>.</p>
</div>
</div>
<div class="sect4 data-line-193">
<h5 id="apdx_pong_message">Le message pong</h5>
<div class="paragraph data-line-195">
<p>Le message pong est envoyé en réponse au message ping et contient les champs suivants :</p>
</div>
<div class="ulist data-line-197">
<ul>
<li class="data-line-197">
<p>Type : 19</p>
</li>
<li class="data-line-198">
<p>Champs :</p>
<div class="ulist data-line-199">
<ul>
<li class="data-line-199">
<p><code>uint16</code> : <code>pong_body_len</code></p>
</li>
<li class="data-line-200">
<p><code>ping_body_len*bytes</code> : <code>pong_body</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-202">
<p>Un message <code>ping</code> peut être envoyé par l&#8217;une ou l&#8217;autre des parties à tout moment.</p>
</div>
<div class="paragraph data-line-204">
<p>Le message <code>ping</code> inclut un champ <code>num_pong_bytes</code> qui est utilisé pour instruire
le nœud récepteur au sujet de la taille de la charge utile qu&#8217;il envoie dans son message
<code>pong</code>. Le message <code>ping</code> comprend également un ensemble opaque d&#8217;octets <code>ping_body</code>
qui peut être ignoré en toute sécurité. Il ne sert qu&#8217;à permettre à un expéditeur de compléter les messages
<code>ping</code> qu&#8217;ils envoient, ce qui peut être utile pour tenter de contrecarrer certaines
techniques de désanonymisation basées sur la taille des paquets sur le réseau.</p>
</div>
<div class="paragraph data-line-211">
<p>Un message <code>pong</code> devrait être envoyé en réponse à un message <code>ping</code> reçu. Le
destinataire doit lire un ensemble d&#8217;octets aléatoires <code>num_pong_bytes</code> à renvoyer comme
champ <code>pong_body</code>. Une utilisation intelligente de ces champs/messages peut permettre à un nœud de routage
soucieux de la protection de la vie privée de tenter de déjouer certaines catégories de
tentatives de désanonymisation du réseau, car il peut créer une "fausse" transcription qui
ressemble à d&#8217;autres messages sur la base de la taille des paquets envoyés. N&#8217;oubliez pas que
le Lightning Network utilise par défaut un transport <em>encrypté</em>, de sorte qu&#8217;un moniteur de réseau passif
ne peut pas lire les octets en texte clair et ne peut donc se baser que sur le timing et la taille
des paquets.</p>
</div>
</div>
</div>
<div class="sect3 data-line-221">
<h4 id="_financement_de_canal">Financement de canal</h4>
<div class="paragraph data-line-223">
<p>Au fur et à mesure que nous avançons, nous entrons dans le territoire des messages de base qui régissent les
fonctionnalités et la sémantique du protocole Lightning. Dans cette section, nous
explorons les messages envoyés lors du processus de création d&#8217;un nouveau canal. Nous
ne décrivons que les champs utilisés, car nous laissons une analyse approfondie du
processus de financement dans <a href="#payment_channels">[payment_channels]</a>.</p>
</div>
<div class="paragraph data-line-229">
<p>Les messages envoyés durant le flux de financement du canal appartiennent au groupe suivant
de cinq messages : <code>open_channel</code>, <code>accept_channel</code>, <code>funding_created</code>,
<code>funding_signed</code> et <code>funding_locked</code>.</p>
</div>
<div class="paragraph data-line-233">
<p>Le flux de protocole détaillé utilisant ces messages est décrit dans <a href="#payment_channels">[payment_channels]</a>.</p>
</div>
<div class="sect4 data-line-236">
<h5 id="apdx_open_channel_message">Le message open_channel</h5>
<div class="paragraph data-line-238">
<p>Le message open_channel lance le processus de financement du canal et contient les champs suivants :</p>
</div>
<div class="ulist data-line-240">
<ul>
<li class="data-line-240">
<p>Type : 32</p>
</li>
<li class="data-line-241">
<p>Champs :</p>
<div class="ulist data-line-242">
<ul>
<li class="data-line-242">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-243">
<p><code>32*byte</code> : <code>temp_chan_id</code></p>
</li>
<li class="data-line-244">
<p><code>uint64</code> : <code>funding_satoshis</code></p>
</li>
<li class="data-line-245">
<p><code>uint64</code> : <code>push_msat</code></p>
</li>
<li class="data-line-246">
<p><code>uint64</code> : <code>dust_limit_satoshis</code></p>
</li>
<li class="data-line-247">
<p><code>uint64</code> : <code>max_htlc_value_in_flight_msat</code></p>
</li>
<li class="data-line-248">
<p><code>uint64</code> : <code>channel_reserve_satoshis</code></p>
</li>
<li class="data-line-249">
<p><code>uint64</code> : <code>htlc_minimum_msat</code></p>
</li>
<li class="data-line-250">
<p><code>uint32</code> : <code>feerate_per_kw</code></p>
</li>
<li class="data-line-251">
<p><code>uint16</code> : <code>to_self_delay</code></p>
</li>
<li class="data-line-252">
<p><code>uint16</code> : <code>max_accepted_htlcs</code></p>
</li>
<li class="data-line-253">
<p><code>pubkey</code> : <code>funding_pubkey</code></p>
</li>
<li class="data-line-254">
<p><code>pubkey</code> : <code>revocation_basepoint</code></p>
</li>
<li class="data-line-255">
<p><code>pubkey</code> : <code>payment_basepoint</code></p>
</li>
<li class="data-line-256">
<p><code>pubkey</code> : <code>delayed_payment_basepoint</code></p>
</li>
<li class="data-line-257">
<p><code>pubkey</code> : <code>htlc_basepoint</code></p>
</li>
<li class="data-line-258">
<p><code>pubkey</code> : <code>first_per_commitment_point</code></p>
</li>
<li class="data-line-259">
<p><code>byte</code> : <code>channel_flags</code></p>
</li>
<li class="data-line-260">
<p><code>tlv_stream</code> : <code>tlvs</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-262">
<p>Ceci est le premier message envoyé lorsqu&#8217;un nœud souhaite exécuter un nouveau flux de financement
avec un autre nœud. Ce message contient toutes les informations nécessaires requises
pour les deux pairs afin de construire à la fois la transaction de financement ainsi que la
transaction d&#8217;engagement.</p>
</div>
<div class="paragraph data-line-267">
<p>Au moment de la rédaction de ce chapitre, un seul enregistrement TLV est défini dans
l&#8217;ensemble d&#8217;enregistrements TLV facultatifs qui peuvent être ajoutés à la fin d&#8217;un
message :</p>
</div>
<div class="ulist data-line-271">
<ul>
<li class="data-line-271">
<p>Type : 0</p>
</li>
<li class="data-line-272">
<p>Données :  <code>upfront_shutdown_script</code></p>
</li>
</ul>
</div>
<div class="paragraph data-line-274">
<p><code>upfront_shutdown_script</code> est une tranche d&#8217;octets de taille variable qui doit être un
script de clé publique valide tel qu&#8217;accepté par l’algorithme de consensus du réseau
Bitcoin. En fournissant une telle adresse, l&#8217;expéditeur est en mesure
de créer efficacement une "boucle fermée" pour leur canal, car aucune des parties ne signera
une transaction de fermeture coopérative qui paie à toute autre adresse. En
pratique, cette adresse est généralement celle dérivée d&#8217;un porte-monnaie de cold storage.</p>
</div>
<div class="paragraph data-line-281">
<p>Le champ <code>channel_flags</code> est composé bits dont, au moment de la rédaction, seul
le <em>premier</em> bit a une quelconque signification. Si ce bit est défini, alors ce canal doit être annoncé au réseau public en tant que canal routable. Sinon, le canal est considéré comme non annoncé, également
communément appelé un canal privé.</p>
</div>
</div>
<div class="sect4 data-line-286">
<h5 id="apdx_accept_channel_message">Le message accept_channel</h5>
<div class="paragraph data-line-288">
<p>Le message <code>accept_channel</code> est la réponse au message <code>open_channel</code>.</p>
</div>
<div class="ulist pagebreak-before data-line-291">
<ul>
<li class="data-line-291">
<p>Type : 33</p>
</li>
<li class="data-line-292">
<p>Champs :</p>
<div class="ulist data-line-293">
<ul>
<li class="data-line-293">
<p><code>32*byte</code> : <code>temp_chan_id</code></p>
</li>
<li class="data-line-294">
<p><code>uint64</code> : <code>dust_limit_satoshis</code></p>
</li>
<li class="data-line-295">
<p><code>uint64</code> : <code>max_htlc_value_in_flight_msat</code></p>
</li>
<li class="data-line-296">
<p><code>uint64</code> : <code>channel_reserve_satoshis</code></p>
</li>
<li class="data-line-297">
<p><code>uint64</code> : <code>htlc_minimum_msat</code></p>
</li>
<li class="data-line-298">
<p><code>uint32</code> : <code>minimum_depth</code></p>
</li>
<li class="data-line-299">
<p><code>uint16</code> : <code>to_self_delay</code></p>
</li>
<li class="data-line-300">
<p><code>uint16</code> : <code>max_accepted_htlcs</code></p>
</li>
<li class="data-line-301">
<p><code>pubkey</code> : <code>funding_pubkey</code></p>
</li>
<li class="data-line-302">
<p><code>pubkey</code> : <code>revocation_basepoint</code></p>
</li>
<li class="data-line-303">
<p><code>pubkey</code> : <code>payment_basepoint</code></p>
</li>
<li class="data-line-304">
<p><code>pubkey</code> : <code>delayed_payment_basepoint</code></p>
</li>
<li class="data-line-305">
<p><code>pubkey</code> : <code>htlc_basepoint</code></p>
</li>
<li class="data-line-306">
<p><code>pubkey</code> : <code>first_per_commitment_point</code></p>
</li>
<li class="data-line-307">
<p><code>tlv_stream</code> : <code>tlvs</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-309">
<p>Le message <code>accept_channel</code> est le deuxième message envoyé pendant le processus de flux de
financement. Il sert à reconnaître une intention d&#8217;ouvrir un canal avec un nouveau pair
distant. Le message fait principalement écho à l&#8217;ensemble de paramètres que le répondant souhaite
appliquer à leur version de la transaction d&#8217;engagement. Dans <a href="#payment_channels">[payment_channels]</a>,
lorsque nous abordons le processus de financement en détail, nous explorons
les implications des différents paramètres qui peuvent être réglés lors de l&#8217;ouverture d&#8217;un nouveau
canal.</p>
</div>
</div>
<div class="sect4 data-line-318">
<h5 id="apdx_funding_created_message">Le message funding_created</h5>
<div class="paragraph data-line-320">
<p>En réponse, l&#8217;initiateur enverra le message <code>funding_created</code>.</p>
</div>
<div class="ulist data-line-322">
<ul>
<li class="data-line-322">
<p>Type : 34</p>
</li>
<li class="data-line-323">
<p>Champs :</p>
<div class="ulist data-line-324">
<ul>
<li class="data-line-324">
<p><code>32*byte</code> : <code>temp_chan_id</code></p>
</li>
<li class="data-line-325">
<p><code>32*byte</code> : <code>funding_txid</code></p>
</li>
<li class="data-line-326">
<p><code>uint16</code> : <code>funding_output_index</code></p>
</li>
<li class="data-line-327">
<p><code>sig</code> : <code>commit_sig</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-329">
<p>Une fois que l&#8217;initiateur d&#8217;un canal reçoit le message <code>accept_channel</code> de la part du
répondant, ils ont tous les éléments dont ils ont besoin pour construire la
transaction d&#8217;engagement, ainsi que la transaction de financement. Vu que les canaux par
défaut ont un financeur unique (un seul côté engage des fonds), seul l&#8217;initiateur
a besoin de construire la transaction de financement. En conséquence, pour permettre au
répondant de signer une version d&#8217;une transaction d&#8217;engagement pour l&#8217;initiateur, l&#8217;initiateur
n&#8217;a qu&#8217;à envoyer le point de sortie de financement du canal.</p>
</div>
</div>
<div class="sect4 data-line-338">
<h5 id="apdx_funding_signed_message">Le message funding_signed</h5>
<div class="paragraph data-line-340">
<p>Pour conclure, le répondant envoie le message <code>funding_signed</code>.</p>
</div>
<div class="ulist data-line-342">
<ul>
<li class="data-line-342">
<p>Type : 34</p>
</li>
<li class="data-line-343">
<p>Champs :</p>
<div class="ulist data-line-344">
<ul>
<li class="data-line-344">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-345">
<p><code>sig</code> : <code>signature</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-347">
<p>Pour conclure, une fois que le répondant a reçu le message <code>funding_created</code>, il
possède maintenant une signature valide de la transaction d&#8217;engagement par l&#8217;initiateur. Avec
cette signature, il peut quitter le canal à tout moment en signant sa
moitié de la sortie de financement multisig et en diffusant la transaction. C&#8217;est
appelé une fermeture forcée. À l&#8217;opposé, pour donner à l&#8217;initiateur la possibilité de fermer le canal, le répondant signe également la transaction d&#8217;engagement de l&#8217;initiateur.</p>
</div>
<div class="paragraph data-line-353">
<p>Une fois ce message reçu par l&#8217;initiateur, il peut en toute sécurité
diffuser la transaction de financement, car ils peuvent désormais se défaire du contrat
de canal unilatéralement.</p>
</div>
</div>
<div class="sect4 data-line-358">
<h5 id="apdx_funding_locked_message">Le message funding_locked</h5>
<div class="paragraph data-line-360">
<p>Une fois que la transaction de financement a reçu suffisamment de confirmations, le
message <code>funding_locked</code> est envoyé.</p>
</div>
<div class="ulist data-line-363">
<ul>
<li class="data-line-363">
<p>Type : 36</p>
</li>
<li class="data-line-364">
<p>Champs :</p>
<div class="ulist data-line-365">
<ul>
<li class="data-line-365">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-366">
<p><code>pubkey</code> : <code>next_per_commitment_point</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-368">
<p>Une fois que la transaction de financement a obtenu un nombre <code>minimum_depth</code> de confirmations,
alors le message <code>funding_locked</code> doit être envoyé par les deux côtés. Ce n&#8217;est qu&#8217;après que ce
message est reçu et envoyé, que le canal peut commencer à être utilisé.</p>
</div>
</div>
</div>
<div class="sect3 data-line-372">
<h4 id="_fermeture_de_canal">Fermeture de canal</h4>
<div class="paragraph data-line-374">
<p>Channel closing is a multistep process. Un nœud initialise en envoyant le message <code>shutdown</code>. Les deux partenaires de canal échangent ensuite une série de messages <code>closing_signed pour négocier des frais mutuellement acceptables pour la transaction de fermeture. Le financeur envoie le premier message `closing_signed</code>, et l&#8217;autre partie peut accepter en envoyant un message <code>closing_signed</code> avec les mêmes valeurs pour les frais.</p>
</div>
<div class="sect4 data-line-377">
<h5 id="apdx_shutdown_message">Le message shutdown</h5>
<div class="paragraph data-line-379">
<p>Le message shutdown lance le processus de fermeture d&#8217;un canal et contient les champs suivants :</p>
</div>
<div class="ulist data-line-381">
<ul>
<li class="data-line-381">
<p>Type : 38</p>
</li>
<li class="data-line-382">
<p>Champs :</p>
<div class="ulist data-line-383">
<ul>
<li class="data-line-383">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-384">
<p><code>u16</code> : <code>len</code></p>
</li>
<li class="data-line-385">
<p><code>len*byte</code> : <code>scriptpubkey</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4 data-line-388">
<h5 id="apdx_closing_signed_message">Le message closing_signed</h5>
<div class="paragraph data-line-390">
<p>Le message closing_signed est envoyé par chaque partenaire d&#8217;un canal jusqu&#8217;à ce qu&#8217;ils s&#8217;entendent sur les frais. Il contient les champs suivants :</p>
</div>
<div class="ulist data-line-392">
<ul>
<li class="data-line-392">
<p>Type : 39</p>
</li>
<li class="data-line-393">
<p>Champs :</p>
<div class="ulist data-line-394">
<ul>
<li class="data-line-394">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-395">
<p><code>u64</code> : <code>fee_satoshis</code></p>
</li>
<li class="data-line-396">
<p><code>signature</code> : <code>signature</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3 data-line-398">
<h4 id="_exploitation_du_canal">Exploitation du canal</h4>
<div class="paragraph data-line-400">
<p>Dans cette section, nous décrivons brièvement l&#8217;ensemble des messages utilisés pour permettre
aux nœuds d&#8217;exploiter un canal. Par exploitation, nous entendons pouvoir envoyer, recevoir,
et transférer des paiements pour un canal donné.</p>
</div>
<div class="paragraph data-line-404">
<p>Pour envoyer, recevoir ou transférer un paiement sur un canal, un HTLC doit
d&#8217;abord être ajouté aux deux transactions d&#8217;engagement qui composent un lien de canal.</p>
</div>
<div class="sect4 pagebreak-before less_space data-line-409">
<h5 id="apdx_update_add_htlc_message">Le message update_add_htlc</h5>
<div class="paragraph data-line-411">
<p>Le message <code>update_add_htlc</code> permet à chaque côté d&#8217;ajouter un nouveau HTLC à la
transaction d&#8217;engagement opposée.</p>
</div>
<div class="ulist data-line-414">
<ul>
<li class="data-line-414">
<p>Type : 128</p>
</li>
<li class="data-line-415">
<p>Champs :</p>
<div class="ulist data-line-416">
<ul>
<li class="data-line-416">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-417">
<p><code>uint64</code> : <code>id</code></p>
</li>
<li class="data-line-418">
<p><code>uint64</code> : <code>amount_msat</code></p>
</li>
<li class="data-line-419">
<p><code>sha256</code> : <code>payment_hash</code></p>
</li>
<li class="data-line-420">
<p><code>uint32</code> : <code>cltv_expiry</code></p>
</li>
<li class="data-line-421">
<p><code>1366*byte</code> : <code>onion_routing_packet</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-423">
<p>L&#8217;envoi de ce message permet à une partie d&#8217;initier soit l&#8217;envoi d&#8217;un nouveau paiement,
soit de transférer un paiement existant arrivé via un canal entrant. Le
message spécifie le montant (<code>amount_msat</code>) ainsi que le hachage de paiement qui
déverrouille le paiement lui-même. L&#8217;ensemble des instructions de transfert du prochain saut
sont chiffrées en oignon dans le champ <code>onion_routing_packet</code>. Dans <a href="#onion_routing">[onion_routing]</a>, au sujet du
transferts HTLC multi-sauts, nous couvrons en détail le protocole de routage en oignon utilisé dans le
Lightning Network.</p>
</div>
<div class="paragraph data-line-431">
<p>Notez que chaque HTLC envoyé utilise un ID qui s&#8217;incrémente automatiquement et qui est utilisé par n&#8217;importe quel
message qui modifie un HTLC (régler ou annuler) pour référencer l&#8217;HTLC d&#8217;une
manière unique dans la portée du canal.</p>
</div>
</div>
<div class="sect4 data-line-436">
<h5 id="apdx_update_fulfill_hltc_message">Le message update_fulfill_hltc</h5>
<div class="paragraph data-line-438">
<p>Le message <code>update_fulfill_hltc</code> permet la réclamation (réception) d&#8217;un HTLC actif.</p>
</div>
<div class="ulist data-line-440">
<ul>
<li class="data-line-440">
<p>Type : 130</p>
</li>
<li class="data-line-441">
<p>Champs :</p>
<div class="ulist data-line-442">
<ul>
<li class="data-line-442">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-443">
<p><code>uint64</code> : <code>id</code></p>
</li>
<li class="data-line-444">
<p><code>32*byte</code> : <code>payment_preimage</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-446">
<p>Ce message est envoyé par le récepteur d&#8217;HTLC au proposant pour réclamer un
HTLC actif. Le message fait référence à l&#8217;identifiant du HTLC en question et il
fournit également la préimage (qui déverrouille le HLTC).</p>
</div>
</div>
<div class="sect4 data-line-451">
<h5 id="apdx_update_fail_htlc_message">Le message update_fail_htlc</h5>
<div class="paragraph data-line-453">
<p>Le message <code>update_fail_htlc</code> est envoyé pour supprimer un HTLC d&#8217;une transaction d&#8217;engagement.</p>
</div>
<div class="ulist data-line-455">
<ul>
<li class="data-line-455">
<p>Type : 131</p>
</li>
<li class="data-line-456">
<p>Champs :</p>
<div class="ulist data-line-457">
<ul>
<li class="data-line-457">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-458">
<p><code>uint64</code> : <code>id</code></p>
</li>
<li class="data-line-459">
<p><code>uint16</code> : <code>len</code></p>
</li>
<li class="data-line-460">
<p><code>len*byte</code> : <code>reason</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-462">
<p>Le message <code>update_fail_htlc</code> est l&#8217;opposé du message <code>update_fulfill_hltc</code> en ce sens qu&#8217;il
permet au récepteur d&#8217;un HTLC de supprimer le même HTLC. Ce message est
généralement envoyé lorsqu&#8217;un HTLC ne peut pas être correctement acheminé en amont et doit être
renvoyé à l&#8217;expéditeur pour démêler la chaîne d&#8217;HTLC. Comme nous l&#8217;explorons dans
<a href="#failure_messages">[failure_messages]</a>, le message contient une raison d&#8217;échec <em>chiffrée</em> (<code>reason</code>) qui
peut permettre à l&#8217;expéditeur d&#8217;ajuster son itinéraire de paiement ou de résilier si
l&#8217;échec lui-même est terminal.</p>
</div>
</div>
<div class="sect4 data-line-471">
<h5 id="apdx_commitment_signed_message">Le message commitment_signed</h5>
<div class="paragraph data-line-473">
<p>Le message <code>commitment_signed</code> est utilisé pour marquer la création d&#8217;une nouvelle transaction d&#8217;engagement.</p>
</div>
<div class="ulist data-line-475">
<ul>
<li class="data-line-475">
<p>Type : 132</p>
</li>
<li class="data-line-476">
<p>Champs :</p>
<div class="ulist data-line-477">
<ul>
<li class="data-line-477">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-478">
<p><code>sig</code> : <code>signature</code></p>
</li>
<li class="data-line-479">
<p><code>uint16</code> : <code>num_htlcs</code></p>
</li>
<li class="data-line-480">
<p><code>num_htlcs*sig</code> : <code>htlc_signature</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-482">
<p>En plus d&#8217;envoyer une signature pour la prochaine transaction d&#8217;engagement,
l&#8217;expéditeur de ce message doit également envoyer une signature pour chaque HTLC qui est
présent dans la transaction d&#8217;engagement.</p>
</div>
</div>
<div class="sect4 pagebreak-before less_space data-line-488">
<h5 id="apdx_revoke_and_ack_message">Le message revoke_and_ack</h5>
<div class="paragraph data-line-490">
<p><code>revoke_and_ack</code> est envoyé pour révoquer un engagement daté.</p>
</div>
<div class="ulist data-line-492">
<ul>
<li class="data-line-492">
<p>Type : 133</p>
</li>
<li class="data-line-493">
<p>Champs :</p>
<div class="ulist data-line-494">
<ul>
<li class="data-line-494">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-495">
<p><code>32*byte</code> : <code>per_commitment_secret</code></p>
</li>
<li class="data-line-496">
<p><code>pubkey</code> : <code>next_per_commitment_point</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-498">
<p>Étant donné que Lightning Network utilise une transaction d&#8217;engagement de remplacement-par-révocation, après
la réception d&#8217;une nouvelle transaction d&#8217;engagement via le message <code>commit_sig</code>, une partie
doit révoquer leur engagement passé avant de pouvoir en recevoir un autre.
Lors de la révocation d&#8217;une transaction d&#8217;engagement, le révocateur fournit également le
prochain point d&#8217;engagement requis pour permettre à l&#8217;autre partie de leur envoyer un
nouvel état d&#8217;engagement.</p>
</div>
</div>
<div class="sect4 data-line-506">
<h5 id="apdx_update_fee_message">Le message update_fee</h5>
<div class="paragraph data-line-508">
<p>Le message <code>update_fee</code> est envoyé pour mettre à jour les frais sur la transaction d&#8217;engagement
actuelle.</p>
</div>
<div class="ulist data-line-511">
<ul>
<li class="data-line-511">
<p>Type : 134</p>
</li>
<li class="data-line-512">
<p>Champs :</p>
<div class="ulist data-line-513">
<ul>
<li class="data-line-513">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-514">
<p><code>uint32</code> : <code>feerate_per_kw</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-516">
<p>Ce message ne peut être envoyé que par l&#8217;initiateur du canal ; ce sont eux
qui paieront les frais d&#8217;engagement du canal tant qu&#8217;il sera ouvert.</p>
</div>
</div>
<div class="sect4 data-line-520">
<h5 id="apdx_update_fail_malformed_htlc_message">Le message update_fail_malformed_htlc</h5>
<div class="paragraph data-line-522">
<p>Le message <code>update_fail_malformed_htlc</code> est envoyé pour supprimer un HTLC corrompu.</p>
</div>
<div class="ulist data-line-524">
<ul>
<li class="data-line-524">
<p>Type : 135</p>
</li>
<li class="data-line-525">
<p>Champs :</p>
<div class="ulist data-line-526">
<ul>
<li class="data-line-526">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-527">
<p><code>uint64</code> : <code>id</code></p>
</li>
<li class="data-line-528">
<p><code>sha256</code> : <code>sha256_of_onion</code></p>
</li>
<li class="data-line-529">
<p><code>uint16</code> : <code>failure_code</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-531">
<p>Ce message est similaire au message <code>update_fail_htlc</code>, mais il est rarement utilisé en
pratique. Comme mentionné précédemment, chaque HTLC transporte un paquet de routage encrypté en oignon
qui couvre également l&#8217;intégrité de parties du HTLC lui-même. Si une
partie reçoit un paquet oignon qui a été corrompu d&#8217;une manière ou d&#8217;une autre en cours de route,
alors il ne pourra pas décrypter le paquet. En conséquence, il ne peut pas non plus correctement
transférer l&#8217;HTLC ; par conséquent, il enverra ce message pour signifier que l&#8217;HTLC
a été corrompu quelque part le long de la route vers l&#8217;expéditeur.</p>
</div>
</div>
</div>
<div class="sect3 data-line-539">
<h4 id="_annonce_de_canal">Annonce de canal</h4>
<div class="paragraph data-line-541">
<p>Les messages de cette catégorie sont utilisés pour annoncer à l&#8217;ensemble du réseau les composants de la structure de données
authentifiée du graphe des canaux. Le graphe des canaux possède
une série de propriétés uniques, car toutes les données ajoutées au
graphe des canaux doivent également être ancrées dans la blockchain Bitcoin de base. Par
conséquent, pour ajouter une nouvelle entrée au graphe des canaux, un agent doit
payer des frais de transaction sur la chaîne. Il s&#8217;agit là d&#8217;un moyen naturel de dissuasion du spam pour le
Lightning Network.</p>
</div>
<div class="sect4 data-line-551">
<h5 id="apdx_channel_announcement_message">Le message channel_announcement</h5>
<div class="paragraph data-line-553">
<p>Le message <code>channel_announcement</code> est utilisé pour annoncer un nouveau canal à l&#8217;ensemble
du réseau.</p>
</div>
<div class="ulist data-line-556">
<ul>
<li class="data-line-556">
<p>Type : 256</p>
</li>
<li class="data-line-557">
<p>Champs :</p>
<div class="ulist data-line-558">
<ul>
<li class="data-line-558">
<p><code>sig</code> : <code>node_signature_1</code></p>
</li>
<li class="data-line-559">
<p><code>sig</code> : <code>node_signature_2</code></p>
</li>
<li class="data-line-560">
<p><code>sig</code> : <code>bitcoin_signature_1</code></p>
</li>
<li class="data-line-561">
<p><code>sig</code> : <code>bitcoin_signature_2</code></p>
</li>
<li class="data-line-562">
<p><code>uint16</code> : <code>len</code></p>
</li>
<li class="data-line-563">
<p><code>len*byte</code> : <code>features</code></p>
</li>
<li class="data-line-564">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-565">
<p><code>short_channel_id</code> : <code>short_channel_id</code></p>
</li>
<li class="data-line-566">
<p><code>pubkey</code> : <code>node_id_1</code></p>
</li>
<li class="data-line-567">
<p><code>pubkey</code> : <code>node_id_2</code></p>
</li>
<li class="data-line-568">
<p><code>pubkey</code> : <code>bitcoin_key_1</code></p>
</li>
<li class="data-line-569">
<p><code>pubkey</code> : <code>bitcoin_key_2</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-571">
<p>La série de signatures et de clés publiques dans le message servent à créer une
<em>preuve</em> que le canal existe réellement dans la blockchain de base de Bitcoin. Comme
nous détaillons le dans <a href="#scid">[scid]</a>, chaque canal est identifié de manière unique par un localisateur
qui encode son <em>emplacement</em> dans la blockchain. Ce localisateur s&#8217;appelle
le <code>short_channel_id</code> et peut tenir dans un entier de 64 bits.</p>
</div>
</div>
<div class="sect4 data-line-578">
<h5 id="apdx_node_announcement_message">Le message node_announcement</h5>
<div class="paragraph data-line-580">
<p>Le message <code>node_announcement</code> permet à un nœud d&#8217;annoncer/de mettre à jour son sommet dans le
graphe des canaux supérieur.</p>
</div>
<div class="ulist data-line-583">
<ul>
<li class="data-line-583">
<p>Type : 257</p>
</li>
<li class="data-line-584">
<p>Champs :</p>
<div class="ulist data-line-585">
<ul>
<li class="data-line-585">
<p><code>sig</code> : <code>signature</code></p>
</li>
<li class="data-line-586">
<p><code>uint64</code> : <code>flen</code></p>
</li>
<li class="data-line-587">
<p><code>flen*byte</code> : <code>features</code></p>
</li>
<li class="data-line-588">
<p><code>uint32</code> : <code>timestamp</code></p>
</li>
<li class="data-line-589">
<p><code>pubkey</code> : <code>node_id</code></p>
</li>
<li class="data-line-590">
<p><code>3*byte</code> : <code>rgb_color</code></p>
</li>
<li class="data-line-591">
<p><code>32*byte</code> : <code>alias</code></p>
</li>
<li class="data-line-592">
<p><code>uint16</code> : <code>addrlen</code></p>
</li>
<li class="data-line-593">
<p><code>addrlen*byte</code> : <code>addresses</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-595">
<p>Notez que si un nœud n&#8217;a pas de canal annoncé dans le graphe de
canaux, alors ce message est ignoré pour s&#8217;assurer que l&#8217;ajout d&#8217;un élément au
graphe des canaux implique un coût sur la chaîne. Dans ce cas, le coût sur la chaîne sera
le coût de création du canal auquel ce nœud est connecté.</p>
</div>
<div class="paragraph data-line-600">
<p>En plus d&#8217;annoncer son ensemble de fonctionnalités, ce message permet également à un nœud
d&#8217;annoncer/mettre à jour l&#8217;ensemble des <code>adresses</code> de réseau où il peut être atteint.</p>
</div>
</div>
<div class="sect4 data-line-604">
<h5 id="apdx_channel_update_message">Le message channel_update</h5>
<div class="paragraph data-line-606">
<p>Le message <code>channel_update</code> est envoyé pour mettre à jour les propriétés et les politiques
d&#8217;une arrête de canal actif dans le graphe des canaux.</p>
</div>
<div class="ulist data-line-609">
<ul>
<li class="data-line-609">
<p>Type : 258</p>
</li>
<li class="data-line-610">
<p>Champs :</p>
<div class="ulist data-line-611">
<ul>
<li class="data-line-611">
<p><code>signature</code> : <code>signature</code></p>
</li>
<li class="data-line-612">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-613">
<p><code>short_channel_id</code> : <code>short_channel_id</code></p>
</li>
<li class="data-line-614">
<p><code>uint32</code> : <code>timestamp</code></p>
</li>
<li class="data-line-615">
<p><code>byte</code> : <code>message_flags</code></p>
</li>
<li class="data-line-616">
<p><code>byte</code> : <code>channel_flags</code></p>
</li>
<li class="data-line-617">
<p><code>uint16</code> : <code>cltv_expiry_delta</code></p>
</li>
<li class="data-line-618">
<p><code>uint64</code> : <code>htlc_minimum_msat</code></p>
</li>
<li class="data-line-619">
<p><code>uint32</code> : <code>fee_base_msat</code></p>
</li>
<li class="data-line-620">
<p><code>uint32</code> : <code>fee_proportional_millionths</code></p>
</li>
<li class="data-line-621">
<p><code>uint16</code> : <code>htlc_maximum_msat</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-623">
<p>En plus de pouvoir activer/désactiver un canal, ce message permet à un
nœud de mettre à jour ses frais de routage ainsi que d&#8217;autres champs qui façonnent le type de
paiements autorisés à transiter par ce canal.</p>
</div>
</div>
<div class="sect4 data-line-628">
<h5 id="apdx_announce_signatures_message">Le message announce_signatures</h5>
<div class="paragraph data-line-630">
<p>Le message <code>announce_signatures</code> est échangé par les pairs du canal pour
assembler l&#8217;ensemble des signatures nécessaires pour produire un message
<code>channel_announcement</code>.</p>
</div>
<div class="ulist data-line-634">
<ul>
<li class="data-line-634">
<p>Type : 259</p>
</li>
<li class="data-line-635">
<p>Champs :</p>
<div class="ulist data-line-636">
<ul>
<li class="data-line-636">
<p><code>channel_id</code> : <code>channel_id</code></p>
</li>
<li class="data-line-637">
<p><code>short_channel_id</code> : <code>short_channel_id</code></p>
</li>
<li class="data-line-638">
<p><code>sig</code> : <code>node_signature</code></p>
</li>
<li class="data-line-639">
<p><code>sig</code> : <code>bitcoin_signature</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-641">
<p>Après l&#8217;envoi du message <code>funding_locked</code>, si les deux parties souhaitent
annoncer leur canal sur le réseau, puis ils enverront chacun le
message <code>announce_signatures</code> qui permet aux deux parties de mettre en place les quatre
signatures requises pour générer un message <code>announce_signatures</code>.</p>
</div>
</div>
</div>
<div class="sect3 data-line-646">
<h4 id="_synchronisation_du_graphe_des_canaux">Synchronisation du graphe des canaux</h4>
<div class="paragraph data-line-648">
<p>Les nœuds créent une perspective locale du graphe des canaux à l&#8217;aide de cinq messages : query_short_chan_ids, reply_short_chan_ids_end, query_channel_range, reply_channel_range et gossip_timestamp_range.</p>
</div>
<div class="sect4 data-line-651">
<h5 id="apdx_query_short_chan_ids_message">Le message query_short_chan_ids</h5>
<div class="paragraph data-line-653">
<p>Le message <code>query_short_chan_ids</code> permet à un pair d&#8217;obtenir les informations sur le canal
liés à une série d&#8217;identifiants de canal courts.</p>
</div>
<div class="ulist data-line-656">
<ul>
<li class="data-line-656">
<p>Type : 261</p>
</li>
<li class="data-line-657">
<p>Champs :</p>
<div class="ulist data-line-658">
<ul>
<li class="data-line-658">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-659">
<p><code>u16</code> : <code>len</code></p>
</li>
<li class="data-line-660">
<p><code>len*byte</code> : <code>encoded_short_ids</code></p>
</li>
<li class="data-line-661">
<p><code>query_short_channel_ids_tlvs</code> : <code>tlvs</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-663">
<p>Comme nous l&#8217;apprenons dans <a href="#gossip">[gossip]</a>, ces identifiants de canal peuvent être une série de canaux
qui étaient nouveaux pour l&#8217;expéditeur ou qui étaient obsolètes, ce qui permet à l&#8217;expéditeur
d&#8217;obtenir le dernier ensemble d&#8217;informations pour un ensemble de canaux.</p>
</div>
</div>
<div class="sect4 data-line-668">
<h5 id="apdx_reply_short_chan_ids_end_message">Le message reply_short_chan_ids_end</h5>
<div class="paragraph data-line-670">
<p>Le message <code>reply_short_chan_ids_end</code> est envoyé après qu&#8217;un pair a fini de répondre
à un message <code>query_short_chan_ids</code> antérieur.</p>
</div>
<div class="ulist data-line-673">
<ul>
<li class="data-line-673">
<p>Type : 262</p>
</li>
<li class="data-line-674">
<p>Champs :</p>
<div class="ulist data-line-675">
<ul>
<li class="data-line-675">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-676">
<p><code>byte</code> : <code>full_information</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-678">
<p>Ce message signale au destinataire que s&#8217;il souhaite envoyer un autre
message de requête, ils peuvent maintenant le faire.</p>
</div>
</div>
<div class="sect4 data-line-682">
<h5 id="apdx_query_channel_range_message">Le message query_channel_range</h5>
<div class="paragraph data-line-684">
<p>Le message <code>query_channel_range</code> permet à un nœud d&#8217;interroger l&#8217;ensemble de canaux
ouverts dans une plage de blocs.</p>
</div>
<div class="ulist data-line-687">
<ul>
<li class="data-line-687">
<p>Type : 263</p>
</li>
<li class="data-line-688">
<p>Champs :</p>
<div class="ulist data-line-689">
<ul>
<li class="data-line-689">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-690">
<p><code>u32</code> : <code>first_blocknum</code></p>
</li>
<li class="data-line-691">
<p><code>u32</code> : <code>number_of_blocks</code></p>
</li>
<li class="data-line-692">
<p><code>query_channel_range_tlvs</code> : <code>tlvs</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-695">
<p>Comme les canaux sont représentés à l&#8217;aide d&#8217;un ID de canal court qui encode l&#8217;emplacement
d&#8217;un canal sur la chaîne, un nœud sur le réseau peut utiliser une hauteur de bloc comme
sorte de <em>curseur</em> pour parcourir la chaîne afin de découvrir un ensemble de
des canaux ouverts.</p>
</div>
</div>
<div class="sect4 data-line-701">
<h5 id="apdx_reply_channel_range_message">Le message reply_channel_range</h5>
<div class="paragraph data-line-703">
<p>Le message <code>reply_channel_range</code> est la réponse au message <code>query_channel_range</code> et
inclut l&#8217;ensemble d&#8217;ID courts de canaux pour les canaux connus dans cette plage.</p>
</div>
<div class="ulist data-line-706">
<ul>
<li class="data-line-706">
<p>Type : 264</p>
</li>
<li class="data-line-707">
<p>Champs :</p>
<div class="ulist data-line-708">
<ul>
<li class="data-line-708">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-709">
<p><code>u32</code> : <code>first_blocknum</code></p>
</li>
<li class="data-line-710">
<p><code>u32</code> : <code>number_of_blocks</code></p>
</li>
<li class="data-line-711">
<p><code>byte</code> : <code>sync_complete</code></p>
</li>
<li class="data-line-712">
<p><code>u16</code> : <code>len</code></p>
</li>
<li class="data-line-713">
<p><code>len*byte</code> : <code>encoded_short_ids</code></p>
</li>
<li class="data-line-714">
<p><code>reply_channel_range_tlvs</code> : <code>tlvs</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-716">
<p>En réponse à <code>query_channel_range</code>, ce message renvoie l&#8217;ensemble des
canaux qui ont été ouverts dans cette plage. Ce processus peut être répété avec
le demandeur avançant son curseur plus bas dans la chaîne pour
continuer à synchroniser le graphe des canaux.</p>
</div>
</div>
<div class="sect4 data-line-722">
<h5 id="apdx_gossip_timestamp_range_message">Le message gossip_timestamp_range</h5>
<div class="paragraph data-line-724">
<p>Le message <code>gossip_timestamp_range</code> permet à un pair de commencer à recevoir de nouveaux
messages de bavardage entrants sur le réseau.</p>
</div>
<div class="ulist data-line-727">
<ul>
<li class="data-line-727">
<p>Type : 265</p>
</li>
<li class="data-line-728">
<p>Champs :</p>
<div class="ulist data-line-729">
<ul>
<li class="data-line-729">
<p><code>chain_hash</code> : <code>chain_hash</code></p>
</li>
<li class="data-line-730">
<p><code>u32</code> : <code>first_timestamp</code></p>
</li>
<li class="data-line-731">
<p><code>u32</code> : <code>timestamp_range</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph data-line-733">
<p>Une fois qu&#8217;un pair a synchronisé le graphe des canaux, il peut envoyer ce message s&#8217;il
souhaite recevoir des mises à jour en temps réel sur les changements du graphe des canaux. Ils peuvent
définir également les champs <code>first_timestamp</code> et <code>timestamp_range</code> s&#8217;ils souhaitent
recevoir un backlog des mises à jour qu&#8217;ils ont peut-être manquées alors qu&#8217;ils étaient down.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-04-28 02:37:09 -0400
</div>
</div>
</body>
</html>