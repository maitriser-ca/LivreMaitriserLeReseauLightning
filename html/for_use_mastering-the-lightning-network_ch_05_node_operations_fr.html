<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Exploitation d&#8217;un n≈ìud du Lightning Network</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-3">
<h2 id="node_operations">Exploitation d&#8217;un n≈ìud du Lightning Network</h2>
<div class="sectionbody">
<div class="paragraph data-line-5">
<p>En ayant lu jusqu&#8217;ici, vous avez probablement cr√©√© une porte-monnaie Lightning. Dans ce chapitre, nous allons aller plus loin et mettre en place un n≈ìud Lightning complet. En plus de la mise en place d&#8217;un n≈ìud, nous apprendrons √† le faire fonctionner et √† le maintenir dans le temps.</p>
</div>
<div class="paragraph data-line-7">
<p>Il existe de nombreuses raisons pour lesquelles vous pourriez vouloir installer votre propre n≈ìud Lightning. Ils comprennent¬†:</p>
</div>
<div class="ulist data-line-9">
<ul>
<li class="data-line-9">
<p>√ätre un participant actif √† part enti√®re du Lightning Network, et pas seulement un utilisateur final</p>
</li>
<li class="data-line-10">
<p>Pour g√©rer une boutique en ligne ou recevoir des revenus via des paiements Lightning</p>
</li>
<li class="data-line-11">
<p>Pour gagner des revenus gr√¢ce aux frais de routage Lightning ou en louant des liquidit√©s de canal</p>
</li>
<li class="data-line-12">
<p>Pour d√©velopper de nouveaux services, applications ou plug-ins pour le Lightning Network</p>
</li>
<li class="data-line-13">
<p>Pour augmenter votre confidentialit√© financi√®re lors de l&#8217;utilisation de Lightning</p>
</li>
<li class="data-line-14">
<p>Pour utiliser certaines applications construites sur Lightning, telles que les applications de messagerie instantan√©e propuls√©es par Lightning</p>
</li>
<li class="data-line-15">
<p>Pour la libert√© financi√®re, l&#8217;ind√©pendance et la souverainet√©</p>
</li>
</ul>
</div>
<div class="paragraph data-line-17">
<p>Il y a des co√ªts associ√©s √† l&#8217;ex√©cution d&#8217;un n≈ìud LN. Vous avez besoin d&#8217;un ordinateur, d&#8217;une connexion Internet permanente, de beaucoup d&#8217;espace disque et de beaucoup de temps !
Les co√ªts d&#8217;exploitation comprendront des d√©penses d&#8217;√©lectricit√©.</p>
</div>
<div class="paragraph data-line-20">
<p>Mais les comp√©tences que vous apprendrez de cette exp√©rience sont pr√©cieuses et peuvent √©galement √™tre appliqu√©es √† une vari√©t√© d&#8217;autres t√¢ches.</p>
</div>
<div class="paragraph data-line-22">
<p>Commen√ßons !</p>
</div>
<div class="admonitionblock note data-line-25">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-26">
<p>Il est important que vous d√©finissiez correctement vos propres attentes en se basant sur des faits pr√©cis.
Si vous envisagez d&#8217;exploiter un n≈ìud Lightning <em>uniquement</em> pour gagner un revenu en percevant des frais de routage,
veuillez d&#8217;abord faire vos devoirs avec diligence. Diriger une entreprise rentable en exploitant un n≈ìud Lightning n&#8217;est
d√©finitivement <em>pas</em> facile. Calculez tous vos co√ªts initiaux et continus dans une feuille de calcul. √âtudiez attentivement les statistiques du LN.
Quel est le volume de paiement actuel¬†? Quel est le volume par n≈ìud¬†? Quels sont les frais de routage moyens actuels¬†? Consultez les forums et demandez
des conseils ou des commentaires d&#8217;autres membres de la communaut√© qui ont d√©j√† acquis une exp√©rience du monde r√©el. Formez votre propre opinion √©clair√©e uniquement
<em>apr√®s</em> que vous avez fait cet exercice de diligence raisonnable. La plupart des gens trouveront leur motivation pour g√©rer un n≈ìud non dans un gain financier,
mais plut√¥t ailleurs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2 data-line-36">
<h3 id="_choisir_votre_plateforme">Choisir votre plateforme</h3>
<div class="paragraph data-line-38">
<p>Il existe de nombreuses fa√ßons d&#8217;ex√©cuter un n≈ìud Lightning, allant d&#8217;un petit mini PC h√©berg√© dans votre domicile ou un serveur d√©di√©, vers un serveur h√©berg√© dans le cloud. La m√©thode que vous choisirez d√©pendra des ressources dont vous disposez et du montant que vous souhaitez d√©penser.</p>
</div>
<div class="sect3 data-line-41">
<h4 id="continuous_operation">Pourquoi la fiabilit√© est-elle importante pour l&#8217;ex√©cution d&#8217;un n≈ìud Lightning¬†?</h4>
<div class="paragraph data-line-43">
<p>Dans Bitcoin, le mat√©riel n&#8217;est pas particuli√®rement important √† moins que l&#8217;on n&#8217;ex√©cute sp√©cifiquement un n≈ìud de minage.
Le logiciel de n≈ìud Bitcoin Core peut √™tre ex√©cut√© sur n&#8217;importe quelle machine qui r√©pond √† ses exigences minimales et n&#8217;a pas besoin d&#8217;√™tre en ligne pour recevoir des paiements, uniquement pour les envoyer.
Si un n≈ìud Bitcoin tombe en panne pendant une p√©riode prolong√©e, l&#8217;utilisateur peut simplement red√©marrer le n≈ìud, et une fois qu&#8217;il se connecte au reste du r√©seau, il se resynchronisera avec la blockchain.</p>
</div>
<div class="paragraph data-line-47">
<p>Dans Lightning, cependant, l&#8217;utilisateur doit √™tre en ligne √† la fois pour envoyer <em>et</em> pour recevoir des paiements. Si le n≈ìud Lightning est hors ligne, il ne peut recevoir aucun paiement de qui que ce soit et ses factures ouvertes ne peuvent donc pas √™tre honor√©es.
De plus, les canaux ouverts d&#8217;un n≈ìud hors ligne ne peuvent pas √™tre utilis√©s pour acheminer des paiements. Vos partenaires de canal remarqueront que vous √™tes hors ligne et ne pourront pas vous contacter pour acheminer un paiement. Si vous √™tes trop souvent hors ligne, ils peuvent consid√©rer que les bitcoins verrouill√©s dans leurs canaux avec vous est une capacit√© sous-utilis√©e et peuvent fermer ces canaux. Nous avons d√©j√† √©voqu√© le cas d&#8217;une attaque de protocole dans laquelle votre partenaire de canal tente de vous tromper en soumettant une transaction d&#8217;engagement ant√©rieure. Si vous √™tes hors ligne et que vos canaux ne sont pas surveill√©s, la tentative de vol peut r√©ussir et vous n&#8217;aurez aucun recours une fois le d√©lai expir√©.
Par cons√©quent, la fiabilit√© du n≈ìud est extr√™mement importante pour un n≈ìud Lightning.</p>
</div>
<div class="paragraph data-line-51">
<p>Il y a aussi les probl√®mes de panne mat√©rielle et de perte de donn√©es. Dans Bitcoin, une panne mat√©rielle peut √™tre un probl√®me trivial si l&#8217;utilisateur dispose d&#8217;une sauvegarde de sa phrase mn√©monique ou de ses cl√©s priv√©es. Le porte-monnaie Bitcoin et le bitcoin √† l&#8217;int√©rieur du porte-monnaie peuvent √™tre facilement restaur√©s √† partir des cl√©s priv√©es sur un nouvel ordinateur. La plupart des informations peuvent √™tre ret√©l√©charg√©es depuis la blockchain.</p>
</div>
<div class="paragraph data-line-53">
<p>En revanche, sur Lightning, les informations sur les canaux de l&#8217;utilisateur, y compris les transactions d&#8217;engagement et les secrets de r√©vocation, ne sont pas connues du public et ne sont stock√©es que sur le mat√©riel de l&#8217;utilisateur individuel.
Ainsi, les pannes logicielles et mat√©rielles du Lightning Network peuvent facilement entra√Æner une perte de fonds.</p>
</div>
</div>
<div class="sect3 data-line-56">
<h4 id="_types_de_n≈ìuds_lightning_mat√©riels">Types de n≈ìuds Lightning mat√©riels</h4>
<div class="paragraph data-line-58">
<p>Il existe trois principaux types de n≈ìuds Lightning mat√©riels¬†:</p>
</div>
<div class="dlist data-line-60">
<dl>
<dt class="hdlist1">Ordinateurs √† usage g√©n√©ral</dt>
<dd>
<p>Un n≈ìud LN peut √™tre ex√©cut√© sur un ordinateur personnel ou un ordinateur portable ex√©cutant Windows, macOS ou Linux. G√©n√©ralement, il est ex√©cut√© au c√¥t√© d&#8217;un n≈ìud Bitcoin.</p>
</dd>
<dt class="hdlist1">Mat√©riel d√©di√©</dt>
<dd>
<p>Un n≈ìud Lightning peut √©galement √™tre ex√©cut√© sur du mat√©riel d√©di√© comme un Raspberry Pi, Rock64 ou un mini PC. Cette configuration ex√©cuterait g√©n√©ralement une pile logicielle, y compris un n≈ìud Bitcoin et d&#8217;autres applications. Cette configuration est populaire car le mat√©riel est d√©di√© √† l&#8217;ex√©cution et √† la maintenance du n≈ìud Lightning uniquement et est g√©n√©ralement configur√© avec un "assistant" d&#8217;installation.</p>
</dd>
<dt class="hdlist1">Mat√©riel pr√©configur√©</dt>
<dd>
<p>Un n≈ìud LN peut √©galement √™tre ex√©cut√© sur du mat√©riel sp√©cialement con√ßu, s√©lectionn√© et configur√© pour cette t√¢che. Cela comprendrait des solutions de n≈ìuds Lightning "pr√™tes √† l&#8217;emploi" qui peuvent √™tre achet√©es sous forme de kit ou de syst√®me cl√© en main.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-64">
<h4 id="_ex√©cut√©_dans_le_cloud">Ex√©cut√© dans le "Cloud"</h4>
<div class="paragraph data-line-66">
<p>Les <em>Serveurs priv√©s virtuels</em> ("Virtual Private Server" ou "VPS" en anglais) et les services d&#8217;informatique en nuage ("cloud computing" en anglais) tels que Microsoft Azure, Google Cloud, Amazon Web Services (AWS) ou DigitalOcean sont assez abordables et peuvent √™tre mis en place tr√®s rapidement. Un n≈ìud Lightning peut √™tre h√©berg√© pour une somme entre 20 $ et 40 $ par mois sur de tels services.</p>
</div>
<div class="paragraph data-line-68">
<p>Cependant, comme le dit l&#8217;adage, "le &lsquo;cloud&rsquo; n&#8217;est que l&#8217;ordinateur d&#8217;autrui". Utiliser ces services signifie ex√©cuter votre n≈ìud sur les ordinateurs d&#8217;autres personnes. Cela comporte des avantages et des inconv√©nients correspondants. Les principaux avantages sont la commodit√©, l&#8217;efficacit√©, la disponibilit√© et peut-√™tre m√™me le co√ªt. L&#8217;op√©rateur cloud g√®re et ex√©cute le n≈ìud √† un haut niveau, vous offrant automatiquement commodit√© et efficacit√©. Ils offrent un temps de fonctionnement et une disponibilit√© excellents, souvent bien meilleurs que ce qu&#8217;un individu peut obtenir √† la maison. Si vous consid√©rez que le co√ªt de l&#8217;√©lectricit√© pour faire fonctionner un serveur dans de nombreux pays occidentaux est d&#8217;environ 10 $ par mois, ajoutez √† cela le co√ªt de la bande passante du r√©seau et du mat√©riel lui-m√™me, l&#8217;offre VPS devient financi√®rement comp√©titive. Enfin, avec un VPS, vous n&#8217;avez pas besoin d&#8217;espace pour un PC √† la maison et vous n&#8217;avez aucun probl√®me avec le bruit ou la chaleur du PC.
En revanche, il existe plusieurs inconv√©nients notables. Un n≈ìud Lightning ex√©cut√© dans le "cloud" sera toujours moins s√©curis√© et moins priv√© qu&#8217;un n≈ìud ex√©cut√© sur votre propre ordinateur. De plus, ces services d&#8217;informatique en nuage sont tr√®s centralis√©s. La grande majorit√© des n≈ìuds Bitcoin et Lightning fonctionnant sur ces services sont situ√©s dans une poign√©e de centres de donn√©es en Virginie, √† Sunnyvale, Seattle, Londres et Francfort. Lorsque les r√©seaux ou les centres de donn√©es de ces fournisseurs ont des probl√®mes de service, cela affecte des milliers de n≈ìuds sur des r√©seaux pr√©tendument ¬´ d√©centralis√©s ¬ª.</p>
</div>
<div class="paragraph data-line-71">
<p>Si vous avez la possibilit√© et la capacit√© d&#8217;ex√©cuter un n≈ìud sur votre propre ordinateur √† la maison ou au bureau, cela peut √™tre pr√©f√©rable de l&#8217;y ex√©cuter
plut√¥t que sur le cloud. N√©anmoins, si l&#8217;ex√©cution de votre propre serveur n&#8217;est pas une option, envisagez certainement d&#8217;en ex√©cuter un sur un VPS.</p>
</div>
</div>
<div class="sect3 data-line-74">
<h4 id="_ex√©cuter_un_n≈ìud_√†_la_maison">Ex√©cuter un n≈ìud √† la maison</h4>
<div class="paragraph data-line-76">
<p>Si vous disposez d&#8217;une connexion Internet de capacit√© raisonnable √† la maison ou dans votre bureau, vous pouvez certainement y ex√©cuter un n≈ìud Lightning. Toute connexion "haut d√©bit" est suffisante pour ex√©cuter un n≈ìud l√©ger, et une connexion rapide vous permettra √©galement d&#8217;ex√©cuter un n≈ìud complet Bitcoin.</p>
</div>
<div class="paragraph data-line-78">
<p>Bien que vous puissiez ex√©cuter un n≈ìud Lightning (et m√™me un n≈ìud Bitcoin) sur votre ordinateur portable, cela deviendra rapidement ennuyeux. Ces programmes consomment les ressources de votre ordinateur et doivent fonctionner 24h/24 et 7j/7. Vos applications utilisateur telles que votre navigateur ou votre feuille de calcul seront en concurrence avec les services d&#8217;arri√®re-plan Lightning pour les ressources de votre ordinateur. En d&#8217;autres termes, votre navigateur et d&#8217;autres charges de travail de bureau seront ralentis.
Et lorsque votre application de traitement de texte g√®le votre ordinateur portable, votre n≈ìud Lightning s&#8217;arr√™te √©galement, vous laissant incapable de recevoir des transactions et potentiellement vuln√©rable aux attaques. De plus, vous ne devez jamais √©teindre votre ordinateur portable.
Tout cela combin√© donne une configuration qui n&#8217;est pas id√©ale. Il en va de m√™me pour votre ordinateur de bureau personnel utilis√© quotidiennement.</p>
</div>
<div class="paragraph data-line-82">
<p>Au lieu de cela, la plupart des utilisateurs choisiront d&#8217;ex√©cuter un n≈ìud sur un ordinateur d√©di√©.
Heureusement, vous n&#8217;avez pas besoin d&#8217;un ordinateur de classe "serveur" pour ce faire.
Vous pouvez ex√©cuter un n≈ìud Lightning sur un ordinateur monocarte, tel qu&#8217;un Raspberry Pi ou sur un mini PC (g√©n√©ralement commercialis√© comme PC de Home Cin√©ma).
Ce sont de simples ordinateurs qui sont couramment utilis√©s comme hub domotique ou serveur multim√©dia.
Ils sont relativement peu co√ªteux par rapport √† un PC ou un ordinateur portable.
L&#8217;avantage d&#8217;un appareil d√©di√© en tant que plateforme pour les n≈ìuds Lightning et Bitcoin est qu&#8217;il peut fonctionner en continu, silencieusement et discr√®tement sur votre r√©seau domestique, cach√© derri√®re votre routeur ou votre t√©l√©viseur.
Personne ne saura m√™me que cette petite bo√Æte fait partie d&#8217;un syst√®me bancaire mondial !</p>
</div>
<div class="admonitionblock warning data-line-91">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-92">
<p>L&#8217;utilisation d&#8217;un n≈ìud sur un syst√®me d&#8217;exploitation 32 bits et/ou un processeur 32 bits n&#8217;est pas recommand√©e, car le logiciel du n≈ìud peut rencontrer des probl√®mes de ressources, provoquant un plantage et √©ventuellement une perte de fonds.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-95">
<h4 id="_quel_mat√©riel_est_requis_pour_ex√©cuter_un_n≈ìud_lightning">Quel mat√©riel est requis pour ex√©cuter un n≈ìud Lightning¬†?</h4>
<div class="paragraph data-line-97">
<p>Au minimum, les √©l√©ments suivants sont requis pour ex√©cuter un n≈ìud Lightning¬†:</p>
</div>
<div class="dlist data-line-99">
<dl>
<dt class="hdlist1">CPU</dt>
<dd>
<p>Une puissance de traitement suffisante est n√©cessaire pour ex√©cuter un n≈ìud Bitcoin, qui t√©l√©chargera et validera en permanence de nouveaux blocs. L&#8217;utilisateur doit √©galement tenir compte du t√©l√©chargement initial des blocs ("Initial Block Download" ou "IBD" en anglais) lors de la configuration d&#8217;un nouveau n≈ìud Bitcoin qui peut prendre de plusieurs heures √† plusieurs jours. Un processeur √† 2 ou 4 c≈ìurs est recommand√©.</p>
</dd>
<dt class="hdlist1">RAM</dt>
<dd>
<p>Un syst√®me avec 2 Go de RAM ex√©cutera qu&#8217;√† peine les n≈ìuds Bitcoin et Lightning. Il fonctionnera beaucoup mieux avec au moins 4 Go de RAM. L&#8217;IBD sera particuli√®rement difficile avec moins de 4 Go de RAM. Plus de 8 Go de RAM sont inutiles car le CPU est le plus grand goulet d&#8217;√©tranglement pour ces types de services, en raison d&#8217;op√©rations cryptographiques telles que la validation de signature.</p>
</dd>
<dt class="hdlist1">Unit√© de stockage</dt>
<dd>
<p>Il peut s&#8217;agir d&#8217;un disque dur (HDD) ou d&#8217;un disque √† semi-conducteurs (SSD).
Un SSD sera nettement plus rapide (mais plus cher) pour ex√©cuter un n≈ìud.
La majeure partie du stockage est utilis√©e par la blockchain Bitcoin, qui fait des centaines de gigaoctets.
Un compromis √©quitable (co√ªt pour la complexit√©) consiste √† acheter un petit SSD pour d√©marrer le syst√®me d&#8217;exploitation et un disque dur plus grand pour stocker des donn√©es volumineuses (principalement des bases de donn√©es).</p>
</dd>
</dl>
</div>
<div class="admonitionblock note data-line-109">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-110">
<p>Les Raspberry Pis sont un choix courant pour ex√©cuter un logiciel de n≈ìud, en raison du co√ªt et de la disponibilit√© des pi√®ces.
Le syst√®me d&#8217;exploitation qui s&#8217;ex√©cute sur l&#8217;appareil d√©marre g√©n√©ralement √† partir d&#8217;une carte Secure Digital (SD).
Pour la plupart des cas d&#8217;utilisation, ce n&#8217;est pas un probl√®me, mais Bitcoin Core est connu pour √™tre lourd en E/S.
Vous devez vous assurer de placer la blockchain Bitcoin et le r√©pertoire de donn√©es Lightning sur un autre lecteur, car des E/S intensives √† long terme peuvent entra√Æner des d√©faillances avec une carte SD.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist data-line-116">
<dl>
<dt class="hdlist1">Connexion Internet</dt>
<dd>
<p>Une connexion Internet fiable est n√©cessaire pour t√©l√©charger de nouveaux blocs Bitcoin, ainsi que pour communiquer avec d&#8217;autres pairs Lightning. Pendant le fonctionnement, l&#8217;utilisation estim√©e des donn√©es varie de 10 √† 100 Go par mois, selon la configuration. Au d√©marrage, un n≈ìud complet Bitcoin t√©l√©charge la blockchain compl√®te.</p>
</dd>
<dt class="hdlist1">Alimentation</dt>
<dd>
<p>Une alimentation √©lectrique fiable est n√©cessaire car les n≈ìuds Lightning doivent √™tre en ligne √† tout moment. Une panne de courant entra√Ænera l&#8217;√©chec des paiements en cours. Pour les n≈ìuds de routage √† usage intensif, une alimentation de secours ou sans coupure (UPS) est utile en cas de panne de courant.
Id√©alement, vous devriez √©galement connecter votre routeur Internet √† cet onduleur.</p>
</dd>
<dt class="hdlist1">Sauvegarde</dt>
<dd>
<p>La sauvegarde est cruciale car une panne peut entra√Æner une perte de donn√©es et donc une perte de fonds.
Vous devrez envisager une sorte de solution de sauvegarde des donn√©es. Il peut s&#8217;agir d&#8217;une sauvegarde automatis√©e bas√©e sur le cloud vers un serveur ou un service Web que vous contr√¥lez. Alternativement, il peut s&#8217;agir d&#8217;une sauvegarde mat√©rielle locale automatis√©e, telle qu&#8217;un deuxi√®me disque dur. Pour de meilleurs r√©sultats, les sauvegardes locales et distantes peuvent √™tre combin√©es.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-124">
<h4 id="_changer_de_configuration_de_serveur_dans_le_cloud">Changer de configuration de serveur dans le cloud</h4>
<div class="paragraph data-line-126">
<p>Lors de la location d&#8217;un serveur cloud, il est souvent rentable de modifier la configuration entre deux phases de fonctionnement. Un processeur plus rapide et un stockage plus rapide seront n√©cessaires pendant l&#8217;IBD (par exemple, le premier jour). Une fois la blockchain synchronis√©e, les exigences en mati√®re de vitesse de processeur et de stockage sont bien inf√©rieures, de sorte que les performances peuvent √™tre r√©duites √† un niveau plus rentable.</p>
</div>
<div class="paragraph data-line-128">
<p>Par exemple, sur le cloud d&#8217;Amazon, nous utiliserions une RAM de 8 √† 16 Go, un processeur √† 8 c≈ìurs (par exemple, t3-large ou m3.large) et un SSD de 400 Go plus rapide (plus de 1000 op√©rations d&#8217;entr√©e/sortie provisionn√©es par seconde [IOPS]) pour l&#8217;IBD, r√©duisant son temps √† seulement 6-8 heures. Une fois cette op√©ration termin√©e, nous basculerions l&#8217;instance de serveur sur une RAM de 2 Go, un processeur √† 2 c≈ìurs (par exemple, t3.small) et le stockage sur un disque dur √† usage g√©n√©ral de 1 To. Cela co√ªtera √† peu pr√®s le m√™me prix que si vous l&#8217;ex√©cutiez sur le serveur le plus lent tout le temps, mais cela vous permettra d&#8217;√™tre op√©rationnel en moins d&#8217;une journ√©e au lieu d&#8217;avoir √† attendre presque une semaine pour l&#8217;IBD.</p>
</div>
<div class="sect4 data-line-130">
<h5 id="_stockage_permanent_des_donn√©es_lecteur">Stockage permanent des donn√©es (lecteur)</h5>
<div class="paragraph data-line-132">
<p>Si vous utilisez un mini PC ou louez un serveur, le stockage peut √™tre la partie la plus ch√®re, co√ªtant autant comme l&#8217;ordinateur et la connectivit√© (donn√©es) additionn√©s.</p>
</div>
<div class="paragraph data-line-134">
<p>Voyons ensemble les diff√©rentes options disponibles. Premi√®rement, il existe deux principaux types de disques, les disques durs et les disques SSD. Les disques durs sont moins chers et les SSD sont plus rapides, mais les deux font le travail.</p>
</div>
<div class="paragraph data-line-136">
<p>Les SSD les plus rapides disponibles aujourd&#8217;hui utilisent l&#8217;interface NVMe ("Non-Volatile Memory Express" en anglais). Les SSD NVMe sont plus rapides dans les machines haut de gamme, mais aussi plus co√ªteux.
Les SSD traditionnels bas√©s sur SATA sont moins chers, mais pas aussi rapides. Les SSD SATA fonctionnent suffisamment bien pour l&#8217;installation de votre n≈ìud.
Les petits ordinateurs peuvent ne pas √™tre en mesure de tirer parti des SSD NVMe.
Par exemple, le Raspberry Pi 4 ne peut pas en b√©n√©ficier √† cause de la bande passante limit√©e de son port USB.</p>
</div>
<div class="paragraph data-line-141">
<p>Pour choisir la taille, regardons la blockchain Bitcoin. En ao√ªt 2021, sa taille est de 360 Go, y compris l&#8217;indice de transactions, et augmente d&#8217;environ 60 Go par an. Si vous souhaitez avoir une certaine marge disponible pour une croissance future ou pour installer d&#8217;autres donn√©es sur votre n≈ìud, achetez au moins un disque de 512 Go, ou mieux encore, un disque de 1 To.</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-144">
<h3 id="helpers">Utilisation d&#8217;un installateur ou d&#8217;un assistant</h3>
<div class="paragraph data-line-146">
<p>L&#8217;installation d&#8217;un n≈ìud Lightning ou d&#8217;un n≈ìud Bitcoin peut √™tre intimidante si vous n&#8217;√™tes pas familier avec un environnement de ligne de commande. Heureusement, il existe un certain nombre de projets qui proposent des "assistants", c&#8217;est-√†-dire des logiciels qui installent et configurent les diff√©rents composants pour vous. Vous aurez toujours besoin d&#8217;apprendre quelques incantations en ligne de commande pour interagir avec votre n≈ìud, mais la plupart du travail initial est fait pour vous.</p>
</div>
<div class="sect3 data-line-148">
<h4 id="_raspiblitz">RaspiBlitz</h4>
<div class="paragraph data-line-150">
<p>L&#8217;un des "assistant" les plus populaires et les plus complets est <em>RaspiBlitz</em> (<a href="#RaspiBlitz">Un n≈ìud RaspiBlitz</a>), un projet construit par Christian Rotzoll. Il est destin√© √† √™tre install√© sur un Raspberry Pi 4. RaspiBlitz est livr√© avec un kit mat√©riel recommand√© que vous pouvez construire en quelques heures ou tout au plus un week-end. Si vous assistez √† un "hackathon" Lightning dans votre ville, vous verrez probablement de nombreuses personnes travailler sur leur configuration RaspiBlitz, √©changer des conseils et s&#8217;entraider. Vous pouvez trouver le projet RaspiBlitz sur <a href="https://github.com/rootzoll/raspiblitz" data-href="https://github.com/rootzoll/raspiblitz">GitHub</a>.</p>
</div>
<div class="paragraph data-line-152">
<p>En plus d&#8217;un n≈ìud Bitcoin et Lightning, RaspiBlitz peut installer un certain nombre de services suppl√©mentaires, tels que¬†:</p>
</div>
<div class="ulist data-line-154">
<ul>
<li class="data-line-154">
<p>Tor (ex√©cut√© en tant que service cach√©)</p>
</li>
<li class="data-line-155">
<p>ElectRS (serveur Electrum en Rust)</p>
</li>
<li class="data-line-156">
<p>Serveur BTCPay (processeur de paiement en cryptomonnaie)</p>
</li>
<li class="data-line-157">
<p>Explorateur BTC RPC (explorateur de blockchain Bitcoin)</p>
</li>
<li class="data-line-158">
<p>Ride The Lightning (interface graphique de gestion de n≈ìuds Lightning)</p>
</li>
<li class="data-line-159">
<p>LNbits (porte-monnaie Lightning/syst√®me de comptes)</p>
</li>
<li class="data-line-160">
<p>Spectre Desktop (multisig Trezor, Ledger, porte-monnaie Coldcard et Spectre-DIY)</p>
</li>
<li class="data-line-161">
<p>lndmanage (interface de ligne de commande pour la gestion avanc√©e de canaux)</p>
</li>
<li class="data-line-162">
<p>Loop (service d&#8217;√©changes sous-marins)</p>
</li>
<li class="data-line-163">
<p>Join Market (service CoinJoin)</p>
</li>
</ul>
</div>
<div id="RaspiBlitz" class="imageblock data-line-167">
<div class="content">
<img src="images/mtln_0501.png" alt="mtln 0501">
</div>
<div class="title">Figure 1. Un n≈ìud RaspiBlitz</div>
</div>
</div>
<div class="sect3 data-line-169">
<h4 id="_mynode">myNode</h4>
<div class="paragraph data-line-171">
<p><a href="https://mynodebtc.com" data-href="https://mynodebtc.com"><em>myNode</em></a> est un autre projet "d&#8217;assistant" open source populaire comprenant beaucoup de logiciels li√©s au Bitcoin. Il est facile √† installer : vous ¬´ flashez ¬ª le programme d&#8217;installation sur une carte SD et d√©marrez votre mini PC √† partir de la carte SD. Vous n&#8217;avez besoin d&#8217;aucun moniteur pour utiliser myNode car les outils d&#8217;administration sont accessibles √† distance depuis un navigateur. Si votre mini PC n&#8217;a pas d&#8217;√©cran, de souris ou de clavier, vous pouvez le g√©rer depuis un autre ordinateur ou m√™me depuis votre smartphone. Une fois install√©, rendez-vous sur <a href="http://mynode.local" class="undefined" data-href="http://mynode.local">http://mynode.local</a> et cr√©ez un porte-monnaie et un n≈ìud Lightning en deux clics.</p>
</div>
<div class="paragraph data-line-173">
<p>En plus d&#8217;un n≈ìud Bitcoin et Lightning, myNode peut √©ventuellement installer une vari√©t√© de services suppl√©mentaires, tels que :</p>
</div>
<div class="ulist data-line-175">
<ul>
<li class="data-line-175">
<p>Ride The Lightning (interface graphique de gestion de n≈ìuds Lightning)</p>
</li>
<li class="data-line-176">
<p>OpenVPN (prise en charge du r√©seau priv√© virtuel [VPN] pour la gestion √† distance ou le porte-monnaie)</p>
</li>
<li class="data-line-177">
<p>lndmanage (interface de ligne de commande pour la gestion avanc√©e de canaux)</p>
</li>
<li class="data-line-178">
<p>BTC RPC Explorer (un explorateur de blockchain Bitcoin)</p>
</li>
</ul>
</div>
</div>
<div class="sect3 data-line-180">
<h4 id="_umbrel">Umbrel</h4>
<div class="paragraph data-line-182">
<p>C√©l√®bres pour leur UX/UI (d√©montr√©e dans <a href="#umbrel">L&#8217;interface Web d&#8217;Umbrel</a>), <em>Umbrel</em> fournit un moyen tr√®s simple et accessible de faire fonctionner votre n≈ìud Bitcoin et Lightning en un rien de temps, en particulier pour les d√©butants. Une caract√©ristique tr√®s distinctive est qu&#8217;Umbrel utilise Neutrino/SPV pendant l&#8217;IBD afin que vous puissiez commencer instantan√©ment √† utiliser votre n≈ìud. Une fois que Bitcoin Core est enti√®rement synchronis√© en arri√®re-plan, il bascule automatiquement et d√©sactive le mode SPV. Umbrel OS prend en charge le Raspberry Pi 4 et peut √©galement √™tre install√© sur n&#8217;importe quel syst√®me d&#8217;exploitation bas√© sur Linux ou sur une machine virtuelle sous macOS ou Windows. Vous pouvez √©galement connecter n&#8217;importe quel porte-monnaie prenant en charge Bitcoin Core P2P, Bitcoin Core RPC, le protocole Electrum ou lndconnect.</p>
</div>
<div class="paragraph data-line-184">
<p>Il n&#8217;est pas n√©cessaire d&#8217;attendre un jour de pluie &mdash; vous pouvez vous rendre directement sur <a href="https://getumbrel.com" data-href="https://getumbrel.com">Umbrel</a> pour en savoir plus.</p>
</div>
<div id="umbrel" class="imageblock data-line-188">
<div class="content">
<img src="images/mtln_0502.png" alt="L&#8217;interface Web d&#8217;Umbrel">
</div>
<div class="title">Figure 2. L&#8217;interface Web d&#8217;Umbrel</div>
</div>
<div class="paragraph data-line-190">
<p>En plus d&#8217;un n≈ìud Bitcoin et Lightning, Umbrel a introduit l&#8217;App Store Umbrel, o√π vous pouvez facilement installer des services suppl√©mentaires, tels que :</p>
</div>
<div class="ulist data-line-192">
<ul>
<li class="data-line-192">
<p>Lightning Terminal (interface de gestion de la liquidit√© de canaux, Loop In et Loop Out)</p>
</li>
<li class="data-line-193">
<p>Ride The Lightning (interface graphique de gestion de n≈ìuds Lightning)</p>
</li>
<li class="data-line-194">
<p>Spectre Desktop (coordinateur de surveillance uniquement pour les porte-monnaie Bitcoin multisignature et √† cl√© unique)</p>
</li>
<li class="data-line-195">
<p>Serveur BTCPay (processeur de paiement en cryptomonnaie)</p>
</li>
<li class="data-line-196">
<p>Explorateur BTC RPC (explorateur de blockchain Bitcoin)</p>
</li>
<li class="data-line-197">
<p>ThunderHub (surveiller et g√©rer votre n≈ìud)</p>
</li>
<li class="data-line-198">
<p>Sphinx Relay (gestion de la connectivit√© et du stockage pour le chat Sphinx)</p>
</li>
<li class="data-line-199">
<p>mempool.space (visualiseur de mempool et explorateur de blocs)</p>
</li>
<li class="data-line-200">
<p>LNbits (porte-monnaie Lightning/syst√®me de comptes)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-202">
<p>Umbrel est actuellement encore en version b√™ta et n&#8217;est pas consid√©r√© comme s√©curis√©.</p>
</div>
</div>
<div class="sect3 data-line-204">
<h4 id="_btcpay_server">BTCPay Server</h4>
<div class="paragraph data-line-206">
<p>Bien qu&#8217;elle ne soit pas initialement con√ßue pour √™tre un "assistant" d&#8217;installation, la plateforme de commerce √©lectronique et de paiement <em>BTCPay Server</em> dispose d&#8217;un syst√®me d&#8217;installation incroyablement simple qui utilise des conteneurs Docker et docker-compose pour installer un n≈ìud Bitcoin, un n≈ìud Lightning et une passerelle de paiement, parmi de nombreux autres services. Il peut √™tre install√© sur une vari√©t√© de plateformes mat√©rielles, d&#8217;un simple Raspberry Pi 4 (4 Go recommand√©s) √† un mini PC ou un ancien ordinateur portable, de bureau ou un serveur.</p>
</div>
<div class="paragraph data-line-208">
<p><a href="https://btcpayserver.org" data-href="https://btcpayserver.org">BTCPay Server</a> est une plateforme de commerce √©lectronique enti√®rement h√©berg√©e et autonome qui peut √™tre int√©gr√©e √† de nombreuses plateformes de commerce √©lectronique, telles que WordPress WooCommerce et autres. L&#8217;installation du n≈ìud complet n&#8217;est qu&#8217;une √©tape de l&#8217;installation de la plateforme de commerce √©lectronique.
Bien qu&#8217;initialement d√©velopp√© comme un remplacement fonctionnalit√© par fonctionnalit√© du service de paiement commercial <em>BitPay</em> et de son API, il a √©volu√© au-del√† pour devenir une plateforme compl√®te pour les services BTC et Lightning li√©s au commerce √©lectronique. Pour de nombreux vendeurs ou magasins, il s&#8217;agit d&#8217;une solution cl√© en main pour le commerce √©lectronique.</p>
</div>
<div class="paragraph data-line-211">
<p>En plus d&#8217;un n≈ìud Bitcoin et Lightning, BTCPay Server peut √©galement installer une vari√©t√© de services, notamment :</p>
</div>
<div class="ulist data-line-213">
<ul>
<li class="data-line-213">
<p>Un n≈ìud Lightning <code>c-lightning</code> ou LND</p>
</li>
<li class="data-line-214">
<p>Prise en charge de Litecoin</p>
</li>
<li class="data-line-215">
<p>Prise en charge de Monero</p>
</li>
<li class="data-line-216">
<p>Serveur Spark (porte-monnaie Web <code>c-lightning</code>)</p>
</li>
<li class="data-line-217">
<p>Serveur Charge (API de commerce √©lectronique <code>c-lightning</code>)</p>
</li>
<li class="data-line-218">
<p>Ride The Lightning (interface graphique Web de gestion de n≈ìuds Lightning)</p>
</li>
<li class="data-line-219">
<p>De nombreux forks de BTC</p>
</li>
<li class="data-line-220">
<p>BTCTransmuter (service d&#8217;automatisation d&#8217;√©v√©nement-action prenant en charge l&#8217;√©change de devises)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-222">
<p>Le nombre de services et de fonctionnalit√©s suppl√©mentaires augmente rapidement, de sorte que la liste pr√©c√©dente n&#8217;est qu&#8217;un petit sous-ensemble de ce qui est disponible sur la plateforme BTCPay Server.</p>
</div>
</div>
<div class="sect3 data-line-224">
<h4 id="_n≈ìud_bitcoin_ou_lightning_l√©ger">N≈ìud Bitcoin ou Lightning l√©ger</h4>
<div class="paragraph data-line-226">
<p>Un choix critique pour votre installation sera celui du n≈ìud Bitcoin et de sa configuration. <em>Bitcoin Core</em>, l&#8217;impl√©mentation de r√©f√©rence, est le choix le plus courant mais pas l&#8217;unique choix disponible. Un choix alternatif est <em>btcd</em>, qui est une impl√©mentation en langage Go de n≈ìud Bitcoin. btcd prend en charge certaines fonctionnalit√©s utiles pour ex√©cuter un n≈ìud LND Lightning et qui ne sont pas disponibles avec Bitcoin Core.</p>
</div>
<div class="paragraph data-line-228">
<p>Une deuxi√®me consid√©ration est de savoir si vous ex√©cuterez un n≈ìud Bitcoin <em>d&#8217;archivage</em> avec une copie compl√®te de la blockchain (environ 350 Go √† la mi-2021) ou une blockchain <em>r√©duite</em> ("pruned" en anglais) qui ne conserve que les blocs les plus r√©cents. Une blockchain r√©duite peut vous faire √©conomiser de l&#8217;espace disque, mais vous devrez toujours t√©l√©charger la blockchain compl√®te au moins une fois (pendant l&#8217;IBD). Par cons√©quent, cela ne vous fera pas √©conomiser de trafic r√©seau. L&#8217;utilisation d&#8217;un n≈ìud r√©duit pour ex√©cuter un n≈ìud Lightning est toujours une possibilit√© exp√©rimentale et peut ne pas prendre en charge toutes les fonctionnalit√©s. Cependant, de nombreuses personnes ex√©cutent un n≈ìud comme celui-ci avec succ√®s.</p>
</div>
<div class="paragraph data-line-230">
<p>Enfin, vous avez √©galement la possibilit√© de ne pas ex√©cuter de n≈ìud Bitcoin du tout. Au lieu de cela, vous pouvez utiliser le n≈ìud LND Lightning en mode "l√©ger" ("lightweight" en anglais), en utilisant le protocole Neutrino pour r√©cup√©rer les informations de la blockchain √† partir des n≈ìuds publics Bitcoin exploit√©s par d&#8217;autres. L&#8217;ex√©cuter ainsi signifie que vous prenez des ressources du r√©seau Bitcoin sans en offrir en retour. √Ä la place, vous offrez vos ressources et contribuez √† la communaut√© LN. Pour les n≈ìuds Lightning plus petits, cela r√©duira g√©n√©ralement le trafic r√©seau par rapport √† l&#8217;ex√©cution d&#8217;un n≈ìud Bitcoin complet.</p>
</div>
<div class="paragraph data-line-232">
<p>Gardez √† l&#8217;esprit que l&#8217;exploitation d&#8217;un n≈ìud Bitcoin vous permet de prendre en charge d&#8217;autres services, en plus et en plus d&#8217;un n≈ìud Lightning. Ces autres services peuvent n√©cessiter un n≈ìud Bitcoin d&#8217;archivage (non r√©duit) et ne peuvent souvent pas fonctionner sans n≈ìud Bitcoin. Consid√©rez d√®s le d√©part quels autres services vous pourriez vouloir ex√©cuter maintenant ou √† l&#8217;avenir pour prendre une d√©cision √©clair√©e sur le type de n≈ìud Bitcoin que vous s√©lectionnez.</p>
</div>
<div class="paragraph data-line-234">
<p>L&#8217;essentiel de cette d√©cision est¬†: si vous pouvez vous permettre un disque de plus de 500 Go, ex√©cutez un n≈ìud Bitcoin d&#8217;archivage complet. Vous apporterez des ressources au syst√®me Bitcoin et aiderez les autres qui n&#8217;ont pas les moyens de le faire. Si vous ne pouvez pas vous permettre un disque aussi gros, ex√©cutez un n≈ìud r√©duit. Si vous ne pouvez pas vous permettre le disque ou la bande passante m√™me pour un n≈ìud √©lagu√©, ex√©cutez un n≈ìud LND l√©ger sur Neutrino.</p>
</div>
</div>
<div class="sect3 data-line-236">
<h4 id="_choix_du_syst√®me_dexploitation">Choix du syst√®me d&#8217;exploitation</h4>
<div class="paragraph data-line-238">
<p>L&#8217;√©tape suivante consiste √† s√©lectionner un syst√®me d&#8217;exploitation pour votre n≈ìud. La grande majorit√© des serveurs Internet fonctionnent sur une variante de Linux. Linux est la plateforme de choix pour Internet car il s&#8217;agit d&#8217;un puissant syst√®me d&#8217;exploitation open source. Linux, cependant, a une courbe d&#8217;apprentissage abrupte et n√©cessite une familiarit√© avec un environnement de ligne de commande. C&#8217;est souvent intimidant pour les nouveaux utilisateurs.</p>
</div>
<div class="paragraph data-line-240">
<p>En fin de compte, la plupart des services peuvent √™tre ex√©cut√©s sur n&#8217;importe quel syst√®me d&#8217;exploitation POSIX moderne, y compris macOS, Windows et bien s√ªr Linux. Votre choix doit √™tre davantage motiv√© par votre familiarit√© et votre confort avec un syst√®me d&#8217;exploitation et vos objectifs d&#8217;apprentissage. Si vous souhaitez approfondir vos connaissances et apprendre √† utiliser un syst√®me Linux, c&#8217;est une excellente occasion de le faire avec un projet sp√©cifique et un objectif clair. Si vous voulez juste qu&#8217;un n≈ìud soit op√©rationnel, utilisez ce que vous connaissez.</p>
</div>
<div class="paragraph data-line-242">
<p>De nos jours, de nombreux services sont √©galement d√©livr√©s sous forme de conteneurs, g√©n√©ralement bas√©s sur le syst√®me Docker. Ces conteneurs peuvent √™tre d√©ploy√©s sur une vari√©t√© de syst√®mes d&#8217;exploitation, en faisant abstraction du syst√®me d&#8217;exploitation sous-jacent. Vous devrez peut-√™tre n√©anmoins apprendre certaines commandes de la ligne de commande de Linux, car la plupart des conteneurs ex√©cutent une variante de Linux en interne.</p>
</div>
</div>
</div>
<div class="sect2 data-line-244">
<h3 id="_choisissez_votre_impl√©mentation_de_n≈ìud_lightning">Choisissez votre impl√©mentation de n≈ìud Lightning</h3>
<div class="paragraph data-line-246">
<p>Comme pour le choix du syst√®me d&#8217;exploitation, votre choix d&#8217;impl√©mentation de n≈ìud Lightning doit d√©pendre principalement de votre familiarit√© avec le langage de programmation et les outils de d√©veloppement utilis√©s par les projets. Bien qu&#8217;il existe quelques petites diff√©rences de fonctionnalit√©s entre les diff√©rentes impl√©mentations de n≈ìuds, celles-ci sont relativement mineures et la plupart des impl√©mentations convergent vers les normes communes d√©finies dans les BOLT.</p>
</div>
<div class="paragraph data-line-248">
<p>La connaissance du langage de programmation et du syst√®me de compilation, en revanche, sont de bonnes bases pour choisir un n≈ìud. En effet, l&#8217;installation, la configuration, la maintenance continue et le d√©pannage impliqueront tous d&#8217;interagir avec les diff√©rents outils utilis√©s par le syst√®me de compilation. Ceci comprend¬†:</p>
</div>
<div class="ulist data-line-250">
<ul>
<li class="data-line-250">
<p>Utilitaires Make, Autotools et GNU pour <code>c-lightning</code></p>
</li>
<li class="data-line-251">
<p>Utilitaires Go pour LND</p>
</li>
<li class="data-line-252">
<p>Java/Maven pour Eclair</p>
</li>
</ul>
</div>
<div class="paragraph data-line-254">
<p>Le langage de programmation influence non seulement le choix du syst√®me de compilation, mais √©galement de nombreux autres aspects du programme. Chaque langage de programmation est livr√© avec une philosophie de conception compl√®te et affecte de nombreux autres aspects, tels que¬†:</p>
</div>
<div class="ulist data-line-256">
<ul>
<li class="data-line-256">
<p>Format et syntaxe des fichiers de configuration</p>
</li>
<li class="data-line-257">
<p>Emplacements des fichiers (dans le syst√®me de fichiers)</p>
</li>
<li class="data-line-258">
<p>Arguments de ligne de commande et leur syntaxe</p>
</li>
<li class="data-line-259">
<p>Formatage des messages d&#8217;erreur</p>
</li>
<li class="data-line-260">
<p>Biblioth√®ques pr√©-requises</p>
</li>
<li class="data-line-261">
<p>Interfaces d&#8217;appel de proc√©dure √† distance (RPC)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-263">
<p>Lorsque vous choisissez votre n≈ìud Lightning, vous choisissez √©galement toutes les caract√©ristiques susmentionn√©es. Ainsi, votre familiarit√© avec ces outils et ces philosophies de conception facilitera l&#8217;ex√©cution d&#8217;un n≈ìud. Ou la rendra plus difficile, si vous vous retrouvez dans un domaine inconnu.</p>
</div>
<div class="paragraph data-line-265">
<p>D&#8217;un autre c√¥t√©, s&#8217;il s&#8217;agit de votre premi√®re incursion dans l&#8217;environnement de la ligne de commande et des serveurs/services, vous ne serez pas familiaris√© avec les impl√©mentations et aurez l&#8217;opportunit√© d&#8217;apprendre quelque chose de compl√®tement nouveau. Dans ce cas, vous voudrez peut-√™tre d√©cider en fonction d&#8217;un certain nombre d&#8217;autres facteurs, tels que¬†:</p>
</div>
<div class="ulist data-line-267">
<ul>
<li class="data-line-267">
<p>Qualit√© des forums de support et des salons de chat</p>
</li>
<li class="data-line-268">
<p>Qualit√© de la documentation</p>
</li>
<li class="data-line-269">
<p>Degr√© d&#8217;int√©gration avec d&#8217;autres outils que vous souhaitez ex√©cuter</p>
</li>
</ul>
</div>
<div class="paragraph data-line-271">
<p>Enfin, vous souhaiterez peut-√™tre examiner les performances et la fiabilit√© des diff√©rentes impl√©mentations de n≈ìuds. Ceci est particuli√®rement important si vous utilisez ce n≈ìud dans un environnement de production et que vous vous attendez √† un trafic important et √† des exigences de fiabilit√© √©lev√©es. Cela peut √™tre le cas si vous envisagez de faire fonctionner le syst√®me de paiement d&#8217;une boutique.</p>
</div>
</div>
<div class="sect2 data-line-273">
<h3 id="_installer_un_n≈ìud_bitcoin_ou_lightning">Installer un n≈ìud Bitcoin ou Lightning</h3>
<div class="paragraph data-line-275">
<p>Vous avez d√©cid√© de ne pas utiliser "d&#8217;assistant" d&#8217;installation et √† la place de plonger dans la ligne de commande d&#8217;un syst√®me d&#8217;exploitation Linux¬†? C&#8217;est une d√©cision courageuse, et nous essaierons de vous aider √† la mettre en ≈ìuvre. Si vous pr√©f√©rez ne pas essayer de le faire manuellement, envisagez d&#8217;utiliser une application qui vous aide √† installer le logiciel de n≈ìud ou une solution bas√©e sur un conteneur, comme d√©crit dans <a href="#helpers">Utilisation d&#8217;un installateur ou d&#8217;un assistant</a>.</p>
</div>
<div class="admonitionblock warning data-line-278">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-279">
<p>Cette section approfondira le sujet avanc√© de l&#8217;administration syst√®me √† partir de la ligne de commande. L&#8217;administration Linux est un ensemble de comp√©tences qui n&#8217;entre pas dans le cadre de ce livre. C&#8217;est un sujet compliqu√© et les pi√®ges sont nombreux. Proc√©dez avec prudence¬†!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-282">
<p>Dans les prochaines sections, nous d√©crirons bri√®vement comment installer et configurer un n≈ìud Bitcoin et Lightning sur un syst√®me d&#8217;exploitation Linux. Vous devrez consulter les instructions d&#8217;installation des applications de n≈ìud Bitcoin et Lightning sp√©cifiques que vous avez d√©cid√© d&#8217;utiliser. Vous pouvez g√©n√©ralement les trouver dans un fichier appel√© <em>INSTALL</em> ou dans le sous-r√©pertoire <em>docs</em> de chaque projet. Nous ne d√©crirons que certaines des √©tapes communes qui s&#8217;appliquent √† tous ces services, et les instructions que nous proposons seront n√©cessairement incompl√®tes.</p>
</div>
<div class="sect3 data-line-284">
<h4 id="_services_en_arri√®re_plan">Services en arri√®re-plan</h4>
<div class="paragraph data-line-286">
<p>Pour ceux qui sont habitu√©s √† ex√©cuter des applications sur leur ordinateur de bureau ou leur smartphone, une application a toujours une interface utilisateur graphique m√™me si elle peut s&#8217;ex√©cutent parfois en arri√®re-plan. Les applications de n≈ìud Bitcoin et Lightning sont cependant tr√®s diff√©rentes. Ces applications n&#8217;ont pas d&#8217;interface utilisateur graphique int√©gr√©e. Au lieu de cela, elles s&#8217;ex√©cutent en tant que services <em>headless</em> en arri√®re-plan, ce qui signifie qu&#8217;elles fonctionnent toujours en arri√®re-plan et n&#8217;interagissent pas directement avec l&#8217;utilisateur.</p>
</div>
<div class="paragraph data-line-288">
<p>Cela peut cr√©er une certaine confusion pour les utilisateurs qui ne sont pas habitu√©s √† ex√©cuter des services en arri√®re-plan. Comment savez-vous si un tel service est actuellement en cours d&#8217;ex√©cution¬†? Comment le d√©marrer et l&#8217;arr√™ter ? Comment interagissez-vous avec lui ? Les r√©ponses √† ces questions d√©pendent du syst√®me d&#8217;exploitation que vous utilisez. Pour l&#8217;instant, nous supposerons que vous utilisez une variante Linux et y r√©pondrons dans ce contexte.</p>
</div>
</div>
<div class="sect3 data-line-290">
<h4 id="_isolement_de_processus">Isolement de processus</h4>
<div class="paragraph data-line-292">
<p>Les services en arri√®re-plan s&#8217;ex√©cutent g√©n√©ralement sous un compte d&#8217;utilisateur sp√©cifique pour les isoler du syst√®me d&#8217;exploitation et les uns des autres. Par exemple, Bitcoin Core est configur√© pour s&#8217;ex√©cuter en tant qu&#8217;utilisateur bitcoin. Vous devrez utiliser la ligne de commande pour cr√©er un utilisateur pour chacun des services que vous ex√©cutez.</p>
</div>
<div class="paragraph data-line-294">
<p>De plus, si vous avez connect√© un lecteur externe, vous devrez indiquer au syst√®me d&#8217;exploitation de d√©placer le r√©pertoire personnel de l&#8217;utilisateur sur ce lecteur. En effet, un service comme Bitcoin Core cr√©era des fichiers dans le r√©pertoire personnel de l&#8217;utilisateur. Si vous le configurez pour t√©l√©charger la blockchain compl√®te de Bitcoin, ces fichiers prendront plusieurs centaines de gigaoctets. Ici, nous supposons que vous avez connect√© le lecteur externe et qu&#8217;il se trouve sur le chemin <em>/external_drive/</em> du syst√®me d&#8217;exploitation.</p>
</div>
<div class="paragraph data-line-296">
<p>Sur la plupart des syst√®mes Linux, vous pouvez cr√©er un nouvel utilisateur avec la commande useradd, comme ceci¬†:</p>
</div>
<div class="listingblock data-line-298">
<div class="content">
<pre>$ sudo useradd -m -d /external_drive/bitcoin -s /dev/null bitcoin</pre>
</div>
</div>
<div class="paragraph data-line-302">
<p>Les options m et d cr√©ent le r√©pertoire personnel de l&#8217;utilisateur comme sp√©cifi√© par <em>/external_drive/bitcoin</em> dans ce cas. L&#8217;option s assigne le shell interactif de l&#8217;utilisateur. Dans ce cas, nous le d√©finissons sur <em>/dev/null</em> pour d√©sactiver l&#8217;utilisation du shell interactif. Le dernier argument est le nom d&#8217;utilisateur bitcoin du nouvel utilisateur.</p>
</div>
</div>
<div class="sect3 data-line-304">
<h4 id="_d√©marrage_du_n≈ìud">D√©marrage du n≈ìud</h4>
<div class="paragraph data-line-306">
<p>Pour les services de n≈ìud Bitcoin et Lightning, "l&#8217;installation" implique √©galement la cr√©ation d&#8217;un <em>script de d√©marrage</em> pour s&#8217;assurer que le n≈ìud d√©marre lors du d√©marrage de l&#8217;ordinateur. Le d√©marrage et l&#8217;arr√™t des services en arri√®re-plan sont g√©r√©s par un processus du syst√®me d&#8217;exploitation, qui sous Linux est appel√© init ou systemd. Vous pouvez g√©n√©ralement trouver un script de d√©marrage syst√®me dans le sous-r√©pertoire contrib de chaque projet. Par exemple, si vous utilisez un syst√®me d&#8217;exploitation Linux moderne qui utilise + systemd +, vous trouverez un script appel√© <em>bitcoind.service</em> qui peut d√©marrer et arr√™ter le service de n≈ìud Bitcoin Core.</p>
</div>
<div class="paragraph data-line-308">
<p>Voici un exemple de ce √† quoi ressemble le script de d√©marrage d&#8217;un n≈ìud Bitcoin, tir√© du d√©p√¥t de code Bitcoin Core¬†:</p>
</div>
<div class="listingblock data-line-311">
<div class="title">Depuis bitcoin/contrib/init/bitcoind.service</div>
<div class="content">
<pre>[Unit]
Description=Bitcoin daemon
After=network.target

[Service]
ExecStart=/usr/bin/bitcoind -daemon \
                            -pid=/run/bitcoind/bitcoind.pid \
                            -conf=/etc/bitcoin/bitcoin.conf \
                            -datadir=/var/lib/bitcoind

# Make sure the config directory is readable by the service user
PermissionsStartOnly=true
ExecStartPre=/bin/chgrp bitcoin /etc/bitcoin

# Process management
####################

Type=forking
PIDFile=/run/bitcoind/bitcoind.pid
Restart=on-failure
TimeoutStopSec=600

# Directory creation and permissions
####################################

# Run as bitcoin:bitcoin
User=bitcoin
Group=bitcoin

# /run/bitcoind
RuntimeDirectory=bitcoind
RuntimeDirectoryMode=0710

# /etc/bitcoin
ConfigurationDirectory=bitcoin
ConfigurationDirectoryMode=0710

# /var/lib/bitcoind
StateDirectory=bitcoind
StateDirectoryMode=0710

[...]

[Install]
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="paragraph data-line-359">
<p>En tant qu&#8217;utilisateur root, installez le script en le copiant dans le dossier de service systemd <em>/lib/systemd/system/</em> puis rechargez systemd¬†:</p>
</div>
<div class="listingblock data-line-361">
<div class="content">
<pre>$ sudo systemctl daemon-reload</pre>
</div>
</div>
<div class="paragraph pagebreak-before data-line-366">
<p>Ensuite, activez le service¬†:</p>
</div>
<div class="listingblock data-line-368">
<div class="content">
<pre>$ sudo systemctl enable bitcoind</pre>
</div>
</div>
<div class="paragraph data-line-372">
<p>Vous pouvez maintenant d√©marrer et arr√™ter le service. Ne le d√©marrez pas encore, car nous n&#8217;avons pas configur√© le n≈ìud Bitcoin.</p>
</div>
<div class="listingblock data-line-374">
<div class="content">
<pre>$ sudo systemctl start bitcoind
$ sudo systemctl stop bitcoind</pre>
</div>
</div>
</div>
<div class="sect3 data-line-379">
<h4 id="_configuration_du_n≈ìud">Configuration du n≈ìud</h4>
<div class="paragraph data-line-381">
<p>Pour configurer votre n≈ìud, vous devez cr√©er et r√©f√©rencer un fichier de configuration. Par convention, ce fichier est g√©n√©ralement cr√©√© dans <em>/etc</em>, sous un r√©pertoire portant le nom du programme. Par exemple, les configurations Bitcoin Core et LND seraient g√©n√©ralement stock√©es dans <em>/etc/bitcoin/bitcoin.conf</em> et
<em>/etc/lnd/lnd.conf</em>, respectivement.</p>
</div>
<div class="paragraph data-line-384">
<p>Ces fichiers de configuration sont des fichiers texte dont chaque ligne exprime une option de configuration et sa valeur. Les valeurs par d√©faut sont suppos√©es pour tout ce qui n&#8217;est pas d√©fini dans le fichier de configuration. Vous pouvez voir quelles options peuvent √™tre d√©finies dans la configuration de deux mani√®res. Tout d&#8217;abord, l&#8217;ex√©cution de l&#8217;application de n≈ìud avec un argument help affichera les options qui peuvent √™tre d√©finies sur la ligne de commande. Ces m√™mes options peuvent √™tre d√©finies dans le fichier de configuration. Deuxi√®mement, vous pouvez g√©n√©ralement trouver un exemple de fichier de configuration, avec toutes les options par d√©faut, dans le d√©p√¥t de code du logiciel.</p>
</div>
<div class="paragraph data-line-386">
<p>Vous pouvez trouver un exemple de fichier de configuration dans chacune des images Docker que nous avons utilis√©es dans <a href="#set_up_a_lightning_node">[set_up_a_lightning_node]</a>. Par exemple, le fichier <em>code/docker/bitcoind/bitcoind/bitcoin.conf</em>¬†:</p>
</div>
<div class="listingblock data-line-389">
<div class="title">Fichier de configuration pour le conteneur Docker bitcoind (code/docker/bitcoind/bitcoind/bitcoin.conf)</div>
<div class="content">
<pre>Unresolved directive in &lt;stdin&gt; - include::code/docker/bitcoind/bitcoind/bitcoin.conf[]</pre>
</div>
</div>
<div class="paragraph data-line-393">
<p>Ce fichier de configuration particulier configure Bitcoin Core pour un fonctionnement en tant que n≈ìud regtest et fournit un nom d&#8217;utilisateur et un mot de passe peu s√©curis√© pour l&#8217;acc√®s √† distance, vous ne devez donc pas l&#8217;utiliser pour la configuration de votre n≈ìud. Cependant, il sert √† illustrer la syntaxe d&#8217;un fichier de configuration et vous pouvez y apporter des ajustements dans le conteneur Docker pour exp√©rimenter diff√©rentes options. Voyez si vous pouvez utiliser la commande bitcoind -help pour comprendre ce que fait chacune des options dans le contexte du r√©seau Docker que nous avons construit dans <a href="#set_up_a_lightning_node">[set_up_a_lightning_node]</a>.</p>
</div>
<div class="paragraph data-line-395">
<p>Souvent, les valeurs par d√©faut suffisent et, avec quelques modifications, votre logiciel de n≈ìud peut √™tre configur√© rapidement. Pour faire fonctionner un n≈ìud Bitcoin Core avec une personnalisation minimale, vous n&#8217;avez besoin que de quatre lignes de configuration¬†:</p>
</div>
<div class="listingblock data-line-398">
<div class="content">
<pre class="highlight"><code>server=1
daemon=1
txindex=1
rpcuser=<em>USERNAME</em>
rpcpassword=<em>PASSWORD</em></code></pre>
</div>
</div>
<div class="paragraph data-line-406">
<p>M√™me l&#8217;option txindex n&#8217;est pas strictement n√©cessaire, m√™me si elle garantira que votre n≈ìud Bitcoin cr√©e un index de toutes les transactions, ce qui est requis pour certaines applications. L&#8217;option txindex n&#8217;est pas requise pour ex√©cuter un n≈ìud Lightning.</p>
</div>
<div class="paragraph data-line-408">
<p>Un n≈ìud Lightning <code>c-lightning</code> s&#8217;ex√©cutant sur le m√™me serveur ne n√©cessite √©galement que quelques lignes dans la configuration¬†:</p>
</div>
<div class="listingblock data-line-411">
<div class="content">
<pre class="highlight"><code>network=mainnet
bitcoin-rpcuser=<em>USERNAME</em>
bitcoin-rpcpassword=<em>PASSWORD</em></code></pre>
</div>
</div>
<div class="paragraph data-line-417">
<p>En g√©n√©ral, c&#8217;est une bonne id√©e de minimiser le degr√© de personnalisation de ces syst√®mes. La configuration par d√©faut est soigneusement con√ßue pour prendre en charge les d√©ploiements les plus courants. Si vous modifiez une valeur par d√©faut, cela peut entra√Æner des probl√®mes ult√©rieurement ou r√©duire les performances de votre n≈ìud. Bref, ne modifiez que lorsque c&#8217;est n√©cessaire !</p>
</div>
</div>
<div class="sect3 data-line-419">
<h4 id="_configuration_r√©seau">Configuration r√©seau</h4>
<div class="paragraph data-line-421">
<p> La configuration du r√©seau n&#8217;est normalement pas un probl√®me lors de la configuration d&#8217;une nouvelle application. Cependant, les r√©seaux pair-√†-pair comme Bitcoin et le Lightning Network pr√©sentent des d√©fis uniques pour la configuration du r√©seau.</p>
</div>
<div class="paragraph data-line-423">
<p>Dans un service centralis√©, votre ordinateur se connecte aux "gros serveurs" d&#8217;une entreprise, et non l&#8217;inverse. Votre connexion Internet √† domicile est en fait configur√©e sur l&#8217;hypoth√®se que vous √™tes simplement un consommateur de services fournis par d&#8217;autres. Mais dans un syst√®me pair-√†-pair, chaque pair consomme et fournit des services √† d&#8217;autres n≈ìuds. Si vous utilisez un n≈ìud Bitcoin ou Lightning chez vous, vous fournissez un service √† d&#8217;autres ordinateurs sur Internet. Votre service Internet par d√©faut n&#8217;est pas configur√© pour vous permettre d&#8217;ex√©cuter des serveurs et peut n√©cessiter une configuration suppl√©mentaire pour permettre √† d&#8217;autres d&#8217;acc√©der √† votre n≈ìud.</p>
</div>
<div class="paragraph data-line-425">
<p>Si vous souhaitez ex√©cuter un n≈ìud Bitcoin ou Lightning, vous devez permettre √† d&#8217;autres n≈ìuds sur Internet de se connecter √† vous. Cela signifie activer les connexions TCP entrantes vers le port Bitcoin (port 8333 par d√©faut) ou le port Lightning (port 9735 par d√©faut). Bien que vous puissiez ex√©cuter un n≈ìud Bitcoin sans connectivit√© entrante, vous ne pouvez pas le faire avec un n≈ìud Lightning. Un n≈ìud Lightning doit √™tre accessible aux autres depuis l&#8217;ext√©rieur de votre r√©seau.</p>
</div>
<div class="paragraph data-line-427">
<p>Par d√©faut, votre routeur Internet domestique n&#8217;attend pas de connexions entrantes de l&#8217;ext√©rieur et, en fait, les connexions entrantes sont bloqu√©es. L&#8217;adresse IP de votre routeur Internet est la seule adresse IP accessible de l&#8217;ext√©rieur, et tous les ordinateurs que vous utilisez √† l&#8217;int√©rieur de votre r√©seau domestique partagent cette adresse IP unique. Ceci est r√©alis√© par un m√©canisme appel√© <em>Network Address Translation</em> (<em>NAT</em>), qui permet √† votre routeur Internet d&#8217;agir comme interm√©diaire pour toutes les connexions sortantes. Si vous souhaitez autoriser une connexion entrante, vous devez configurer <em>redirection de port</em> ("port forwarding" en anglais), qui indique √† votre routeur Internet que les connexions entrantes sur des ports sp√©cifiques doivent √™tre transf√©r√©es vers des ordinateurs sp√©cifiques √† l&#8217;int√©rieur du r√©seau. Vous pouvez le faire manuellement en modifiant la configuration de votre routeur Internet ou, si votre routeur le prend en charge, via un m√©canisme de transfert de port automatique appel√© <em>Universal Plug and Play</em> (<em>UPnP</em>).</p>
</div>
<div class="paragraph data-line-429">
<p>Un m√©canisme alternatif √† la redirection de port consiste √† activer The Onion Router (Tor), qui fournit une sorte de superposition de r√©seau priv√© virtuel qui permet les connexions entrantes vers une <em>adresse "onion"</em>. Si vous ex√©cutez Tor, vous n&#8217;avez pas besoin de faire de transfert de port ou d&#8217;activer les connexions entrantes vers les ports Bitcoin ou Lightning. Si vous ex√©cutez vos n≈ìuds √† l&#8217;aide de Tor, tout le trafic passe par Tor et aucun autre port n&#8217;est utilis√©.</p>
</div>
<div class="paragraph data-line-431">
<p>Examinons diff√©rentes mani√®res de permettre √† d&#8217;autres de se connecter √† votre n≈ìud. Nous examinerons ces alternatives dans l&#8217;ordre, du plus simple au plus difficile.</p>
</div>
<div class="sect4 data-line-433">
<h5 id="_√ßa_marche">√áa marche !</h5>
<div class="paragraph data-line-435">
<p>Il est possible que votre fournisseur de services Internet ou votre routeur soit configur√© pour prendre en charge UPnP par d√©faut et que tout fonctionne automatiquement. Essayons d&#8217;abord cette approche, juste au cas o√π nous aurions de la chance.</p>
</div>
<div class="paragraph data-line-437">
<p>En supposant que vous ayez d√©j√† un n≈ìud Bitcoin ou Lightning en cours d&#8217;ex√©cution, nous essaierons de voir s&#8217;ils sont accessibles de l&#8217;ext√©rieur.</p>
</div>
<div class="admonitionblock note data-line-440">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-441">
<p>Pour que ce test fonctionne, vous devez avoir un n≈ìud Bitcoin ou Lightning (ou les deux) op√©rationnel sur votre r√©seau domestique. Si votre routeur prend en charge UPnP, le trafic entrant sera automatiquement transf√©r√© vers les ports correspondants sur l&#8217;ordinateur ex√©cutant le n≈ìud.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-444">
<p>Vous pouvez utiliser certains sites Web tr√®s populaires et utiles pour savoir quelle est votre adresse IP externe et si elle autorise et transmet les connexions entrantes vers un port connu. En voici deux qui sont fiables :</p>
</div>
<div class="ulist data-line-446">
<ul>
<li class="data-line-446">
<p><a href="https://canyouseeme.org" class="undefined" data-href="https://canyouseeme.org">https://canyouseeme.org</a></p>
</li>
<li class="data-line-447">
<p><a href="https://www.whatismyip.com/port-scanner" class="undefined" data-href="https://www.whatismyip.com/port-scanner">https://www.whatismyip.com/port-scanner</a></p>
</li>
</ul>
</div>
<div class="paragraph data-line-449">
<p>Par d√©faut, ces services vous permettent uniquement de v√©rifier les connexions entrantes √† l&#8217;adresse IP √† partir de laquelle vous vous connectez. Ceci est fait pour vous emp√™cher d&#8217;utiliser le service pour analyser les r√©seaux et les ordinateurs d&#8217;autres personnes. Vous verrez l&#8217;adresse IP externe de votre routeur et un champ pour entrer un num√©ro de port. Si vous n&#8217;avez pas modifi√© les ports par d√©faut dans la configuration de votre n≈ìud, essayez le port 8333 (Bitcoin) et/ou 9735 (Lightning).</p>
</div>
<div class="paragraph data-line-451">
<p>Sur <a href="#ln_port_check">V√©rification du port entrant 9735</a> vous pouvez voir le r√©sultat de la v√©rification du port 9735 sur un serveur ex√©cutant Lightning, √† l&#8217;aide de l&#8217;outil d&#8217;analyse de port <em>whatismyip.com</em>. Cela montre que le serveur accepte les connexions entrantes sur le port Lightning. Si vous voyez un r√©sultat comme celui-ci, vous √™tes pr√™t¬†!</p>
</div>
<div id="ln_port_check" class="imageblock data-line-455">
<div class="content">
<img src="images/mtln_0503.png" alt="mtln 0503">
</div>
<div class="title">Figure 3. V√©rification du port entrant 9735</div>
</div>
</div>
<div class="sect4 data-line-457">
<h5 id="_redirection_de_port_automatique_en_utilisant_upnp">Redirection de port automatique en utilisant UPnP</h5>
<div class="paragraph data-line-459">
<p>Parfois, m√™me si votre routeur Internet prend en charge l&#8217;UPnP, il se peut qu&#8217;il soit d√©sactiv√© par d√©faut. Dans ce cas, vous devez modifier la configuration de votre routeur Internet depuis son interface d&#8217;administration Web¬†:</p>
</div>
<div class="olist arabic data-line-461">
<ol class="arabic">
<li class="data-line-461">
<p>Connectez-vous au site Web de configuration de votre routeur Internet. Cela peut g√©n√©ralement √™tre fait en se connectant √† <em>l&#8217;adresse de passerelle</em> ("gateway address" en anglais) de votre r√©seau domestique √† l&#8217;aide d&#8217;un navigateur Web. Vous pouvez trouver l&#8217;adresse de la passerelle en consultant la configuration IP de n&#8217;importe quel ordinateur de votre r√©seau domestique. Il s&#8217;agit souvent de la premi√®re adresse dans l&#8217;un des r√©seaux non routables, comme 192.168.0.1 ou 10.0.0.1. V√©rifiez √©galement tous les autocollants sur votre routeur pour <em>l&#8217;adresse de la passerelle</em>. Une fois trouv√©e, ouvrez un navigateur et saisissez l&#8217;adresse IP dans la zone URL/Recherche du navigateur, par exemple, "192.168.0.1" ou "http://192.168.0.1".</p>
</li>
<li class="data-line-463">
<p>Recherchez le nom d&#8217;utilisateur et le mot de passe de l&#8217;administrateur pour le panneau de configuration Web du routeur. Ceci est souvent √©crit sur un autocollant sur le routeur lui-m√™me et peut √™tre aussi simple que "admin" et "password". Une recherche rapide sur le Web pour votre FAI et votre mod√®le de routeur peut √©galement vous aider √† trouver ces informations.</p>
</li>
<li class="data-line-465">
<p>Trouvez un param√®tre pour UPnP et activez-le.</p>
</li>
</ol>
</div>
<div class="paragraph data-line-467">
<p>Red√©marrez votre n≈ìud Bitcoin et/ou Lightning et r√©p√©tez le test de port ouvert avec l&#8217;un des sites Web que nous avons utilis√©s dans la section pr√©c√©dente.</p>
</div>
</div>
<div class="sect4 data-line-469">
<h5 id="_utilisation_de_tor_pour_les_connexions_entrantes">Utilisation de Tor pour les connexions entrantes</h5>
<div class="paragraph data-line-471">
<p><em>The Onion Router</em> (<em>Tor</em> ) est un VPN avec la propri√©t√© sp√©ciale qu&#8217;il crypte les communications entre les sauts, de sorte qu&#8217;aucun n≈ìud interm√©diaire ne peut d√©terminer l&#8217;origine ou la destination d&#8217;un paquet. Les n≈ìuds Bitcoin et Lightning prennent en charge le fonctionnement sur Tor, ce qui vous permet d&#8217;exploiter un n≈ìud sans r√©v√©ler votre adresse IP ou votre emplacement. Par cons√©quent, il offre un haut niveau de confidentialit√© √† votre trafic r√©seau. Un avantage suppl√©mentaire de l&#8217;ex√©cution de Tor est que, comme il fonctionne comme un VPN, il r√©sout le probl√®me de redirection de port depuis votre routeur Internet. Les connexions entrantes sont re√ßues via le tunnel Tor et votre n≈ìud peut √™tre trouv√© via une <em>adresse "onion"</em> g√©n√©r√©e ad hoc au lieu d&#8217;une adresse IP.</p>
</div>
<div class="paragraph data-line-473">
<p>L&#8217;activation de Tor n√©cessite deux √©tapes. Tout d&#8217;abord, vous devez installer le routeur Tor et le proxy sur votre ordinateur. Deuxi√®mement, vous devez activer l&#8217;utilisation du proxy Tor dans votre configuration Bitcoin ou Lightning.</p>
</div>
<div class="paragraph data-line-475">
<p>Pour installer Tor sur un syst√®me Ubuntu Linux qui utilise le gestionnaire de paquets apt, ex√©cutez :</p>
</div>
<div class="listingblock data-line-477">
<div class="content">
<pre>sudo apt install tor</pre>
</div>
</div>
<div class="paragraph data-line-481">
<p>Ensuite, nous configurons notre n≈ìud Lightning pour utiliser Tor pour sa connectivit√© externe. Voici un exemple de configuration pour LND¬†:</p>
</div>
<div class="listingblock data-line-483">
<div class="content">
<pre>[Tor]
tor.active=true
tor.v3=true
tor.streamisolation=true
listen=localhost</pre>
</div>
</div>
<div class="paragraph data-line-491">
<p>Cela activera Tor (tor.active), √©tablira un service onion v3 (tor.v3=true), utilisera un flux onion diff√©rent pour chaque connexion (tor.streamisolation) et limitera l&#8217;√©coute des connexions √† l&#8217;h√¥te local uniquement, pour √©viter de divulguer votre adresse IP (<code>l&#x2060;i&#x2060;s&#x2060;t&#x2060;e&#x2060;n&#x200b;=&#x2060;l&#x2060;o&#x2060;c&#x2060;a&#x2060;l&#x2060;h&#x2060;o&#x2060;s&#x2060;t</code>).</p>
</div>
<div class="paragraph data-line-493">
<p>Vous pouvez v√©rifier si Tor est correctement install√© et fonctionne en ex√©cutant une simple commande d&#8217;une ligne. Cette commande devrait fonctionner sur la plupart des versions de Linux¬†:</p>
</div>
<div class="listingblock data-line-495">
<div class="content">
<pre>curl --socks5 localhost:9050 --socks5-hostname localhost:9050 -s https://check.torproject.org/ | cat | grep -m 1 Congratulations | xargs</pre>
</div>
</div>
<div class="paragraph data-line-499">
<p>Si tout fonctionne correctement, la r√©ponse de cette commande devrait √™tre "Congratulations. This browser is configured to use Tor" (traduit en "F√©licitations votre navigateur est configur√© pour utiliser Tor").</p>
</div>
<div class="paragraph data-line-501">
<p>En raison de la nature de Tor, vous ne pouvez pas facilement utiliser un service externe pour v√©rifier si votre n≈ìud est accessible via une adresse "onion". N√©anmoins, vous devriez voir votre adresse "onion" de Tor dans les journaux de votre n≈ìud Lightning. C&#8217;est une longue cha√Æne de lettres et de chiffres suivie du suffixe .onion. Votre n≈ìud devrait maintenant √™tre accessible depuis Internet, avec en prime la confidentialit√© !</p>
</div>
</div>
<div class="sect4 data-line-503">
<h5 id="_redirection_de_port_manuelle">Redirection de port manuelle</h5>
<div class="paragraph data-line-505">
<p>C&#8217;est le processus le plus complexe et n√©cessite pas mal de comp√©tences techniques. Les d√©tails d√©pendent du type de routeur Internet dont vous disposez, des param√®tres et des politiques de votre fournisseur de services et de nombreux autres contextes. Essayez d&#8217;abord UPnP ou Tor, avant d&#8217;essayer ce m√©canisme beaucoup plus difficile.</p>
</div>
<div class="paragraph data-line-507">
<p>Les √©tapes de base sont les suivantes :</p>
</div>
<div class="olist arabic data-line-509">
<ol class="arabic">
<li class="data-line-509">
<p>Trouvez l&#8217;adresse IP de l&#8217;ordinateur sur lequel se trouve votre n≈ìud. Ceci est g√©n√©ralement allou√© dynamiquement par le protocole DHCP (Dynamic Host Configuration Protocol) et se situe souvent quelque part dans la plage 192.168.x.x ou 10.x.x.x.</p>
</li>
<li class="data-line-511">
<p>Recherchez l&#8217;adresse MAC (Media Access Control) de l&#8217;interface r√©seau de votre n≈ìud. Cela peut √™tre trouv√© dans les param√®tres Internet de cet ordinateur.</p>
</li>
<li class="data-line-513">
<p>Attribuez une adresse IP statique √† votre n≈ìud afin qu&#8217;elle soit toujours la m√™me. Vous pouvez utiliser l&#8217;adresse IP dont il dispose actuellement. Sur votre routeur Internet, recherchez "Baux statiques" ("Static Leases" en anglais) sous la configuration DHCP. Associez l&#8217;adresse MAC √† l&#8217;adresse IP que vous avez s√©lectionn√©e. D√©sormais, cette adresse IP sera toujours attribu√©e √† votre n≈ìud. Vous pouvez √©galement consulter la configuration DHCP de votre routeur et d√©couvrir quelle est sa plage d&#8217;adresses DHCP. S√©lectionnez une adresse inutilis√©e <em>hors</em> de la plage d&#8217;adresses DHCP. Ensuite, sur le serveur, configurez le r√©seau pour qu&#8217;il cesse d&#8217;utiliser DHCP et codez en dur l&#8217;adresse IP non-DHCP s√©lectionn√©e dans la configuration r√©seau du syst√®me d&#8217;exploitation.</p>
</li>
<li class="data-line-515">
<p>Enfin, installer une "Redirection de ports" ("Port Forwarding" en anglais) sur votre routeur Internet pour acheminer le trafic entrant sur des ports sp√©cifiques vers l&#8217;adresse IP s√©lectionn√©e de votre serveur.</p>
</li>
</ol>
</div>
<div class="paragraph data-line-517">
<p>Une fois la reconfiguration termin√©e, r√©p√©tez la v√©rification du port en utilisant l&#8217;un des sites Web des sections pr√©c√©dentes .</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-519">
<h3 id="_s√©curit√©_de_votre_n≈ìud">S√©curit√© de votre n≈ìud</h3>
<div class="paragraph data-line-521">
<p>Un n≈ìud Lightning est, par d√©finition, un <em>porte-monnaie chaud</em> ("hot wallet" en anglais). Cela signifie que les fonds (√† la fois sur la cha√Æne et hors cha√Æne) contr√¥l√©s par un n≈ìud Lightning sont directement contr√¥l√©s par des cl√©s qui sont charg√©es dans la m√©moire du n≈ìud ou stock√©es sur le disque dur du n≈ìud. Si un n≈ìud Lightning est compromis, il est trivial de cr√©er des transactions sur la cha√Æne ou hors cha√Æne pour drainer ses fonds. Il est donc extr√™mement important que vous le prot√©giez contre tout acc√®s non autoris√©.</p>
</div>
<div class="paragraph data-line-523">
<p>La s√©curit√© est un effort holistique, ce qui signifie que vous devez s√©curiser chaque couche d&#8217;un syst√®me. Comme le dit l&#8217;adage : la cha√Æne est aussi solide que son maillon le plus faible. Il s&#8217;agit d&#8217;un concept important dans la s√©curit√© informatique et nous l&#8217;appliquerons √† notre n≈ìud.</p>
</div>
<div class="paragraph data-line-525">
<p>Malgr√© toutes les mesures de s√©curit√© que vous prendrez, rappelez-vous que le Lightning Network est une technologie exp√©rimentale √† un stade pr√©coce et qu&#8217;il est probable qu&#8217;il y ait des bogues exploitables dans le code de tout projet que vous utilisez. <em>Ne mettez pas plus d&#8217;argent que vous n&#8217;√™tes pr√™t √† risquer de perdre sur le Lightning Network.</em></p>
</div>
<div class="sect3 data-line-528">
<h4 id="_s√©curit√©_du_syst√®me_dexploitation">S√©curit√© du syst√®me d&#8217;exploitation</h4>
<div class="paragraph data-line-530">
<p>La s√©curisation d&#8217;un syst√®me d&#8217;exploitation est un vaste sujet qui d√©passe le cadre de ce livre. Cependant, nous pouvons √©tablir quelques principes de base.</p>
</div>
<div class="paragraph data-line-532">
<p>Pour s√©curiser votre syst√®me d&#8217;exploitation, voici quelques-uns des principaux √©l√©ments √† prendre en compte¬†:</p>
</div>
<div class="dlist data-line-534">
<dl>
<dt class="hdlist1">Provenance</dt>
<dd>
<p>Commencez par vous assurer que vous t√©l√©chargez la bonne image du syst√®me d&#8217;exploitation et v√©rifiez les signatures ou les sommes de contr√¥le ("checksum" en anglais) avant de l&#8217;installer. √âtendez cela √† tous les logiciels que vous installez. V√©rifiez √† nouveau toute source ou URL √† partir de laquelle vous t√©l√©chargez. V√©rifiez l&#8217;int√©grit√© et l&#8217;exactitude du logiciel t√©l√©charg√© gr√¢ce aux signatures et √† la v√©rification des sommes de contr√¥le.</p>
</dd>
<dt class="hdlist1">Maintenance</dt>
<dd>
<p>Assurez-vous que votre syst√®me d&#8217;exploitation est √† jour. Activez l&#8217;installation quotidienne ou hebdomadaire automatis√©e des mises √† jour de s√©curit√©.</p>
</dd>
<dt class="hdlist1">Moindres privil√®ges</dt>
<dd>
<p>Cr√©ez des utilisateurs sp√©cifiquement  pour les processus et accordez-leur le moins d&#8217;acc√®s possible pour ex√©cuter un service. N&#8217;ex√©cutez pas de processus avec des privil√®ges d&#8217;administrateur (par exemple, root).</p>
</dd>
<dt class="hdlist1">Isolation des processus</dt>
<dd>
<p>Utilisez les fonctionnalit√©s du syst√®me d&#8217;exploitation pour isoler les processus les uns par rapport aux autres.</p>
</dd>
<dt class="hdlist1">Autorisations du syst√®me de fichiers</dt>
<dd>
<p>Configurez le syst√®me de fichiers avec soin, selon le principe des moindres privil√®ges. Ne rendez pas les fichiers lisibles ou inscriptibles par tout le monde.</p>
</dd>
<dt class="hdlist1">Authentification forte</dt>
<dd>
<p>Utilisez des mots de passe forts g√©n√©r√©s al√©atoirement ou, dans la mesure du possible, une authentification par cl√© publique. Par exemple, il est plus s√ªr d&#8217;utiliser Secure Shell (SSH) avec une paire de cl√©s cryptographiques au lieu d&#8217;un mot de passe.</p>
</dd>
<dt class="hdlist1">Authentification √† deux facteurs (2FA)</dt>
<dd>
<p>Utilisez l&#8217;authentification √† deux facteurs dans la mesure du possible, y compris Universal 2nd Factor (U2F) avec des cl√©s de s√©curit√© mat√©rielles. Cela s&#8217;applique √† tous les services externes que vous pourriez utiliser, tels que votre fournisseur de services cloud. Vous pouvez √©galement l&#8217;appliquer √† votre propre configuration, telle que votre propre configuration SSH. Utilisez 2FA √©galement pour les services indirects. Par exemple, supposons que vous utilisez un service cloud. Vous avez donn√© une adresse e-mail √† votre fournisseur de services cloud, vous devez donc √©galement prot√©ger votre adresse e-mail avec 2FA.</p>
</dd>
<dt class="hdlist1">Sauvegarde</dt>
<dd>
<p>Effectuez des sauvegardes de votre syst√®me et assurez-vous √©galement de prot√©ger les sauvegardes avec un cryptage. Effectuez ces sauvegardes p√©riodiquement. Au moins une fois, testez si vous pouvez restaurer votre sauvegarde et si votre sauvegarde est compl√®te et accessible. Si possible, conservez une copie de vos sauvegardes sur un disque diff√©rent pour √©viter qu&#8217;une seule panne de disque dur ne d√©truise <em>√† la fois</em> votre n≈ìud actif ainsi que vos copies de sauvegarde.</p>
</dd>
<dt class="hdlist1">Gestion des vuln√©rabilit√©s et de l&#8217;exposition</dt>
<dd>
<p>Utilisez l&#8217;analyse √† distance pour vous assurer que vous avez minimis√© la surface d&#8217;attaque de votre syst√®me. Fermez tous les services ou ports inutiles. Installez uniquement les logiciels et paquets dont vous avez vraiment besoin et que vous utilisez. D√©sinstallez les paquets que vous n&#8217;utilisez plus. Il est recommand√© de <em>ne pas</em> utiliser votre l&#8217;ordinateur de votre n≈ìud pour des activit√©s non li√©es au n≈ìud que vous pouvez effectuer sur un autre de vos ordinateurs. Surtout, si vous le pouvez, n&#8217;utilisez <em>pas</em> l&#8217;ordinateur de votre n≈ìud pour naviguer, surfer sur Internet ou lire vos e-mails.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-544">
<p>Voici une liste des mesures de s√©curit√© les plus √©l√©mentaires. Elle n&#8217;est en aucun cas exhaustive.</p>
</div>
</div>
<div class="sect3 data-line-546">
<h4 id="_acc√®s_au_n≈ìud">Acc√®s au n≈ìud</h4>
<div class="paragraph data-line-548">
<p>Votre n≈ìud Lightning va exposer une API d&#8217;appel de proc√©dure distante (RPC). Cela signifie que votre n≈ìud peut √™tre contr√¥l√© √† distance par des commandes envoy√©es √† un port TCP sp√©cifique. Le contr√¥le d&#8217;acc√®s √† cette API RPC est r√©alis√© apr√®s une certaine forme d&#8217;authentification de l&#8217;utilisateur. Selon le type de n≈ìud Lightning que vous configurez, cela se fera soit par une authentification <span class="keep-together">nom d'utilisateur/mot de passe</span> ou par un m√©canisme appel√© un <em>macaron</em> d&#8217;authentification ("macaroon" en anglais). Comme son nom l&#8217;indique, un macaron est un type de cookie plus sophistiqu√©. Contrairement √† un cookie, il est sign√© cryptographiquement et peut exprimer un ensemble de <span class="keep-together">capacit√©s</span>.</p>
</div>
<div class="paragraph data-line-550">
<p>Par exemple, LND utilise des macarons pour accorder l&#8217;acc√®s √† l&#8217;API RPC. Par d√©faut, le logiciel LND cr√©e trois macarons avec diff√©rents niveaux d&#8217;acc√®s, appel√©s admin, invoice et readonly. Selon le macaron que vous copiez et utilisez dans votre client RPC, vous disposez soit d&#8217;un acc√®s en <em>lecture seule</em>, d&#8217;un acc√®s <em>facture</em> (qui inclut les capacit√©s de lecture seule) ou d&#8217;un acc√®s <em>admin</em>, qui vous donne un contr√¥le total. Il existe √©galement une fonction macaron + boulangerie + dans LND qui peut construire des macarons avec n&#8217;importe quelle combinaison de capacit√©s permettant un contr√¥le tr√®s fin.</p>
</div>
<div class="paragraph data-line-552">
<p>Si vous utilisez un mod√®le d&#8217;authentification nom d&#8217;utilisateur/mot de passe, assurez-vous de s√©lectionner un mot de passe long et al√©atoire. Vous n&#8217;aurez pas √† taper souvent ce mot de passe, car il sera stock√© dans les fichiers de configuration. Vous devez donc en choisir un qui ne peut pas √™tre devin√©. De nombreux exemples que vous verrez incluent des mots de passe mal choisis, et souvent les gens les copient dans leurs propres syst√®mes, offrant un acc√®s facile √† n&#8217;importe qui. Ne fais pas cela ! Utilisez un gestionnaire de mots de passe pour g√©n√©rer un long mot de passe alphanum√©rique al√©atoire. √âtant donn√© que certains caract√®res sp√©ciaux tels que $?/!*\&amp;%`"' peuvent interf√©rer avec la ligne de commande, il est pr√©f√©rable de les √©viter pour les mots de passe qui seront utilis√©s dans un environnement shell. Pour √©viter les probl√®mes, restez avec de longs mots de passe alphanum√©riques al√©atoires.</p>
</div>
<div class="paragraph data-line-554">
<p>Une s√©quence alphanum√©rique simple de plus de 12 caract√®res et g√©n√©r√©e de mani√®re al√©atoire est g√©n√©ralement suffisante. Si vous pr√©voyez de stocker de grosses sommes d&#8217;argent sur votre n≈ìud Lightning et que vous √™tes pr√©occup√© par les attaques par force brute √† distance, s√©lectionnez un mot de passe de plus de 20 caract√®res pour rendre ces attaques pratiquement impossibles.</p>
</div>
</div>
</div>
<div class="sect2 data-line-556">
<h3 id="_sauvegardes_de_n≈ìuds_et_de_canaux">Sauvegardes de n≈ìuds et de canaux</h3>
<div class="paragraph data-line-558">
<p>Une consid√©ration tr√®s importante lors de l&#8217;ex√©cution d&#8217;un n≈ìud Lightning est la question des sauvegardes. Contrairement √† un porte-monnaie Bitcoin, o√π une phrase mn√©monique BIP-39 peut r√©cup√©rer tout l&#8217;√©tat du porte-monnaie, sur Lightning ce n&#8217;est <em>pas</em> le cas.</p>
</div>
<div class="paragraph data-line-560">
<p>Les porte-monnaie Lightning utilisent une sauvegarde de phrase mn√©monique BIP-39, mais uniquement pour le porte-monnaie sur la cha√Æne. Cependant, en raison de la mani√®re dont les canaux sont construits, la phrase mn√©monique n&#8217;est <em>pas</em> suffisante pour restaurer un n≈ìud Lightning. Une couche suppl√©mentaire de sauvegardes est n√©cessaire, appel√©e <em>sauvegarde de canal statique</em> ("Static Channel Backup" ou <em>"SCB"</em> en anglais). Sans SCB, un op√©rateur de n≈ìud Lightning peut perdre <em>tous</em> les fonds qui se trouvent dans les canaux s&#8217;il perd le magasin de donn√©es du n≈ìud Lightning.</p>
</div>
<div class="admonitionblock warning data-line-563">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-564">
<p>Ne financez <em>pas</em> de canaux tant que vous n&#8217;avez pas mis en place un syst√®me pour sauvegarder en permanence l&#8217;√©tat de vos canaux. Vos sauvegardes doivent √™tre d√©plac√©es "hors site" vers un syst√®me et un emplacement diff√©rents de votre n≈ìud, afin qu&#8217;elles puissent survivre √† diverses pannes du syst√®me (coupure de courant, corruption de donn√©es, etc.) ou √† des catastrophes naturelles (inondation, incendie, etc.).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-567">
<p>Les SCB ne sont pas une panac√©e. Tout d&#8217;abord, l&#8217;√©tat de chaque canal doit √™tre sauvegard√© chaque fois qu&#8217;il y a une nouvelle transaction d&#8217;engagement. Deuxi√®mement, la restauration √† partir d&#8217;une sauvegarde de canal est dangereuse. Si vous n&#8217;avez pas la <em>derni√®re</em> transaction d&#8217;engagement et que vous diffusez accidentellement un ancien engagement (r√©voqu√©), votre pair de canal supposera que vous essayez de tricher et r√©clamera l&#8217;int√©gralit√© du solde du canal avec une transaction de p√©nalit√©. Pour vous assurer que vous fermez le canal, vous devez effectuer une <em>fermeture coop√©rative</em>. Mais un pair malveillant pourrait induire votre n≈ìud en erreur en diffusant un ancien engagement r√©voqu√© lors de cette fermeture coop√©rative, vous trompant ainsi en obligeant votre n≈ìud √† essayer de tricher par inadvertance.</p>
</div>
<div class="paragraph data-line-569">
<p>De plus, les sauvegardes de vos canaux doivent √™tre crypt√©es pour pr√©server votre confidentialit√© et la s√©curit√© de votre canal. Sinon, quiconque trouve les sauvegardes peut non seulement voir tous vos canaux, mais peut √©galement utiliser les sauvegardes pour fermer tous vos canaux de mani√®re √† remettre le solde √† vos pairs. En d&#8217;autres termes, une personne malveillante qui acc√®de √† vos sauvegardes peut vous faire perdre tous les fonds sur vos canaux.</p>
</div>
<div class="paragraph data-line-571">
<p>Vous pouvez voir que les SCB ne sont pas une garantie infaillible. Ils constituent un compromis faible car ils remplacent un type de risque (corruption ou perte de donn√©es) par un autre type de risque (pair malveillant). Pour restaurer √† partir d&#8217;un SCB, vous devez interagir avec vos pairs de canal et esp√©rer qu&#8217;ils n&#8217;essaieront pas de vous tromper en vous fournissant un ancien engagement ou en trompant votre n≈ìud en diffusant un engagement r√©voqu√© afin qu&#8217;ils puissent vous p√©naliser. Malgr√© les faiblesses du SCB, les SCB ont du sens et vous devez les mettre en ≈ìuvre. Si vous n&#8217;utilisez pas les SCB et que vous perdez vos donn√©es de n≈ìud, vous perdrez les fonds de votre canal pour toujours. Garanti¬†! Cependant, si vous utilisez les SCB et que vous perdez vos donn√©es de n≈ìud, vous avez une chance raisonnable que certains de vos pairs soient honn√™tes et que vous puissiez r√©cup√©rer une partie des fonds de votre canal. Si vous √™tes chanceux, vous pourriez r√©cup√©rer tous vos fonds. En conclusion, il est pr√©f√©rable pour d&#8217;utiliser des SCB continus sur un disque autre que le disque dur primaire du n≈ìud.</p>
</div>
<div class="paragraph data-line-573">
<p>Les m√©canismes de sauvegarde des canaux sont toujours en cours de d√©veloppement et constituent une faiblesse dans la plupart des impl√©mentations de Lightning.</p>
</div>
<div class="paragraph data-line-575">
<p>Au moment de la r√©daction de ce livre, seul LND propose un m√©canisme int√©gr√© pour les SCB. Eclair dispose d&#8217;un m√©canisme similaire d√©ploy√© pour les d√©ploiements c√¥t√© serveur, toutefois Eclair Mobile propose une sauvegarde facultative sur Google Drive. <code>c-lightning</code> a r√©cemment fusionn√© les interfaces n√©cessaires √† un plug-in pour impl√©menter des sauvegardes de canaux. Malheureusement, il n&#8217;y a pas de m√©canisme de sauvegarde coh√©rent et convenu entre les diff√©rentes <span class="keep-together">impl√©mentations</span> de n≈ìuds.</p>
</div>
<div class="paragraph data-line-577">
<p>Les sauvegardes bas√©es sur des fichiers des bases de donn√©es du n≈ìud Lightning sont au mieux une solution partielle car vous courez le risque de sauvegarder un √©tat de base de donn√©es incoh√©rent. De plus, vous ne pouvez pas attraper de mani√®re fiable les √©tats d&#8217;engagements les plus r√©cents. Il est bien pr√©f√©rable d&#8217;avoir un m√©canisme de sauvegarde qui se d√©clenche √† chaque changement d&#8217;√©tat d&#8217;un canal, assurant ainsi la coh√©rence des donn√©es.</p>
</div>
<div class="paragraph data-line-579">
<p>Pour configurer des SCB dans LND, d√©finissez le param√®tre backupfilepath sur la ligne de commande ou dans le fichier de configuration. LND enregistrera alors un fichier SCB dans ce chemin de r√©pertoire. Bien s√ªr, ce n&#8217;est que la premi√®re √©tape de la solution. Maintenant, vous devez mettre en place un m√©canisme qui surveille ce fichier pour les modifications. A chaque fois que le fichier change, le m√©canisme <span class="keep-together">de sauvegarde</span> doit copier ce fichier sur un autre disque, de pr√©f√©rence hors site. De tels m√©canismes de sauvegarde sortent du cadre de ce livre. N√©anmoins, toute solution de sauvegarde sophistiqu√©e devrait √™tre capable de g√©rer ce sc√©nario. Rappelez-vous que les fichiers de sauvegarde doivent √©galement √™tre crypt√©s.</p>
</div>
<div class="sect3 data-line-581">
<h4 id="_risque_des_porte_monnaie_chauds">Risque des porte-monnaie chauds</h4>
<div class="paragraph data-line-583">
<p>Comme nous en avons parl√© pr√©c√©demment, le Lightning Network se compose d&#8217;un r√©seau de <em>porte-monnaie chaud</em>. Les fonds que vous stockez dans un porte-monnaie Lightning sont en ligne tout le temps. Cela les rend vuln√©rables. Par cons√©quent, vous ne devez pas stocker de grandes quantit√©s dans un porte-monnaie Lightning. Les montants importants doivent √™tre conserv√©s dans un porte-monnaie <em>froid</em> qui n&#8217;est <em>pas</em> en ligne et qui ne peut effectuer des transactions que sur la cha√Æne.</p>
</div>
<div class="paragraph data-line-585">
<p>M√™me si vous commencez petit, au fil du temps, vous constaterez peut-√™tre que vous avez encore une somme d&#8217;argent importante dans un porte-monnaie Lightning. Il s&#8217;agit d&#8217;un sc√©nario typique pour les propri√©taires de magasins. Si vous utilisez un n≈ìud Lightning pour une op√©ration de commerce √©lectronique, votre porte-monnaie recevra probablement des fonds souvent, mais en enverra rarement. Vous finirez donc par avoir deux probl√®mes simultan√©ment. Premi√®rement, vos canaux seront d√©s√©quilibr√©s, les gros soldes locaux l&#8217;emportant sur les petits soldes distants. Deuxi√®mement, vous aurez trop d&#8217;argent dans le porte-monnaie. Heureusement, vous pouvez aussi r√©soudre ces deux probl√®mes simultan√©ment.</p>
</div>
<div class="paragraph data-line-587">
<p>Examinons quelques-unes des solutions que vous pouvez utiliser pour r√©duire les fonds expos√©s dans un porte-monnaie chaud.</p>
</div>
</div>
<div class="sect3 data-line-589">
<h4 id="_balayage_de_fonds_sweeping_en_anglais">Balayage de fonds ("sweeping" en anglais)</h4>
<div class="paragraph data-line-591">
<p>Si le solde de votre porte-monnaie Lightning devient trop important pour votre tol√©rance de risques, vous devrez "balayer" des fonds hors du porte-monnaie. Vous pouvez le faire de trois mani√®res : sur la cha√Æne, hors cha√Æne et Loop Out. Examinons chacune de ces options dans les prochaines sections.</p>
</div>
<div class="sect4 data-line-593">
<h5 id="_balayage_sur_la_cha√Æne">Balayage sur la cha√Æne</h5>
<div class="paragraph data-line-595">
<p>Le balayage ("sweeping" en anglais) de fonds sur la cha√Æne est accompli en d√©pla√ßant les fonds du porte-monnaie Lightning vers un porte-monnaie Bitcoin. Vous faites cela en fermant des canaux. Lorsque vous fermez un canal, tous les fonds de votre solde local sont "balay√©s" vers une adresse Bitcoin. L&#8217;adresse Bitcoin pour les fonds sur la cha√Æne est g√©n√©ralement g√©n√©r√©e par votre porte-monnaie Lightning, il s&#8217;agit donc toujours d&#8217;un porte-monnaie chaud. Vous devrez peut-√™tre effectuer une transaction suppl√©mentaire sur la cha√Æne pour d√©placer les fonds vers une adresse plus s√©curis√©e, telle que celle g√©n√©r√©e sur votre porte-monnaie mat√©riel.</p>
</div>
<div class="paragraph data-line-597">
<p>La fermeture des canaux entra√Ænera des frais de cha√Æne et r√©duira la capacit√© et la connectivit√© de votre n≈ìud Lightning. Cependant, si vous exploitez un n≈ìud de commerce √©lectronique populaire, vous ne manquerez pas de capacit√© entrante et pourrez fermer strat√©giquement des canaux avec des soldes locaux importants, en "regroupant" essentiellement vos fonds pour les mouvements sur la cha√Æne. Vous devrez peut-√™tre utiliser certaines techniques de r√©√©quilibrage des canaux (voir <a href="#channel_rebalancing">R√©√©quilibrage de canaux</a>) avant de fermer des canaux pour maximiser les avantages de cette strat√©gie.</p>
</div>
</div>
<div class="sect4 data-line-599">
<h5 id="_balayage_hors_cha√Æne">Balayage hors cha√Æne</h5>
<div class="paragraph data-line-601">
<p>Une autre technique que vous pouvez utiliser consiste √† ex√©cuter un deuxi√®me n≈ìud Lightning qui n&#8217;est pas annonc√© sur le r√©seau. Vous pouvez √©tablir des canaux de grande capacit√© √† partir de votre n≈ìud public (par exemple, celui qui g√®re votre boutique) vers votre n≈ìud non annonc√© (cach√©). R√©guli√®rement, "balayez" des fonds en effectuant un paiement Lightning sur votre n≈ìud cach√©.</p>
</div>
<div class="paragraph data-line-603">
<p>L&#8217;avantage de cette technique r√©side dans le fait que le n≈ìud Lightning qui re√ßoit les paiements pour votre boutique sera connu publiquement. Cela en fait une cible pour les pirates, car tout n≈ìud Lightning associ√© √† une boutique serait suppos√© avoir un solde important. Un deuxi√®me n≈ìud qui n&#8217;est pas associ√© √† votre boutique ne sera pas facilement identifi√© comme une cible valable.</p>
</div>
<div class="paragraph data-line-605">
<p>Comme mesure de s√©curit√© suppl√©mentaire, vous pouvez faire de votre deuxi√®me n≈ìud un service Tor cach√© afin que son adresse IP ne soit pas connue. Cela r√©duit encore les risques d&#8217;attaques et augmente votre confidentialit√©.</p>
</div>
<div class="paragraph data-line-607">
<p>Vous devrez configurer un script qui s&#8217;ex√©cute √† intervalles r√©guliers. Le but de ce script est de cr√©er une facture sur votre n≈ìud cach√© et de payer cette facture depuis le n≈ìud de votre boutique, transf√©rant ainsi des fonds vers votre n≈ìud cach√©.</p>
</div>
<div class="paragraph data-line-609">
<p>Gardez √† l&#8217;esprit que cette technique ne d√©place pas les fonds dans un cold storage. Les deux n≈ìuds Lightning sont des porte-monnaie chauds. L&#8217;objectif de ce balayage est de d√©placer des fonds d&#8217;un porte-monnaie chaud tr√®s connu vers un porte-monnaie chaud obscur.</p>
</div>
</div>
<div class="sect4 data-line-611">
<h5 id="_balayage_par_√©change_sous_marin">Balayage par √©change sous-marin</h5>
<div class="paragraph data-line-613">
<p>Une autre fa√ßon de r√©duire le solde de votre porte-monnaie chaud Lightning consiste √† utiliser une technique appel√©e <em>√©change sous-marin</em> ("submarine swaps" en anglais). Les √©changes sous-marins, conceptualis√©s par le co-auteur Olaoluwa Osuntokun et Alex Bosworth, permettent l&#8217;√©change de bitcoins sur la cha√Æne contre des paiements Lightning et vice versa. Essentiellement, les √©changes sous-marins sont des √©changes atomiques entre les fonds hors cha√Æne Lightning et les fonds sur la cha√Æne Bitcoin.</p>
</div>
<div class="paragraph data-line-615">
<p>Un op√©rateur de n≈ìud peut initier un √©change sous-marin et envoyer tous les soldes de canaux disponibles √† l&#8217;autre partie, qui leur enverra des bitcoins sur la cha√Æne en √©change.</p>
</div>
<div class="paragraph data-line-617">
<p>√Ä l&#8217;avenir, il pourrait s&#8217;agir d&#8217;un service payant propos√© par les n≈ìuds du Lightning Network qui annoncent des taux de change ou facturent des frais fixes pour la conversion.</p>
</div>
<div class="paragraph data-line-619">
<p>L&#8217;avantage d&#8217;un √©change sous-marin pour balayer des fonds est qu&#8217;aucun canal n&#8217;a besoin d&#8217;√™tre ferm√©. Cela signifie que nous pr√©servons nos canaux, ne r√©√©quilibrant nos canaux qu&#8217;√† travers cette op√©ration. Lorsque nous envoyons un paiement Lightning, nous transf√©rons une partie du solde depuis le local vers le distant sur un ou plusieurs de nos canaux. Non seulement cela r√©duit le solde expos√© dans le porte-monnaie actif de notre n≈ìud, mais cela augmente √©galement le solde disponible pour les futurs paiements entrants.</p>
</div>
<div class="paragraph data-line-621">
<p>Vous pouvez le faire en confiant √† un interm√©diaire le r√¥le de passerelle, mais cela risque de vous faire voler vos pi√®ces. Cependant, dans le cas d&#8217;un √©change sous-marin, l&#8217;op√©ration ne n√©cessite pas de confiance. Les √©changes sous-marins sont des op√©rations <em>atomiques</em> non d√©positaires. Cela signifie que la contrepartie de votre √©change sous-marin ne peut pas voler vos fonds car le paiement sur la cha√Æne d√©pend de l&#8217;ach√®vement du paiement hors cha√Æne et vice versa.</p>
</div>
</div>
<div class="sect4 data-line-623">
<h5 id="_√©changes_sous_marins_avec_loop">√âchanges sous-marins avec Loop</h5>
<div class="paragraph data-line-625">
<p>Un exemple de service d&#8217;√©change sous-marin est <em>Loop</em> de Lightning Labs, la m√™me soci√©t√© qui d√©veloppe LND. Loop existe en deux variantes : Loop In et Loop Out. <em>Loop In</em> accepte un paiement Bitcoin sur la cha√Æne et le convertit en un paiement Lightning hors cha√Æne. <em>Loop Out</em> convertit un paiement Lightning en paiement Bitcoin.</p>
</div>
<div class="admonitionblock note data-line-628">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-629">
<p>Pour utiliser le service Loop, vous devez ex√©cuter un n≈ìud Lightning LND.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-632">
<p>Dans le but de r√©duire le solde de votre porte-monnaie chaud Lightning, vous utiliserez le service Loop Out. Pour utiliser le service Loop, vous devez installer des logiciels suppl√©mentaires sur votre n≈ìud. Le logiciel Loop fonctionne avec votre n≈ìud LND et fournit des outils de ligne de commande pour ex√©cuter des √©changes sous-marins. Vous pouvez trouver le logiciel Loop et les instructions d&#8217;installation sur <a href="https://github.com/lightninglabs/loop" data-href="https://github.com/lightninglabs/loop">GitHub</a>.</p>
</div>
<div class="paragraph data-line-634">
<p>Une fois que vous avez install√© et ex√©cut√© le logiciel, une op√©ration Loop Out est aussi simple que d&#8217;ex√©cuter une seule commande¬†:</p>
</div>
<div class="listingblock data-line-636">
<div class="content">
<pre>loop out --amt 501000 --conf_target 400
Max swap fees for 501000 sat Loop Out: 25716 sat
Regular swap speed requested, it might take up to 30m0s for the swap to be executed.
CONTINUE SWAP? (y/n), expand fee detail (x): x

Estimated on-chain sweep fee:        149 sat
Max on-chain sweep fee:              14900 sat
Max off-chain swap routing fee:      10030 sat
Max no show penalty (prepay):        1337 sat
Max off-chain prepay routing fee:    36 sat
Max swap fee:                        750 sat
CONTINUE SWAP? (y/n): y
Swap initiated

Run `loop monitor` to monitor progress.</pre>
</div>
</div>
<div class="paragraph data-line-654">
<p>Notez que vos frais maximums, qui repr√©sentent le pire des cas, d√©pendront de la cible de confirmation que vous s√©lectionnez.</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-656">
<h3 id="_disponibilit√©_et_temps_de_fonctionnement_des_n≈ìuds_lightning">Disponibilit√© et temps de fonctionnement des n≈ìuds Lightning</h3>
<div class="paragraph data-line-658">
<p>Contrairement √† Bitcoin, les n≈ìuds Lightning doivent √™tre en ligne presque en permanence. Votre n≈ìud doit √™tre en ligne pour recevoir des paiements, ouvrir des canaux, fermer des canaux (de mani√®re coop√©rative) et surveiller les violations du protocole. La disponibilit√© des n≈ìuds est une exigence si importante sur le Lightning Network qu&#8217;il s&#8217;agit d&#8217;une m√©trique utilis√©e par divers outils de gestion automatique des canaux (par exemple, un pilote automatique) pour d√©cider avec quels n≈ìuds ouvrir des canaux. Vous pouvez √©galement voir la "disponibilit√©" en tant que m√©trique de n≈ìud sur les explorateurs de n≈ìuds populaires (voir <a href="#ln_explorer">[ln_explorer]</a>) comme <a href="https://1ml.com" data-href="https://1ml.com">1ML</a>.</p>
</div>
<div class="paragraph data-line-660">
<p>La disponibilit√© des n≈ìuds est particuli√®rement importante pour mitiger et r√©soudre les violations de protocole potentielles (c&#8217;est-√†-dire les engagements r√©voqu√©s). Bien que vous puissiez vous permettre de courtes interruptions d&#8217;une heure √† un ou deux jours, vous ne pouvez pas avoir votre n≈ìud hors ligne pendant de plus longues p√©riodes sans risquer de perdre des fonds.</p>
</div>
<div class="paragraph data-line-662">
<p>Maintenir un n≈ìud en ligne en permanence n&#8217;est pas facile, car divers bogues et limitations de ressources peuvent entra√Æner et entra√Æneront occasionnellement des temps d&#8217;arr√™t. Surtout si vous ex√©cutez un n≈ìud occup√© et populaire, vous rencontrerez des limitations de m√©moire, d&#8217;espace de swap, de nombre de fichiers ouverts, d&#8217;espace disque, etc. Une multitude de probl√®mes diff√©rents feront planter votre n≈ìud ou votre serveur.</p>
</div>
<div class="sect3 data-line-664">
<h4 id="_tol√©rer_les_d√©fauts_et_automatiser">Tol√©rer les d√©fauts et automatiser</h4>
<div class="paragraph data-line-666">
<p>Si vous avez le temps et les comp√©tences, vous devez tester certains sc√©narios d&#8217;erreur de base sur le Lightning testnet. Sur le testnet, vous apprendrez de pr√©cieuses le√ßons sans risquer d&#8217;argent. Chaque √©tape que vous effectuez pour automatiser votre syst√®me am√©liorera votre disponibilit√©¬†:</p>
</div>
<div class="dlist data-line-668">
<dl>
<dt class="hdlist1">Red√©marrage automatique d&#8217;ordinateur serveur</dt>
<dd>
<p>Que se passe-t-il lorsque votre serveur ou le syst√®me d&#8217;exploitation tombe en panne¬†? Que se passe-t-il en cas de panne de courant ? Simulez ce d√©faut en appuyant sur le bouton "reset" de votre PC ou en d√©branchant le c√¢ble d&#8217;alimentation. Apr√®s un plantage, une r√©initialisation ou une panne de courant, l&#8217;ordinateur doit red√©marrer automatiquement. Certains ordinateurs ont un param√®tre dans leur BIOS pour sp√©cifier comment l&#8217;ordinateur doit r√©agir en cas de panne de courant. Testez-le pour vous assurer que l&#8217;ordinateur red√©marre vraiment automatiquement en cas de panne de courant sans intervention humaine.</p>
</dd>
<dt class="hdlist1">Red√©marrage automatique des n≈ìuds</dt>
<dd>
<p>Que se passe-t-il lorsque votre n≈ìud ou l&#8217;un de vos n≈ìuds plante¬†? Simulez cette erreur en tuant les processus de n≈ìud correspondants. Si un n≈ìud tombe en panne, il doit red√©marrer automatiquement. Testez-le pour vous assurer que le ou les n≈ìuds red√©marrent vraiment automatiquement en cas d&#8217;√©chec sans intervention humaine. Si ce n&#8217;est pas le cas, votre n≈ìud n&#8217;est probablement pas configur√© correctement en tant que service du syst√®me d&#8217;exploitation.</p>
</dd>
<dt class="hdlist1">Reconnexion automatique au r√©seau</dt>
<dd>
<p>Que se passe-t-il si votre r√©seau tombe en panne¬†? Que se passe-t-il lorsque votre FAI tombe temporairement en panne¬†? Que se passe-t-il lorsque votre FAI attribue une nouvelle adresse IP √† votre routeur ou √† votre ordinateur¬†? Lorsque le r√©seau revient, les n≈ìuds que vous ex√©cutez se reconnectent-ils automatiquement au r√©seau¬†? Simulez ce d√©faut en d√©branchant puis en rebranchant le c√¢ble Ethernet de l&#8217;appareil h√©bergeant vos n≈ìuds. Les n≈ìuds doivent se reconnecter automatiquement et continuer √† fonctionner sans intervention humaine.</p>
</dd>
<dt class="hdlist1">Configurez vos fichiers journaux</dt>
<dd>
<p>Tous les √©checs pr√©c√©dents doivent laisser des entr√©es textuelles dans les fichiers journaux correspondants. Augmentez la verbosit√© de la journalisation si n√©cessaire. Recherchez ces entr√©es d&#8217;erreur dans les fichiers journaux et utilisez-les pour la surveillance.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-676">
<h4 id="_surveillance_de_la_disponibilit√©_des_n≈ìuds">Surveillance de la disponibilit√© des n≈ìuds</h4>
<div class="paragraph data-line-678">
<p>La surveillance de vos n≈ìuds est une partie importante de leur fonctionnement. Vous devez surveiller non seulement la disponibilit√© de l&#8217;ordinateur lui-m√™me, mais √©galement la disponibilit√© et le bon fonctionnement du logiciel du n≈ìud Lightning.</p>
</div>
<div class="paragraph data-line-680">
<p>Il existe plusieurs fa√ßons de proc√©der, mais la plupart n√©cessitent une certaine personnalisation. Vous pouvez utiliser des outils g√©n√©riques de surveillance de l&#8217;infrastructure ou de surveillance des applications, mais vous devez les personnaliser sp√©cifiquement pour interroger l&#8217;API du n≈ìud Lightning afin de vous assurer que le n≈ìud est en cours d&#8217;ex√©cution, synchronis√© avec la blockchain et connect√© aux pairs des canaux.</p>
</div>
<div class="paragraph data-line-682">
<p><a href="https://lightning.watch" data-href="https://lightning.watch">Lightning.watch</a> fournit un service sp√©cialis√© qui offre la surveillance de n≈ìuds Lightning. Il utilise un bot Telegram pour vous informer de toute interruption de service. Il s&#8217;agit d&#8217;un service gratuit, bien que vous puissiez payer (sur Lightning, bien s√ªr) pour obtenir des alertes plus rapides.</p>
</div>
<div class="paragraph data-line-684">
<p>Au fil du temps, nous nous attendons √† ce que davantage de services tiers fournissent une surveillance sp√©cialis√©e de n≈ìuds Lightning payable via des micropaiements. Peut-√™tre que ces services et leurs API deviendront standardis√©s et seront un jour directement pris en charge par le logiciel de n≈ìud Lightning.</p>
</div>
</div>
<div class="sect3 data-line-687">
<h4 id="watchtowers">Tours de guet</h4>
<div class="paragraph data-line-689">
<p>Les <em>tours de guet</em> ("watchtowers" en anglais) sont un m√©canisme d&#8217;externalisation de la surveillance et de la r√©solution des p√©nalit√©s pour les violations du protocole Lightning.</p>
</div>
<div class="paragraph data-line-691">
<p>Comme nous l&#8217;avons mentionn√© dans les chapitres pr√©c√©dents, le protocole Lightning maintient la s√©curit√© gr√¢ce √† un m√©canisme de p√©nalit√©. Si l&#8217;un de vos partenaires de canal diffuse une ancienne transaction d&#8217;engagement, votre n≈ìud devra exercer la clause de r√©vocation et diffuser une transaction de p√©nalit√© pour √©viter de perdre de l&#8217;argent. Mais si votre n≈ìud est en panne pendant la violation du protocole, vous risquez de perdre de l&#8217;argent.</p>
</div>
<div class="paragraph data-line-693">
<p>Pour r√©soudre ce probl√®me, nous pouvons utiliser une ou plusieurs tours de guet pour externaliser le travail de surveillance des violations de protocole et d&#8217;√©mission de transactions de p√©nalit√©. Il y a deux parties dans une configuration de tour de guet¬†: un serveur de tour de guet (ou simplement une tour de guet) qui surveille la blockchain et un client de tour de guet qui demande au serveur de la tour de guet ce service de surveillance.</p>
</div>
<div class="paragraph data-line-695">
<p>La technologie de tour de guet en est encore aux premiers stades de d√©veloppement et n&#8217;est pas largement prise en charge. Cependant, dans le passage suivant, nous √©num√©rons quelques impl√©mentations exp√©rimentales que vous pouvez essayer.</p>
</div>
<div class="paragraph data-line-697">
<p>Le logiciel LND comprend √† la fois un serveur de tour de guet et un client de tour de guet. Vous pouvez activer le serveur de tour de guet en ajoutant les options de configuration suivantes¬†:</p>
</div>
<div class="listingblock data-line-700">
<div class="content">
<pre class="highlight"><code>[watchtower]
watchtower.active=1
watchtower.towerdir=<em>/path_to_watchtower_data_directory</em></code></pre>
</div>
</div>
<div class="paragraph data-line-706">
<p>Vous pouvez utiliser le client de tour de guet de LND en l&#8217;activant dans la configuration puis en utilisant la ligne de commande pour le connecter √† un serveur watchtower. La configuration est¬†:</p>
</div>
<div class="listingblock data-line-708">
<div class="content">
<pre>[wtclient]
wtclient.active=1</pre>
</div>
</div>
<div class="paragraph data-line-713">
<p>Le client de ligne de commande de LND lncli affiche les options suivantes pour g√©rer le client de tour de guet¬†:</p>
</div>
<div class="listingblock data-line-715">
<div class="content">
<pre>$ lncli wtclient

NAME:
   lncli wtclient - Interact with the watchtower client.

USAGE:
   lncli wtclient command [command options] [arguments...]

COMMANDS:
     add     Register a watchtower to use for future sessions/backups.
     remove  Remove a watchtower to prevent its use for future sessions/backups.
     towers  Display information about all registered watchtowers.
     tower   Display information about a specific registered watchtower.
     stats   Display the session stats of the watchtower client.
     policy  Display the active watchtower client policy configuration.

OPTIONS:
   --help, -h  show help</pre>
</div>
</div>
<div class="paragraph data-line-736">
<p><code>c-lightning</code> a les hooks d&#8217;API n√©cessaires pour un plug-in client de tour de guet, bien qu&#8217;aucun plug-in de ce type n&#8217;ait encore √©t√© impl√©ment√©.</p>
</div>
<div class="paragraph data-line-738">
<p>Enfin, un serveur de tour de guet autonome populaire est <em>The Eye of Satoshi</em> (TEOS, traduit en "l&#8217;Oeuil de Satoshi"). Il peut √™tre trouv√© sur <a href="https://github.com/talaia-labs/python-teos" data-href="https://github.com/talaia-labs/python-teos">GitHub</a>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-740">
<h3 id="_gestion_des_canaux">Gestion des canaux</h3>
<div class="paragraph data-line-742">
<p>En tant qu&#8217;op√©rateur de n≈ìud Lightning, l&#8217;une des t√¢ches r√©currentes que vous devrez effectuer est la gestion de vos canaux. Cela signifie ouvrir des canaux sortants de votre n≈ìud vers d&#8217;autres n≈ìuds, ainsi que faire en sorte que d&#8217;autres n≈ìuds ouvrent des canaux entrants vers votre n≈ìud. √Ä l&#8217;avenir, la construction de canaux coop√©ratifs pourrait devenir possible, vous pourriez donc ouvrir des canaux sym√©triques qui auraient des fonds engag√©s aux deux extr√©mit√©s lors de leur cr√©ation. Pour l&#8217;instant, cependant, les nouveaux canaux n&#8217;ont de fonds que d&#8217;un c√¥t√©, du c√¥t√© de l&#8217;initiateur. Par cons√©quent, pour rendre votre n≈ìud <em>√©quilibr√©</em> avec une capacit√© entrante et sortante, vous devez ouvrir des canaux avec les autres et inciter les autres √† ouvrir des canaux vers votre n≈ìud.</p>
</div>
<div class="sect3 data-line-744">
<h4 id="_ouverture_de_canaux_sortants">Ouverture de canaux sortants</h4>
<div class="paragraph data-line-746">
<p>D√®s que votre n≈ìud Lightning est op√©rationnel, vous pouvez financer son porte-monnaie Bitcoin, puis commencer √† ouvrir des canaux avec ces fonds.</p>
</div>
<div class="paragraph data-line-748">
<p>Vous devez choisir les partenaires de canal avec soin, car la capacit√© de votre n≈ìud √† envoyer des paiements d√©pend de qui sont vos partenaires de canal et de leur niveau de connexion au reste du Lightning Network. Vous souhaitez √©galement disposer de plusieurs canaux pour √©viter d&#8217;√™tre expos√© √† un seul point de d√©faillance. √âtant donn√© que Lightning prend d√©sormais en charge les paiements en plusieurs parties, vous pouvez diviser vos fonds initiaux en plusieurs canaux et acheminer des paiements plus importants en combinant leur capacit√©. En m√™me temps, √©vitez de rendre vos canaux trop petits. √âtant donn√© que vous devez payer des frais de transaction Bitcoin pour ouvrir et fermer un canal, le solde du canal ne doit pas √™tre si faible que les frais sur la cha√Æne en consommeraient une part importante. Tout est question d&#8217;√©quilibre !</p>
</div>
<div class="paragraph data-line-750">
<p>En r√©sum√©¬†:</p>
</div>
<div class="ulist data-line-752">
<ul>
<li class="data-line-752">
<p>Connectez-vous √† quelques n≈ìuds bien connect√©s</p>
</li>
<li class="data-line-753">
<p>Ouvrez plus d&#8217;un canal</p>
</li>
<li class="data-line-754">
<p>N&#8217;ouvrez pas trop de canaux</p>
</li>
<li class="data-line-755">
<p>Ne faites pas des canaux trop petits</p>
</li>
</ul>
</div>
<div class="paragraph data-line-757">
<p>Une fa√ßon de trouver des n≈ìuds bien connect√©s consiste √† ouvrir un canal vers un marchand populaire vendant des produits sur le Lightning Network. Ces n≈ìuds ont tendance √† √™tre bien financ√©s et bien connect√©s. Ainsi, lorsque vous √™tes pr√™t √† acheter quelque chose en ligne via Lightning, vous pouvez ouvrir un canal directement sur le n≈ìud du marchand. L&#8217;ID de n≈ìud du marchand figurera sur la facture que vous recevrez lorsque vous essaierez d&#8217;acheter quelque chose. Cela facilite les choses.</p>
</div>
<div class="paragraph data-line-759">
<p>Une autre fa√ßon de trouver des n≈ìuds bien connect√©s consiste √† utiliser un Lightning Explorer (voir <a href="#ln_explorer">[ln_explorer]</a>) comme <a href="https://1ml.com" data-href="https://1ml.com">1ML</a> et parcourez la liste des n≈ìuds tri√©s par capacit√© de canal et nombre de canaux. N&#8217;optez pas pour les plus gros n≈ìuds, car cela encourage la centralisation. Optez pour un n≈ìud au milieu de la liste afin de pouvoir les aider √† grandir. Un autre facteur √† prendre en compte peut √™tre la dur√©e de fonctionnement d&#8217;un n≈ìud. Les n≈ìuds √©tablis depuis plus d&#8217;un an sont susceptibles d&#8217;√™tre plus r√©put√©s et moins risqu√©s que les n≈ìuds qui ont commenc√© √† fonctionner il y a une semaine.</p>
</div>
<div class="sect4 data-line-762">
<h5 id="autopilot">Pilote automatique</h5>
<div class="paragraph data-line-764">
<p>La t√¢che d&#8217;ouverture des canaux peut √™tre partiellement automatis√©e gr√¢ce √† l&#8217;utilisation d&#8217;un <em>pilote automatique</em> qui est un logiciel qui ouvre automatiquement les canaux en fonction de certaines r√®gles heuristiques. Le logiciel de pilote automatique est encore relativement nouveau et il ne s√©lectionne pas toujours les meilleurs partenaires de canal pour vous. Surtout au d√©but, il serait peut-√™tre pr√©f√©rable d&#8217;ouvrir des canaux manuellement.
Les pilotes automatiques existent actuellement sous trois formes¬†:</p>
</div>
<div class="ulist data-line-767">
<ul>
<li class="data-line-767">
<p>lnd int√®gre un pilote automatique enti√®rement int√©gr√© √† lnd et fonctionne constamment en arri√®re-plan lorsqu&#8217;il est en fonction.</p>
</li>
<li class="data-line-768">
<p>lib_autopilot.py peut offrir des calculs de pilote automatique pour n&#8217;importe quelle impl√©mentation de n≈ìud bas√©e sur les bavardages et les donn√©es des canaux.</p>
</li>
<li class="data-line-769">
<p>Il existe un plug-in c-lightning bas√© sur lib_autopilot.py qui fournit une interface facile √† utiliser pour les utilisateurs de c-lightning.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-771">
<p>Sachez que le pilote automatique lnd commencera √† fonctionner en arri√®re-plan d√®s qu&#8217;il sera activ√© via le fichier de configuration. En cons√©quence, il commencera √† ouvrir des canaux imm√©diatement si vous avez des sorties sur la cha√Æne dans votre porte-monnaie lnd.
Si vous souhaitez avoir un contr√¥le total sur les transactions en bitcoins que vous effectuez et les canaux que vous ouvrez, assurez-vous de d√©sactiver le pilote automatique <em>avant</em> de charger votre porte-monnaie lnd avec des fonds en bitcoins.
Si le pilote automatique √©tait activ√© auparavant, vous aurez peut-√™tre √† red√©marrer votre lnd avant de recharger votre porte-monnaie avec une transaction sur la cha√Æne ou avant de fermer des canaux, ce qui vous redonne effectivement des fonds sur la cha√Æne.
Il est essentiel que vous d√©finissiez des valeurs de configuration cl√©s si vous souhaitez ex√©cuter le pilote automatique.
Jetez un ≈ìil √† cet exemple de configuration¬†:</p>
</div>
<div class="listingblock data-line-778">
<div class="content">
<pre>[lnd-autopilot]
autopilot.active=1
autopilot.maxchannels=40
autopilot.allocation=0.70
autopilot.minchansize=500000
autopilot.maxchansize=5000000
autopilot.heuristic=top_centrality:1.0</pre>
</div>
</div>
<div class="paragraph data-line-788">
<p>Ce fichier de configuration activerait le pilote automatique.
Cela ouvrirait des canaux tant que les deux conditions suivantes seraient remplies¬†:</p>
</div>
<div class="olist arabic data-line-791">
<ol class="arabic">
<li class="data-line-791">
<p>Votre n≈ìud a actuellement moins de 40 canaux ouverts.</p>
</li>
<li class="data-line-792">
<p>Moins de 70 % de vos fonds totaux sont hors cha√Æne dans les canaux de paiement.</p>
</li>
</ol>
</div>
<div class="paragraph data-line-794">
<p>Les nombres 40 et 0,7 sont choisis de mani√®re compl√®tement arbitraire ici car nous ne pouvons faire aucune recommandation valable pour tout le monde sur le nombre de canaux que vous devriez avoir ouverts et le pourcentage de vos fonds qui devraient √™tre hors cha√Æne.
Le pilote automatique dans lnd ne prendra pas en compte les frais sur la cha√Æne. En d&#8217;autres termes, il ne retardera pas l&#8217;ouverture de canaux pour attendre une p√©riode o√π les frais sont bas.
Pour r√©duire les frais, vous pouvez ouvrir manuellement les canaux pendant une p√©riode o√π les frais sont bas, par exemple, pendant le week-end.
Le pilote automatique fera des recommandations de canaux chaque fois que les conditions sont remplies et essaiera imm√©diatement d&#8217;ouvrir un canal en utilisant les frais actuels appropri√©s.
Selon le fichier de configuration pr√©c√©dent, les canaux auront une taille comprise entre 5 mBTC (<code>minchansize</code> = 500 000 satoshis) et 50 mBTC (<code>maxchansize</code> = 5 000 000 satoshis).
Comme il est courant, les montants dans le fichier de configuration sont √©num√©r√©s en satoshis.
Actuellement, les canaux inf√©rieurs √† 1 mBTC ne sont pas tr√®s utiles, et nous vous d√©conseillons d&#8217;ouvrir des canaux trop petits et inf√©rieurs √† ce montant.
Avec l&#8217;adoption plus large des paiements en plusieurs parties, les petits canaux sont moins un fardeau. Mais pour le moment, c&#8217;est notre recommandation.</p>
</div>
<div class="paragraph data-line-803">
<p>Le plugin c-lightning, qui a √©t√© √©crit √† l&#8217;origine par Ren√© Pickhardt (un co-auteur de ce livre), fonctionne tr√®s diff√©remment par rapport au pilote automatique lnd.
Premi√®rement, il diff√®re dans les algorithmes utilis√©s pour faire les recommandations. Nous ne couvrirons pas cela ici. Deuxi√®mement, il diff√®re par son interface utilisateur.
Vous devrez t√©l√©charger le plug-in de <em>pilote automatique</em> √† partir du <a href="https://github.com/lightningd/plugins/tree/master/autopilot" data-href="https://github.com/lightningd/plugins/tree/master/autopilot">d√©p√¥t</a> de plug-ins c-lightning et l&#8217;activer.</p>
</div>
<div class="admonitionblock note data-line-808">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-809">
<p>Pour activer un plug-in dans c-lightning, placez-le dans le r√©pertoire <em>~/.lightning/plugins</em>, assurez-vous qu&#8217;il est ex√©cutable (par exemple, <code>chmod +x ~/.lightning/plugins/autopilot.py</code>), puis red√©marrez lightningd.</p>
</div>
<div class="paragraph data-line-811">
<p>Sinon, si vous ne souhaitez pas qu&#8217;un plug-in s&#8217;active automatiquement lorsque vous d√©marrez lightningd, vous pouvez le placer dans un r√©pertoire diff√©rent et l&#8217;activer manuellement avec l&#8217;argument plugin de lightningd¬†:</p>
</div>
<div class="listingblock data-line-813">
<div class="content">
<pre>   lightningd --plugin=~/lightning-plugins/autopilot.py</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-819">
<p>Le pilote automatique dans c-lightning est contr√¥l√© via trois valeurs de configuration qui peuvent √™tre d√©finies dans le fichier de configuration ou en tant qu&#8217;arguments de ligne de commande lorsque vous d√©marrez lightningd¬†:</p>
</div>
<div class="listingblock data-line-821">
<div class="content">
<pre>[c-lightning-autopilot]
autopilot-percent=75
autopilot-num-channels=10
autopilot-min-channel-size-msat=100000000msat</pre>
</div>
</div>
<div class="paragraph data-line-828">
<p>Ces valeurs sont la configuration par d√©faut r√©elle et vous n&#8217;avez pas du tout besoin de les d√©finir.</p>
</div>
<div class="paragraph data-line-830">
<p>Le pilote automatique ne fonctionnera pas automatiquement en arri√®re-plan comme dans lnd.
Au lieu de cela, vous devez d√©marrer une ex√©cution sp√©cifiquement avec <code>lightning-cli autopilot-run-once</code> si vous souhaitez que le pilote automatique ouvre les canaux recommand√©s.
Mais si vous voulez qu&#8217;il vous fournisse simplement des recommandations, √† partir desquelles vous pouvez s√©lectionner les n≈ìuds, vous pouvez ajouter l&#8217;argument facultatif <code>dryrun</code>.</p>
</div>
<div class="paragraph data-line-834">
<p>Une diff√©rence cl√© entre les pilotes automatiques lnd et c-lightning est que le pilote automatique c-lightning fera √©galement une recommandation pour la taille du canal.
Par exemple, si le pilote automatique recommande d&#8217;ouvrir un canal avec un petit n≈ìud qui n&#8217;a que de petits canaux, il ne recommandera pas d&#8217;ouvrir un grand canal.
Cependant, s&#8217;il ouvre un canal avec un n≈ìud bien connect√© qui poss√®de √©galement de nombreux canaux volumineux, il recommandera probablement une taille de canal plus grande.</p>
</div>
<div class="paragraph data-line-838">
<p>Comme vous pouvez le voir, le pilote automatique c-lightning n&#8217;est pas aussi automatique que celui de lnd, mais il vous donne un peu plus de contr√¥le.
Ces diff√©rences refl√®tent des pr√©f√©rences personnelles et pourraient en fait √™tre le facteur d√©cisif pour vous de choisir une impl√©mentation plut√¥t qu&#8217;une autre.</p>
</div>
<div class="paragraph data-line-841">
<p>Gardez √† l&#8217;esprit que les pilotes automatiques actuels utiliseront principalement les informations publiques du protocole de bavardage sur la topologie actuelle du Lightning Network.
Il est √©vident que vos exigences personnelles en mati√®re de canaux ne peuvent √™tre refl√©t√©es que dans une certaine mesure.
Des pilotes automatiques plus avanc√©s utiliseraient les informations historiques et d&#8217;utilisation que votre n≈ìud aurait recueillies lors de son ex√©cution pass√©e, y compris des informations sur les succ√®s de routage, qui vous avez pay√© dans le pass√© et qui vous a pay√©.
√Ä l&#8217;avenir, ces pilotes automatiques am√©lior√©s pourraient √©galement utiliser ces donn√©es collect√©es pour faire des recommandations sur la fermeture des canaux et la r√©affectation des fonds.</p>
</div>
<div class="paragraph data-line-846">
<p>Dans l&#8217;ensemble, au moment de la r√©daction de ce livre, veillez √† ne pas d√©pendre ou trop compter sur les pilotes automatiques.</p>
</div>
</div>
</div>
<div class="sect3 data-line-848">
<h4 id="_obtenir_des_liquidit√©s_entrantes">Obtenir des liquidit√©s entrantes</h4>
<div class="paragraph data-line-850">
<p>Dans la conception actuelle du Lightning Network, il est plus courant que les utilisateurs obtiennent des liquidit√©s sortantes <em>avant</em> d&#8217;obtenir des liquidit√©s entrantes.
Ils le feront en ouvrant un canal avec un autre n≈ìud, et le plus souvent ils pourront d√©penser des bitcoins avant de pouvoir en recevoir.
Il existe trois fa√ßons typiques d&#8217;obtenir des liquidit√©s entrantes¬†:</p>
</div>
<div class="ulist data-line-854">
<ul>
<li class="data-line-854">
<p>Ouvrez un canal avec des liquidit√©s sortantes, puis d√©pensez une partie de ces fonds. Maintenant, le solde est √† l&#8217;autre bout du canal, ce qui signifie que vous pouvez recevoir des paiements.</p>
</li>
<li class="data-line-856">
<p>Demandez √† quelqu&#8217;un d&#8217;ouvrir un canal vers votre n≈ìud. Proposez de rendre la pareille, afin que vos deux n≈ìuds deviennent mieux connect√©s et √©quilibr√©s.</p>
</li>
<li class="data-line-858">
<p>Utilisez un swap sous-marin (par exemple, Loop In) pour √©changer des BTC sur la cha√Æne contre un canal entrant vers votre n≈ìud.</p>
</li>
<li class="data-line-860">
<p>Payez un service tiers pour ouvrir un canal avec vous. Plusieurs services de ce type existent. Certains facturent des frais pour fournir des liquidit√©s, d&#8217;autres sont gratuits.</p>
</li>
</ul>
</div>
<div class="paragraph pagebreak-before data-line-863">
<p>Voici une liste des fournisseurs de liquidit√© actuellement disponibles qui ouvriront un canal vers votre n≈ìud moyennant des frais¬†:</p>
</div>
<div class="ulist data-line-865">
<ul>
<li class="data-line-865">
<p><a href="https://www.bitrefill.com/thor-lightning-network-channels" data-href="https://www.bitrefill.com/thor-lightning-network-channels">Service Thor de Bitrefill</a></p>
</li>
<li class="data-line-867">
<p><a href="https://lightningto.me" data-href="https://lightningto.me">Lightning To Me</a></p>
</li>
<li class="data-line-869">
<p><a href="https://lnbig.com" data-href="https://lnbig.com">LNBig</a></p>
</li>
<li class="data-line-871">
<p><a href="https://lightningconductor.net/channels" data-href="https://lightningconductor.net/channels">Lightning Conductor</a></p>
</li>
</ul>
</div>
<div class="paragraph data-line-873">
<p>La cr√©ation de liquidit√©s entrantes est un d√©fi √† la fois du point de vue pratique et de l&#8217;exp√©rience utilisateur. La liquidit√© entrante ne se produit pas automatiquement, vous devez donc trouver des moyens de la cr√©er pour votre n≈ìud. Cette asym√©trie des canaux de paiement n&#8217;est pas non plus intuitive. Dans la plupart des autres syst√®mes de paiement, vous √™tes pay√© en premier (entrant) avant de payer les autres (sortant).</p>
</div>
<div class="paragraph data-line-875">
<p>Le d√©fi de cr√©er des liquidit√©s entrantes est plus visible si vous √™tes un commer√ßant ou si vous vendez vos services pour les paiements Lightning. Dans ce cas, vous devez √™tre vigilant pour vous assurer que vous disposez de suffisamment de liquidit√©s entrantes pour pouvoir continuer √† recevoir des paiements. Que se passe-t-il s&#8217;il y a une vague d&#8217;acheteurs dans votre magasin, mais qu&#8217;ils ne peuvent pas vous payer parce qu&#8217;il n&#8217;y a plus de capacit√© entrante¬†?</p>
</div>
<div class="paragraph data-line-877">
<p>√Ä l&#8217;avenir, ces d√©fis peuvent √™tre partiellement att√©nu√©s par la mise en ≈ìuvre de canaux √† double financement, qui sont financ√©s des deux c√¥t√©s et offrent une capacit√© entrante et sortante √©quilibr√©e. La charge pourrait √©galement √™tre att√©nu√©e par un logiciel de pilote automatique plus sophistiqu√©, qui pourrait demander et payer la capacit√© entrante selon les besoins.</p>
</div>
<div class="paragraph data-line-879">
<p>En fin de compte, les utilisateurs de Lightning doivent √™tre strat√©giques et proactifs en mati√®re de gestion des canaux pour s&#8217;assurer qu&#8217;une capacit√© entrante suffisante est disponible pour r√©pondre √† leurs besoins.</p>
</div>
</div>
<div class="sect3 data-line-881">
<h4 id="_fermeture_de_canaux">Fermeture de canaux</h4>
<div class="paragraph data-line-883">
<p>Comme discut√© pr√©c√©demment dans le livre, une <em>fermeture mutuelle</em> est la m√©thode pr√©f√©r√©e pour fermer un canal. Cependant, il existe des cas o√π une <em>fermeture forc√©e</em> est n√©cessaire.</p>
</div>
<div class="paragraph data-line-885">
<p>Quelques exemples¬†:</p>
</div>
<div class="ulist data-line-887">
<ul>
<li class="data-line-887">
<p>Votre partenaire de canal est hors ligne et ne peut pas √™tre contact√© pour initier une fermeture mutuelle.</p>
</li>
<li class="data-line-888">
<p>Votre partenaire de canal est en ligne, mais ne r√©pond pas aux demandes d&#8217;initiation d&#8217;une fermeture mutuelle.</p>
</li>
<li class="data-line-889">
<p>Votre partenaire de canal est en ligne et vos n≈ìuds n√©gocient une fermeture mutuelle, mais ils sont bloqu√©s et ne parviennent pas √† une r√©solution.</p>
</li>
</ul>
</div>
</div>
<div class="sect3 data-line-892">
<h4 id="channel_rebalancing">R√©√©quilibrage de canaux</h4>
<div class="paragraph data-line-894">
<p>Au cours des transactions et du routage de paiements sur Lightning, la combinaison des capacit√©s entrantes et sortantes peut devenir d√©s√©quilibr√©e.</p>
</div>
<div class="paragraph data-line-896">
<p>Par exemple, si l&#8217;un de vos partenaires de canal achemine fr√©quemment des paiements via votre n≈ìud, vous √©puiserez la capacit√© entrante sur ce canal, tout en √©puisant √©galement la capacit√© sortante sur les canaux sortants. Une fois que cela se produit, vous ne pouvez plus acheminer les paiements par cette route.</p>
</div>
<div class="paragraph data-line-898">
<p>Il existe de nombreuses fa√ßons de r√©√©quilibrer les canaux, chacune pr√©sentant des avantages et des inconv√©nients diff√©rents. Une fa√ßon consiste √† utiliser un √©change sous-marin (par exemple, Loop Out), comme d√©crit pr√©c√©demment dans ce chapitre. Une autre fa√ßon de r√©√©quilibrer consiste simplement √† attendre les paiements achemin√©s qui circulent dans la direction oppos√©e. Si votre n≈ìud est bien connect√©, lorsqu&#8217;une route sp√©cifique devient √©puis√©e dans une direction, la m√™me route devient disponible dans la direction oppos√©e. D&#8217;autres n≈ìuds peuvent "d√©couvrir" cette route dans la direction oppos√©e et commencer √† l&#8217;utiliser dans le cadre de leur chemin de paiement, r√©√©quilibrant ainsi √† nouveau les fonds.</p>
</div>
<div class="paragraph data-line-900">
<p>Une troisi√®me fa√ßon de r√©√©quilibrer les canaux consiste √† cr√©er d√©lib√©r√©ment une <em>route circulaire</em> qui renvoie un paiement de votre n≈ìud vers votre n≈ìud, via le Lightning Network. En envoyant un paiement sur un canal local de grande capacit√© et en organisant le chemin de mani√®re √† ce qu&#8217;il revienne √† votre n≈ìud sur un canal distant de grande capacit√©, ces deux canaux deviendront plus √©quilibr√©s. Un exemple de strat√©gie de r√©√©quilibrage de route circulaire peut √™tre aper√ßu dans <a href="#circular_rebalancing">R√©√©quilibrage par une route circulaire</a>.</p>
</div>
<div id="circular_rebalancing" class="imageblock data-line-904">
<div class="content">
<img src="images/mtln_0504.png" alt="mtln 0504">
</div>
<div class="title">Figure 4. R√©√©quilibrage par une route circulaire</div>
</div>
<div class="paragraph data-line-906">
<p>Le r√©√©quilibrage circulaire est pris en charge par la plupart des impl√©mentations de n≈ìuds Lightning et peut √™tre effectu√© en ligne de commande ou via l&#8217;une des interfaces de gestion Web telles que Ride The Lightning (voir <a href="#rtl">Ride The Lightning</a>).</p>
</div>
<div class="paragraph data-line-908">
<p>Le r√©√©quilibrage des canaux est une question complexe qui fait l&#8217;objet de recherches actives et abord√©e plus en d√©tail dans <a href="#channel_rebalancing">R√©√©quilibrage de canaux</a>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-910">
<h3 id="_frais_de_routage">Frais de routage</h3>
<div class="paragraph data-line-912">
<p>L&#8217;ex√©cution d&#8217;un n≈ìud Lightning vous permet de gagner des frais en acheminant les paiements sur vos canaux. Les frais de routage ne sont g√©n√©ralement pas une source de revenus importante et sont √©clips√©s par le co√ªt d&#8217;exploitation d&#8217;un n≈ìud. Par exemple, sur un n≈ìud relativement occup√© qui achemine une douzaine de paiements par jour, les frais ne d√©passent pas 2 000 satoshis.</p>
</div>
<div class="paragraph data-line-914">
<p>Les n≈ìuds se font concurrence pour les frais de routage en fixant leur taux de frais d√©sir√©s sur chaque canal. Les frais de routage sont d√©finis par deux param√®tres sur chaque canal¬†: un <em>frais de base</em> ("base fee" en anglais) fixe qui est factur√© pour tout paiement et un <em>taux de frais</em> ("fee rate" en anglais) variable suppl√©mentaire qui est proportionnel au montant du paiement.</p>
</div>
<div class="paragraph data-line-916">
<p>Lors de l&#8217;envoi d&#8217;un paiement Lightning, un n≈ìud s√©lectionnera un chemin afin de minimiser les frais, de minimiser les sauts, ou les deux. En cons√©quence, un march√© des frais de routage √©merge de ces interactions. Il existe actuellement de nombreux n≈ìuds qui facturent des frais de routage tr√®s faibles ou nuls, ce qui cr√©e une pression √† la baisse sur le march√© des frais de routage.</p>
</div>
<div class="paragraph data-line-918">
<p>Si vous ne faites aucun choix, votre n≈ìud Lightning d√©finira des frais de base et un taux de frais par d√©faut pour chaque nouveau canal. Les valeurs par d√©faut d√©pendent de l&#8217;impl√©mentation de n≈ìud que vous utilisez.
Les frais de base sont fix√©s dans l&#8217;unit√© <em>millisatoshi</em> (milli√®mes de satoshi). Le taux de frais proportionnel est d√©fini dans l&#8217;unit√© de <em>millioni√®mes</em> et est appliqu√© au montant du paiement.
L&#8217;unit√© des millioni√®mes est souvent abr√©g√©e en <em>ppm</em> (parties par million).
Par exemple, des frais de base de 1 000 (millisatoshis) et un taux de frais de 1 000 ppm (millioni√®mes) entra√Æneraient les frais suivants pour un paiement de 100 000 satoshis :</p>
</div>
<div class="stemblock data-line-924">
<div class="content">
\[\begin{equation}
\begin{aligned}
P &amp;= 100,000 \text{ satoshis} \\
F_{base} &amp;= 1,000 \text{ millisatoshis} = 1 \text{ satoshi} \\
F_{rate} &amp;= 1,000 \text{ ppm} = 1,000/1,000,000 = 1/1,000 = \text{0.001} = 0.1\% \\
F_{total} &amp;= F_{base} + ( P * F_{rate} ) \\
 \Rightarrow  F_{total} &amp;= 1 \text{ satoshi} + ( 100,000/1,000 ) \text{ satoshis} \\
 \Rightarrow  F_{total} &amp;= 1 \text{ satoshi} + 100 \text{ satoshis} = 101 \text{ satoshis} \\
\end{aligned}
\end{equation}\]
</div>
</div>
<div class="paragraph data-line-937">
<p>D&#8217;une mani√®re g√©n√©rale, vous pouvez adopter l&#8217;une des deux approches des frais de routage. Vous pouvez acheminer de nombreux paiements avec des frais peu √©lev√©s, en compensant les frais peu √©lev√©s par un volume √©lev√©. Alternativement, vous pouvez choisir de facturer des frais plus √©lev√©s. Si vous choisissez de fixer des frais plus √©lev√©s, votre n≈ìud sera s√©lectionn√© uniquement lorsqu&#8217;il n&#8217;existe pas d&#8217;autres itin√©raires moins chers. Par cons√©quent, vous routerez moins fr√©quemment mais gagnerez plus par routage r√©ussi.</p>
</div>
<div class="paragraph data-line-939">
<p>Pour la plupart des n≈ìuds, il est g√©n√©ralement pr√©f√©rable d&#8217;utiliser les valeurs de frais de routage par d√©faut. De cette fa√ßon, votre n≈ìud est en concurrence sur un pied d&#8217;√©galit√© avec les autres n≈ìuds qui utilisent les valeurs par d√©faut.</p>
</div>
<div class="paragraph data-line-941">
<p>Vous pouvez √©galement utiliser les param√®tres de frais de routage pour r√©√©quilibrer les canaux. Si la plupart de vos canaux ont les frais par d√©faut mais que vous souhaitez r√©√©quilibrer un canal particulier, r√©duisez simplement les frais sur ce canal sp√©cifique √† z√©ro ou √† des taux tr√®s bas. Ensuite, asseyez-vous et attendez que quelqu&#8217;un achemine un paiement sur votre itin√©raire "bon march√©" et r√©√©quilibre vos canaux pour vous comme effet secondaire.</p>
</div>
</div>
<div class="sect2 data-line-943">
<h3 id="_gestion_de_n≈ìuds">Gestion de n≈ìuds</h3>
<div class="paragraph data-line-945">
<p>G√©rer votre n≈ìud Lightning en ligne de commande n&#8217;est √©videmment pas facile. Cela vous offre toute la flexibilit√© de l&#8217;API du n≈ìud et la possibilit√© d&#8217;√©crire vos propres scripts personnalis√©s pour r√©pondre √† vos besoins personnels. Mais si vous ne souhaitez pas g√©rer la complexit√© de la ligne de commande et n&#8217;avez besoin que de certaines fonctionnalit√©s de base de gestion des n≈ìuds, vous devriez envisager d&#8217;installer une interface utilisateur Web qui facilite la gestion de n≈ìuds.</p>
</div>
<div class="paragraph data-line-947">
<p>Il existe un certain nombre de projets concurrents qui offrent une gestion Web de n≈ìuds Lightning. Plusieurs des plus populaires sont d√©crits dans la section suivante.</p>
</div>
<div class="sect3 data-line-950">
<h4 id="rtl">Ride The Lightning</h4>
<div class="paragraph data-line-952">
<p>Ride The Lightning (RTL) est une interface utilisateur Web graphique pour aider les utilisateurs √† g√©rer les op√©rations du n≈ìud Lightning pour les trois principales impl√©mentations du n≈ìud Lightning (LND, `c-lightning `, et Eclair). RTL est un projet open source d√©velopp√© par Shahana Farooqui et de nombreux autres contributeurs. Vous pouvez trouver le logiciel RTL sur <a href="https://github.com/Ride-The-Lightning/RTL" data-href="https://github.com/Ride-The-Lightning/RTL">GitHub</a>.</p>
</div>
<div class="paragraph data-line-954">
<p><a href="#rtl-web-interface">Exemple de l&#8217;interface Web de RTL</a> montre un exemple de capture d&#8217;√©cran de l&#8217;interface Web de RTL, telle que fournie sur le d√©p√¥t du projet.</p>
</div>
<div id="rtl-web-interface" class="imageblock data-line-958">
<div class="content">
<img src="images/mtln_0505.png" alt="mtln 0505">
</div>
<div class="title">Figure 5. Exemple de l&#8217;interface Web de RTL</div>
</div>
</div>
<div class="sect3 data-line-960">
<h4 id="_lndmon">lndmon</h4>
<div class="paragraph data-line-962">
<p>Lightning Labs, les cr√©ateurs de LND, fournissent un interface utilisateur graphique bas√©e sur le Web appel√©e lndmon pour surveiller les diff√©rentes m√©triques d&#8217;un n≈ìud LND Lightning. lndmon ne fonctionne qu&#8217;avec les n≈ìuds LND. Il s&#8217;agit d&#8217;une interface en lecture seule pour la surveillance et, en tant que telle, ne vous permet pas de g√©rer activement de n≈ìud. Elle ne peut pas ouvrir de canaux ni effectuer de paiements. Retrouvez lndmon sur <a href="https://github.com/lightninglabs/lndmon" data-href="https://github.com/lightninglabs/lndmon">GitHub</a>.</p>
</div>
</div>
<div class="sect3 data-line-964">
<h4 id="_thunderhub">ThunderHub</h4>
<div class="paragraph data-line-966">
<p><a href="https://thunderhub.io" data-href="https://thunderhub.io">ThunderHub</a> est un interface utilisateur graphique bas√©e sur le Web tr√®s esth√©tique, similaire √† RTL mais exclusive √† LND. Elle peut √™tre utilis√©e pour effectuer des paiements, r√©√©quilibrer les canaux et g√©rer le n≈ìud via une vari√©t√© de fonctionnalit√©s.</p>
</div>
</div>
</div>
<div class="sect2 data-line-968">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph data-line-970">
<p>Au fur et √† mesure que vous entretenez votre n≈ìud et gagnez de l&#8217;exp√©rience, vous en apprendrez beaucoup sur le Lightning Network. √ätre un op√©rateur de n≈ìud est une t√¢che difficile mais gratifiante. La ma√Ætrise de ces comp√©tences vous permettra de contribuer √† la croissance et au d√©veloppement de cette technologie et du Lightning Network lui-m√™me. Vous aurez en outre la possibilit√© d&#8217;envoyer et de recevoir des paiements Lightning avec le plus grand degr√© de contr√¥le et de facilit√©. Vous jouerez un r√¥le central dans l&#8217;infrastructure du r√©seau et ne serez pas seulement un participant √† la p√©riph√©rie.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-04-28 02:37:31 -0400
</div>
</div>
</body>
</html>