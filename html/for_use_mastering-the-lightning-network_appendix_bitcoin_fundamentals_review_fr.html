<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Examen des principes fondamentaux de Bitcoin</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-3">
<h2 id="bitcoin_fundamentals_review">Appendix A: Examen des principes fondamentaux de Bitcoin</h2>
<div class="sectionbody">
<div class="paragraph data-line-5">
<p>Le Lightning Network est capable de fonctionner au-dessus de multiples blockchains, mais est principalement ancré sur Bitcoin. Pour comprendre le Lightning Network, vous avez besoin d&#8217;une compréhension fondamentale de Bitcoin et de ses éléments constitutifs.</p>
</div>
<div class="paragraph data-line-7">
<p>Il existe de nombreuses bonnes ressources que vous pouvez utiliser pour en savoir plus sur Bitcoin, y compris le livre d&#8217;accompagnement <em>Maîtriser Bitcoin</em>, 2ème Edition, par Andreas M. Antonopoulos, que vous pouvez trouver sur GitHub sous <a href="https://github.com/bitcoinbook/bitcoinbook" data-href="https://github.com/bitcoinbook/bitcoinbook">une licence open source</a>. Cependant, vous n&#8217;avez pas besoin de lire tout un autre livre pour être prêt pour celui-ci !</p>
</div>
<div class="paragraph data-line-9">
<p>Dans ce chapitre, nous avons rassemblé les concepts les plus importants que vous devez connaître sur Bitcoin et les avons expliqués dans le contexte du Lightning Network. De cette façon, vous pouvez apprendre exactement ce que vous devez savoir pour comprendre le Lightning Network sans aucune distraction.</p>
</div>
<div class="paragraph data-line-11">
<p>Ce chapitre couvre plusieurs concepts importants de Bitcoin, notamment :</p>
</div>
<div class="ulist data-line-13">
<ul>
<li class="data-line-13">
<p>Clés et signatures numériques</p>
</li>
<li class="data-line-14">
<p>Fonctions de hachage</p>
</li>
<li class="data-line-15">
<p>Les transactions Bitcoin et leur structure</p>
</li>
<li class="data-line-16">
<p>Chaînage des transactions Bitcoin</p>
</li>
<li class="data-line-17">
<p>Points de sortie de transactions</p>
</li>
<li class="data-line-18">
<p>Bitcoin Script : verrouillage et déverrouillage de scripts</p>
</li>
<li class="data-line-19">
<p>Scripts de verrouillage de base</p>
</li>
<li class="data-line-20">
<p>Scripts de verrouillage complexes et conditionnels</p>
</li>
<li class="data-line-21">
<p>Verrouillages basés sur le temps (timelocks)</p>
</li>
</ul>
</div>
<div class="sect2 data-line-24">
<h3 id="_clés_et_signatures_numériques">Clés et signatures numériques</h3>
<div class="paragraph data-line-26">
<p>Vous avez peut-être entendu dire que Bitcoin est basé sur la <em>cryptographie</em>, qui est une branche des mathématiques largement utilisées en sécurité informatique. La cryptographie peut également être utilisée pour prouver la connaissance d&#8217;un secret sans révéler ce secret (signature numérique), ou prouver l&#8217;authenticité de données (empreinte numérique). Ces types de preuves cryptographiques sont les outils mathématiques essentiels à Bitcoin et largement utilisés dans les applications Bitcoin.</p>
</div>
<div class="paragraph data-line-28">
<p>La possession de bitcoins est établie par le biais de <em>clés numériques</em>, <em>adresses bitcoin</em> et <em>signatures numériques</em>. Les clés numériques ne sont pas réellement stockées dans le réseau, mais sont plutôt créées et stockées par les utilisateurs dans un fichier, ou une simple base de données, appelée <em>porte-monnaie</em>. Les clés numériques du porte-monnaie d&#8217;un utilisateur sont totalement indépendantes du protocole Bitcoin et peuvent être générées et gérées par le logiciel du porte-monnaie de l&#8217;utilisateur sans référence à la blockchain ni accès à Internet.</p>
</div>
<div class="paragraph data-line-30">
<p>La plupart des transactions Bitcoin nécessitent une signature numérique valide à inclure dans la blockchain, qui ne peut être générée qu&#8217;avec une clé secrète ; par conséquent, toute personne possédant une copie de cette clé a le contrôle des bitcoins. La signature numérique utilisée pour dépenser des fonds est également appelée <em>témoin</em>, un terme utilisé en cryptographie. Les données témoins dans une transaction bitcoin témoignent de la véritable propriété des fonds dépensés. Les clés sont fournies par paires composées d&#8217;une clé privée (secrète) et d&#8217;une clé publique. Considérez la clé publique comme similaire à un numéro de compte bancaire et la clé privée comme similaire au code NIP secret.</p>
</div>
<div class="sect3 data-line-32">
<h4 id="_clés_privées_et_publiques">Clés privées et publiques</h4>
<div class="paragraph data-line-34">
<p>Une clé privée est simplement un nombre, choisi au hasard. En pratique, et pour faciliter la gestion de nombreuses clés, la plupart des porte-monnaie Bitcoin génèrent une séquence de clés privées à partir d&#8217;une seule <em>graine</em> aléatoire en utilisant un algorithme de dérivation déterministe. En termes simples, un seul nombre aléatoire est utilisé pour produire une séquence reproductible de nombres apparemment aléatoires qui sont utilisés comme clés privées. Cela permet aux utilisateurs de sauvegarder uniquement la graine et de pouvoir <em>dériver</em> toutes les clés dont ils ont besoin à partir de cette graine.</p>
</div>
<div class="paragraph data-line-36">
<p>Bitcoin, comme beaucoup d&#8217;autres cryptomonnaies et blockchains, utilise des <em>courbes elliptiques</em> pour la sécurité. Dans Bitcoin, la multiplication de courbe elliptique sur la courbe elliptique <em>secp256k1</em> est utilisée comme une <em>fonction à sens unique</em>. En termes simples, la nature des mathématiques des courbes elliptiques rend trivial le calcul de la multiplication scalaire d&#8217;un point mais impossible de calculer l&#8217;inverse (division ou logarithme discret).</p>
</div>
<div class="paragraph data-line-38">
<p>Chaque clé privée a une <em>clé publique</em> correspondante, qui est calculée à partir de la clé privée, en utilisant la multiplication scalaire sur la courbe elliptique. En termes simples, avec une clé privée <em>k</em>, nous pouvons la multiplier par une constante <em>G</em> pour produire une clé publique <em>K</em> :</p>
</div>
<ul class="simplelist">
<li><em>K</em> = <em>k</em>*<em>G</em></li>
</ul>
<div class="paragraph data-line-46">
<p>Il est impossible d&#8217;inverser ce calcul. Étant donné une clé publique <em>K</em>, on ne peut pas calculer la clé privée <em>k</em>. La division par <em>G</em> n&#8217;est pas possible en mathématiques des courbes elliptiques. Au lieu de cela, il faudrait essayer toutes les valeurs possibles de <em>k</em> dans un processus exhaustif appelé <em>attaque par force brute</em>. Parce que <em>k</em> est un nombre de 256 bits, épuiser toutes les valeurs possibles avec n&#8217;importe quel ordinateur classique nécessiterait plus de temps et d&#8217;énergie que ce qui est disponible dans cet univers.</p>
</div>
</div>
<div class="sect3 data-line-48">
<h4 id="_hachages">Hachages</h4>
<div class="paragraph data-line-50">
<p>Un autre outil important utilisé largement dans Bitcoin et dans le Lightning Network, sont les <em>fonctions de hachage cryptographiques</em>, et plus particulièrement la fonction de hachage SHA-256.</p>
</div>
<div class="paragraph data-line-52">
<p>Une fonction de hachage, également connue sous le nom de <em>fonction de digest</em>, est une fonction qui prend des données de longueur arbitraire et les transforme en un résultat de longueur fixe, appelé <em>hash</em>, <em>digest</em> ou <em>empreinte digitale</em> (voir <a href="#SHA256">L&#8217;algorithme de hachage cryptographique SHA-256</a>). Il est important de noter que les fonctions de hachage sont des fonctions <em>à sens unique</em>, ce qui signifie que vous ne pouvez pas les inverser et calculer les données d&#8217;entrée à partir de l&#8217;empreinte digitale.</p>
</div>
<div id="SHA256" class="imageblock data-line-56">
<div class="content">
<img src="images/mtln_aa01.png" alt="L&#8217;algorithme de hachage cryptographique SHA-256">
</div>
<div class="title">Figure 1. L&#8217;algorithme de hachage cryptographique SHA-256</div>
</div>
<div class="paragraph pagebreak-before data-line-59">
<p>Par exemple, si nous utilisons un terminal de ligne de commande pour alimenter le texte "Mastering the Lightning Network" dans la fonction SHA-256, elle produira une empreinte comme suit :</p>
</div>
<div class="listingblock data-line-61">
<div class="content">
<pre>$ echo -n "Mastering the Lightning Network" | shasum -a 256

ce86e4cd423d80d054b387aca23c02f5fc53b14be4f8d3ef14c089422b2235de  -</pre>
</div>
</div>
<div class="admonitionblock tip data-line-68">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-69">
<p>L&#8217;entrée utilisée pour calculer un hachage est également appelée <em>préimage</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-72">
<p>La longueur de l&#8217;entrée peut être beaucoup plus grande, bien sûr. Essayons la même chose avec le <a href="https://bitcoin.org/bitcoin.pdf" data-href="https://bitcoin.org/bitcoin.pdf">fichier PDF du livre blanc Bitcoin</a> de Satoshi Nakamoto :</p>
</div>
<div class="listingblock data-line-74">
<div class="content">
<pre>$ wget http://bitcoin.org/bitcoin.pdf
$ cat bitcoin.pdf | shasum -a 256
b1674191a88ec5cdd733e4240a81803105dc412d6c6708d53ab94fc248f4f553  -</pre>
</div>
</div>
<div class="paragraph data-line-80">
<p>Bien que cela prenne plus de temps qu&#8217;une seule phrase, la fonction SHA-256 traite le PDF de 9 pages, le "digérant" en une empreinte digitale de 256 bits.</p>
</div>
<div class="paragraph data-line-82">
<p>Maintenant, à ce stade, vous vous demandez peut-être comment il est possible qu&#8217;une fonction qui digère des données de taille illimitée produise une empreinte unique qui est un nombre de taille fixe ?</p>
</div>
<div class="paragraph data-line-84">
<p>En théorie, puisqu&#8217;il existe un nombre infini de préimages possibles (entrées) et seulement un nombre fini d&#8217;empreintes digitales, il doit y avoir de nombreuses préimages qui produisent la même empreinte digitale de 256 bits. Lorsque deux préimages produisent le même hachage, cela s&#8217;appelle une <em>collision</em>.</p>
</div>
<div class="paragraph data-line-86">
<p>En pratique, un nombre de 256 bits est si grand que vous ne trouverez jamais de collision intentionnellement. Les fonctions de hachage cryptographiques fonctionnent sur la base que la recherche d&#8217;une collision est un effort de force brute qui prend tellement d&#8217;énergie et de temps qu&#8217;il n&#8217;est pratiquement pas possible.</p>
</div>
<div class="paragraph data-line-88">
<p>Les fonctions de hachage cryptographique sont largement utilisées dans une variété d&#8217;applications car elles ont des fonctionnalités utiles. Elles sont :</p>
</div>
<div class="dlist data-line-90">
<dl>
<dt class="hdlist1">Déterministes</dt>
<dd>
<p>La même entrée produit toujours le même hachage.</p>
</dd>
<dt class="hdlist1">Irréversibles</dt>
<dd>
<p>Il n&#8217;est pas possible de calculer la préimage d&#8217;un hachage.</p>
</dd>
<dt class="hdlist1">Anticollisions</dt>
<dd>
<p>Il est infaisable, d&#8217;un point de vue informatique, de trouver deux messages ayant le même hachage.</p>
</dd>
<dt class="hdlist1">Non corrélé</dt>
<dd>
<p>Un petit changement dans l&#8217;entrée produit un changement si important dans la sortie que la sortie semble non corrélée à l&#8217;entrée.</p>
</dd>
<dt class="hdlist1">Uniformes/aléatoires</dt>
<dd>
<p>Une fonction de hachage cryptographique produit des hachages qui sont uniformément répartis sur l&#8217;ensemble de l&#8217;espace de 256 bits des sorties possibles. La sortie d&#8217;un hachage semble être aléatoire, bien qu&#8217;elle ne soit pas vraiment aléatoire.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-100">
<p>En utilisant ces fonctionnalités de hachages cryptographiques, nous pouvons créer des  <span class="keep-together">applications</span> intéressantes :</p>
</div>
<div class="dlist data-line-102">
<dl>
<dt class="hdlist1">Empreintes digitales</dt>
<dd>
<p>Un hachage peut être utilisé pour prendre l&#8217;empreinte d&#8217;un fichier ou d&#8217;un message afin de l&#8217;identifier de manière unique. Les hachages peuvent être utilisés comme identifiants universels de n&#8217;importe quel ensemble de données.</p>
</dd>
<dt class="hdlist1">Preuve d&#8217;intégrité</dt>
<dd>
<p>Une empreinte digitale d&#8217;un fichier ou d&#8217;un message démontre son intégrité car le fichier ou le message ne peut être altéré ou modifié de quelque manière que ce soit sans changer l&#8217;empreinte digitale. Ceci est souvent utilisé pour s&#8217;assurer que le logiciel n&#8217;a pas été altéré avant de l&#8217;installer sur votre ordinateur.</p>
</dd>
<dt class="hdlist1">Engagement/non-répudiation</dt>
<dd>
<p>Vous pouvez vous engager sur une préimage spécifique (par exemple, un nombre ou un message) sans la révéler en publiant son hachage. Plus tard, vous pouvez révéler le secret et tout le monde peut vérifier qu&#8217;il s&#8217;agit de la même chose sur laquelle vous vous êtes engagé plus tôt car elles produisent le hachage publié.</p>
</dd>
<dt class="hdlist1">Proof-of-Work/hash grinding</dt>
<dd>
<p>Vous pouvez utiliser un hachage pour prouver que vous avez effectué un travail de calcul informatique en montrant un motif non aléatoire dans le hachage qui ne peut être produit que par des suppositions répétées au sujet d&#8217;une préimage. Par exemple, le hachage d&#8217;un en-tête de bloc Bitcoin commence par un grand nombre de bits zéro. La seule façon de le produire est de changer une partie de l&#8217;en-tête et de le hacher des milliards de fois jusqu&#8217;à ce qu&#8217;il produise ce motif par hasard.</p>
</dd>
<dt class="hdlist1">Atomicité</dt>
<dd>
<p>Vous pouvez faire d&#8217;une préimage secrète une condition préalable pour dépenser des fonds dans plusieurs transactions liées. Si l&#8217;une des parties révèle la préimage afin de dépenser l&#8217;une des transactions, toutes les autres parties peuvent désormais également dépenser leurs transactions. Aucune ou toutes deviennent dépensables, ce qui permet d&#8217;obtenir une atomicité pour plusieurs transactions.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-112">
<h4 id="_signatures_numériques">Signatures numériques</h4>
<div class="paragraph data-line-114">
<p>La clé privée est utilisée pour créer des signatures nécessaires pour dépenser des bitcoins en prouvant la propriété des fonds utilisés dans une transaction.</p>
</div>
<div class="paragraph data-line-116">
<p>Une <em>signature numérique</em> est un nombre qui est calculé à partir de l&#8217;application de la clé privée à un message spécifique.</p>
</div>
<div class="paragraph data-line-118">
<p>Étant donné un message <em>m</em> et une clé privée <em>k</em>, une fonction de signature <em>F<sub>sign</sub></em> peut produire une signature <em>S</em> :</p>
</div>
<div class="stemblock data-line-121">
<div class="content">
\[$ S = F_{sign}(m, k) $\]
</div>
</div>
<div class="paragraph data-line-125">
<p>Cette signature <em>S</em> peut être vérifiée indépendamment par toute personne disposant de la clé publique <em>K</em> (correspondant à la clé privée <em>k</em>) et du message :</p>
</div>
<div class="stemblock data-line-128">
<div class="content">
\[$ F_{verify}(m, K, S) $\]
</div>
</div>
<div class="paragraph data-line-132">
<p>Si <em>F<sub>verify</sub></em> renvoie un résultat vrai, alors le vérificateur peut confirmer que le message <em>m</em> a été signé par quelqu&#8217;un qui avait accès à la clé privée <em>k</em>. Surtout, la signature numérique prouve la possession de la clé privée <em>k</em> au moment de la signature, sans révéler <em>k</em>.</p>
</div>
<div class="paragraph data-line-134">
<p>Les signatures numériques utilisent un algorithme de hachage cryptographique. La signature est appliquée à un hachage du message, de sorte que le message <em>m</em> est "résumé" à un hachage de longueur fixe <em>H</em>(<em>m</em>) qui sert d&#8217;empreinte digitale.</p>
</div>
<div class="paragraph data-line-136">
<p>En appliquant la signature numérique sur le hachage d&#8217;une transaction, la signature prouve non seulement l&#8217;autorisation, mais "verrouille" également les données de la transaction, garantissant son intégrité. Une transaction signée ne peut pas être modifiée car toute modification entraînerait un hachage différent et invaliderait la signature.</p>
</div>
</div>
<div class="sect3 data-line-138">
<h4 id="_types_de_signatures">Types de signatures</h4>
<div class="paragraph data-line-140">
<p>Les signatures ne sont pas toujours appliquées à l&#8217;ensemble de la transaction. Pour offrir une flexibilité de signature, une signature numérique Bitcoin contient un préfixe appelé type de hachage de signature, qui spécifie quelle partie des données de transaction est incluse dans le hachage. Cela permet à la signature de valider ou de "verrouiller" toutes ou seulement certaines des données de la transaction. Le type de hachage de signature le plus courant est SIGHASH_ALL qui verrouille tout dans la transaction en incluant toutes les données de transaction dans le hachage signé. Par comparaison, SIGHASH_SINGLE verrouille toutes les entrées de transaction, mais une seule sortie (plus d&#8217;informations sur les entrées et les sorties dans la section suivante). Différents types de hachage de signature peuvent être combinés pour produire six "modèles" différents de données de transaction qui sont verrouillés par la signature.</p>
</div>
<div class="paragraph data-line-142">
<p>Plus d&#8217;informations sur les types de hachage de signature peuvent être trouvées dans <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#sighash_types" data-href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch06.asciidoc#sighash_types">la section "Type de hachage de signature" du chapitre 6 de <em>Maîtriser Bitcoin</em>, Deuxième Édition</a>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-144">
<h3 id="_transactions_bitcoin">Transactions Bitcoin</h3>
<div class="paragraph data-line-146">
<p><em>Les transactions</em> sont des structures de données qui encodent le transfert de valeur entre les participants du système bitcoin.</p>
</div>
<div class="sect3 data-line-149">
<h4 id="utxo">Entrées et sorties</h4>
<div class="paragraph data-line-151">
<p>Le bloc de construction fondamental d&#8217;une transaction bitcoin est une sortie de transaction. <em>Les sorties de transaction</em> sont des morceaux indivisibles de monnaie bitcoin, enregistrés sur la blockchain et reconnus comme valides par l&#8217;ensemble du réseau. Une transaction dépense des entrées et crée des sorties. Les <em>entrées</em> de transaction sont simplement des références aux sorties de transactions précédemment enregistrées. De cette façon, chaque transaction dépense les sorties des transactions précédentes et crée de nouvelles sorties (voir <a href="#transaction_structure">Une transaction transfère la valeur des entrées vers les sorties</a>).</p>
</div>
<div id="transaction_structure" class="imageblock data-line-155">
<div class="content">
<img src="images/mtln_aa02.png" alt="entrées et sorties de transactions">
</div>
<div class="title">Figure 2. Une transaction transfère la valeur des entrées vers les sorties</div>
</div>
<div class="paragraph data-line-157">
<p>Les nœuds complets Bitcoin suivent toutes les sorties disponibles et dépensables, appelées <em>sorties de transaction non dépensées</em> (UTXO). La collection de tous les UTXO est connue sous le nom d&#8217;ensemble d&#8217;UTXO (UTXO set), qui compte actuellement des millions d&#8217;UTXO. L&#8217;UTXO set augmente à mesure que de nouveaux UTXO sont créés et diminue lorsque les UTXO sont consommés. Chaque transaction représente un changement (transition d&#8217;état) dans l&#8217;UTXO set, en consommant un ou plusieurs UTXO comme <em>entrées de transaction</em> et en créant un ou plusieurs UTXO comme <em>sorties de transaction</em>.</p>
</div>
<div class="paragraph data-line-159">
<p>Par exemple, supposons qu&#8217;une utilisatrice Alice dispose d&#8217;un UTXO de 100 000 satoshis qu&#8217;elle peut dépenser. Alice peut payer Bob 100 000 satoshis en construisant une transaction avec une entrée (consommant son entrée existante de 100 000 satoshis) et une sortie qui "paye" Bob 100 000 satoshis. Maintenant, Bob a un UTXO de 100 000 satoshis qu&#8217;il peut dépenser, créant une nouvelle transaction qui consomme ce nouvel UTXO et le dépense à un autre UTXO en paiement à un autre utilisateur, et ainsi de suite (voir <a href="#alice_100ksat_to_bob">Alice paie 100 000 satoshis à Bob</a>).</p>
</div>
<div id="alice_100ksat_to_bob" class="imageblock data-line-163">
<div class="content">
<img src="images/mtln_aa03.png" alt="Alice paie 100 000 satoshis à Bob">
</div>
<div class="title">Figure 3. Alice paie 100 000 satoshis à Bob</div>
</div>
<div class="paragraph data-line-165">
<p>Une sortie de transaction peut avoir une valeur arbitraire (entière) libellée en satoshis. Tout comme les dollars peuvent être divisés jusqu&#8217;à deux décimales sous forme de cents, le bitcoin peut être divisé jusqu&#8217;à huit décimales sous forme de satoshis. Bien qu&#8217;une sortie puisse avoir n&#8217;importe quelle valeur arbitraire, une fois créée, elle est indivisible. Il s&#8217;agit d&#8217;une caractéristique importante des sorties qui doit être soulignée : les sorties sont des unités de valeur discrètes et indivisibles, libellées en satoshis entiers. Une sortie non dépensée ne peut être consommée dans son intégralité que par une transaction.</p>
</div>
<div class="paragraph data-line-167">
<p>Et si Alice veut payer 50 000 satoshis à Bob, mais n&#8217;a qu&#8217;un UTXO indivisible de 100 000 satoshis ? Alice devra créer une transaction qui consomme (en entrée) l&#8217;UTXO de 100 000 satoshis et qui a deux sorties : une payant 50 000 satoshis à Bob et une payant 50 000 satoshis <em>de retour</em> à Alice comme "change" (voir <a href="#alice_50ksat_to_bob_change">Alice paie 50 000 sats à Bob et 50 000 sats à elle-même comme monnaie</a>).</p>
</div>
<div id="alice_50ksat_to_bob_change" class="imageblock data-line-171">
<div class="content">
<img src="images/mtln_aa04.png" alt="Alice paie 50 000 satoshis à Bob et 50 000 satoshis à elle-même comme monnaie">
</div>
<div class="title">Figure 4. Alice paie 50 000 sats à Bob et 50 000 sats à elle-même comme monnaie</div>
</div>
<div class="admonitionblock tip data-line-174">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-175">
<p>Il n&#8217;y a rien de spécial à propos d&#8217;une sortie de monnaie ou de manière de la distinguer de toute autre sortie. Il n&#8217;est pas nécessaire que ce soit la dernière sortie. Il peut y avoir plus d&#8217;une sortie de monnaie, ou aucune sortie de monnaie. Seul le créateur de la transaction sait quelles sorties sont destinées aux autres et quelles sorties sont destinées aux adresses qu&#8217;ils possèdent et donc « de monnaie ».</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-178">
<p>De même, si Alice veut payer 85 000 satoshis à Bob mais dispose de deux UTXO de 50 000 satoshis, elle doit créer une transaction avec deux entrées (consommant à la fois ses UTXO de 50 000 satoshis) et deux sorties, en payant à Bob 85 000 et renvoyant 15 000 satoshis à elle-même comme monnaie (voir <a href="#tx_twoin_twoout">Alice utilise deux entrées de 50k pour payer 85k sats à Bob et 15k sats à elle-même comme monnaie</a>).</p>
</div>
<div id="tx_twoin_twoout" class="imageblock data-line-182">
<div class="content">
<img src="images/mtln_aa05.png" alt="Alice utilise deux entrées de 50k pour payer 85k sats à Bob et 15k sats à elle-même comme monnaie">
</div>
<div class="title">Figure 5. Alice utilise deux entrées de 50k pour payer 85k sats à Bob et 15k sats à elle-même comme monnaie</div>
</div>
<div class="paragraph data-line-184">
<p>Les illustrations et exemples précédents montrent comment une transaction Bitcoin combine (dépense) une ou plusieurs entrées et crée une ou plusieurs sorties. Une transaction peut avoir des centaines voire des milliers d&#8217;entrées et de sorties.</p>
</div>
<div class="admonitionblock tip data-line-187">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-188">
<p>Bien que les transactions créées par le Lightning Network aient plusieurs sorties, elles n&#8217;ont pas de sortie de "monnaie" en soi, car la totalité du solde disponible d&#8217;un canal est répartie entre les deux partenaires du canal.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-191">
<h4 id="_chaînes_de_transactions">Chaînes de transactions</h4>
<div class="paragraph data-line-193">
<p>Chaque sortie peut être utilisée comme entrée dans une transaction ultérieure. Ainsi, par exemple, si Bob décide de dépenser 10 000 satoshi dans une transaction pour payer Chan, et que Chan dépense 4 000 satoshi pour payer Dina, cela se déroulera comme indiqué dans &lt;&lt;tx_chain&gt; &gt;.</p>
</div>
<div class="paragraph data-line-195">
<p>Une sortie est considérée comme <em>dépensée</em> si elle est référencée comme entrée dans une autre transaction enregistrée sur la blockchain. Une sortie est considérée comme <em>non dépensée</em> (et disponible pour être dépensée) si aucune transaction enregistrée ne la référence.</p>
</div>
<div class="paragraph data-line-197">
<p>Le seul type de transaction qui n&#8217;a pas d&#8217;entrées est une transaction spéciale créée par les mineurs Bitcoin appelée <em>transaction coinbase</em>. La transaction coinbase n&#8217;a que des sorties et pas d&#8217;entrées car elle crée de nouveaux bitcoins à partir du minage. Toute autre transaction utilise une ou plusieurs sorties précédemment enregistrées comme entrées.</p>
</div>
<div class="paragraph data-line-199">
<p>Étant donné que les transactions sont enchaînées, si vous choisissez une transaction au hasard, vous pouvez suivre l&#8217;une de ses entrées en arrière jusqu&#8217;à la transaction précédente qui l&#8217;a créée. Si vous continuez à faire cela, vous finirez par atteindre une transaction coinbase avec laquelle le bitcoin a été miné pour la première fois.</p>
</div>
<div id="tx_chain" class="imageblock data-line-203">
<div class="content">
<img src="images/mtln_aa06.png" alt="Alice paie Bob qui paie Chan qui paie Dina">
</div>
<div class="title">Figure 6. Alice paie Bob qui paie Chan qui paie Dina</div>
</div>
</div>
<div class="sect3 data-line-206">
<h4 id="_txid_identifiants_de_transaction">TxID : Identifiants de transaction</h4>
<div class="paragraph data-line-208">
<p>Chaque transaction dans le système Bitcoin est identifiée par un identifiant unique (en supposant l&#8217;existence de BIP-0030), appelé <em>ID de transaction</em> ou <em>TxID</em> en abrégé. Pour produire un identifiant unique, nous utilisons la fonction de hachage cryptographique SHA-256 pour produire un hachage des données de la transaction. Cette "empreinte digitale" sert d&#8217;identifiant universel. Une transaction peut être référencée par son ID de transaction, et une fois qu&#8217;une transaction est enregistrée sur la blockchain Bitcoin, chaque nœud du réseau Bitcoin sait que cette transaction est valide.</p>
</div>
<div class="paragraph data-line-210">
<p>Par exemple, un ID de transaction peut ressembler à ceci :</p>
</div>
<div class="listingblock data-line-213">
<div class="title">Un ID de transaction produit à partir du hachage des données de transaction</div>
<div class="content">
<pre>e31e4e214c3f436937c74b8663b3ca58f7ad5b3fce7783eb84fd9a5ee5b9a54c</pre>
</div>
</div>
<div class="paragraph data-line-217">
<p>Il s&#8217;agit d&#8217;une véritable transaction (créée à titre d&#8217;exemple pour le livre <em>Maîtriser Bitcoin</em>) que l&#8217;on peut trouver sur la blockchain Bitcoin. Essayez de la trouver en saisissant ce TxID dans un explorateur de blocs :</p>
</div>
<ul class="simplelist">
<li><a href="https://blockstream.info/tx/e31e4e214c3f436937c74b8663b3ca58f7ad5b3fce7783eb84fd9a5ee5b9a54c"><em>https://blockstream.info/tx/e31e4e214c3f436937c74b8663b3ca58f7ad5b3fce7783eb84fd9a5ee5b9a54c</em></a></li></ul>
<div class="paragraph data-line-224">
<p>ou utilisez le lien court (sensible à la casse) :</p>
</div>
<ul class="simplelist">
<li><a href="http://bit.ly/AliceTx"><em>http://bit.ly/AliceTx</em></a></li>
</ul>
</div>
<div class="sect3 data-line-232">
<h4 id="_points_de_sortie_identificateurs_de_sortie">Points de sortie : identificateurs de sortie</h4>
<div class="paragraph data-line-234">
<p>Comme chaque transaction a un identifiant unique, nous pouvons également identifier une sortie de transaction au sein de cette transaction de manière unique par référence au TxID et au numéro d&#8217;index de sortie. La première sortie d&#8217;une transaction est l&#8217;index de sortie 0, la deuxième sortie est l&#8217;index de sortie 1, et ainsi de suite. Un identifiant de sortie est communément appelé <em>point de sortie</em>.</p>
</div>
<div class="paragraph data-line-236">
<p>Par convention, nous écrivons un point de sortie sous la forme du TxID, deux-points et le numéro d&#8217;index de sortie :</p>
</div>
<div class="listingblock data-line-239">
<div class="title">Un point de sortie : identification d&#8217;une sortie par TxID et numéro d&#8217;index</div>
<div class="content">
<pre>7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18:0</pre>
</div>
</div>
<div class="paragraph data-line-243">
<p>Les identificateurs de sortie (ou points de sortie) sont les mécanismes qui relient les transactions dans une chaîne. Chaque entrée de transaction est une référence à une sortie spécifique d&#8217;une transaction précédente. Cette référence est un point de sortie : un TxID et un numéro d&#8217;index de sortie. Ainsi, une transaction "dépense" une sortie spécifique (par le numéro d&#8217;index) d&#8217;une transaction spécifique (par le TxID) pour créer de nouvelles sorties qui peuvent elles-mêmes être dépensées par référence au point de sortie.</p>
</div>
<div class="paragraph data-line-245">
<p><a href="#tx_chain_vout">Les entrées de transaction font référence aux points de sortie formant une chaîne</a> présente la chaîne de transactions d&#8217;Alice à Bob à Chan à Dina, cette fois avec des points de sortie dans chacune des entrées.</p>
</div>
<div id="tx_chain_vout" class="imageblock data-line-249">
<div class="content">
<img src="images/mtln_aa07.png" alt="Les entrées de transaction font référence aux points de sortie formant une chaîne">
</div>
<div class="title">Figure 7. Les entrées de transaction font référence aux points de sortie formant une chaîne</div>
</div>
<div class="paragraph data-line-251">
<p>L&#8217;entrée dans la transaction de Bob fait référence à la transaction d&#8217;Alice (par TxID) et à la sortie indexée 0.</p>
</div>
<div class="paragraph data-line-253">
<p>L&#8217;entrée dans la transaction de Chan fait référence au TxID de la transaction de Bob et à la première sortie indexée, car le paiement à Chan est la sortie #1. Dans le paiement de Bob à Chan, la monnaie de Bob est la sortie #0.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
<div class="paragraph data-line-255">
<p>Maintenant, si nous regardons le paiement d&#8217;Alice à Bob, nous pouvons voir qu&#8217;Alice dépense un point de sortie qui était la troisième sortie (indice de sortie #2) dans une transaction dont l&#8217;ID est 6a5f1b3[&#8230;&#8203;]. Nous ne voyons pas cette transaction référencée dans le diagramme, mais nous pouvons déduire ces détails du point de sortie.</p>
</div>
</div>
</div>
<div class="sect2 data-line-257">
<h3 id="_bitcoin_script">Bitcoin Script</h3>
<div class="paragraph data-line-259">
<p>Le dernier élément de Bitcoin nécessaire pour compléter notre compréhension est le langage de script qui contrôle l&#8217;accès aux points de sortie. Jusqu&#8217;à présent, nous avons simplifié la description en disant "Alice signe la transaction pour payer Bob". Dans les coulisses, cependant, il existe une certaine complexité cachée qui permet de mettre en œuvre des conditions de dépenses plus complexes. La condition de dépense la plus simple et la plus courante est "présenter une signature correspondant à la clé publique suivante". Une condition de dépense comme celle-ci est enregistrée dans chaque sortie en tant que <em>script de verrouillage</em> écrit dans un langage de script appelé <em>Bitcoin Script</em>.</p>
</div>
<div class="paragraph data-line-261">
<p>Bitcoin Script est un langage de script basé sur une pile extrêmement simple. Il ne contient pas de boucles ou de récursivité et est donc <em>Turing incomplet</em> (ce qui signifie qu&#8217;il ne peut pas exprimer une complexité arbitraire et a une exécution prévisible). Ceux qui sont familiers avec le (aujourd&#8217;hui ancien) langage de programmation FORTH reconnaîtront la syntaxe et le style.</p>
</div>
<div class="sect3 data-line-263">
<h4 id="_exécution_de_bitcoin_script">Exécution de Bitcoin Script</h4>
<div class="paragraph data-line-265">
<p>En termes simples, le système Bitcoin évalue Bitcoin Script en exécutant le script sur une pile ; si le résultat final est TRUE, il considère la condition de dépense satisfaite et la transaction valide.</p>
</div>
<div class="paragraph data-line-267">
<p>Regardons un exemple très simple de Bitcoin Script, qui additionne les nombres 2 et 3 puis compare le résultat au nombre 5 :</p>
</div>
<div class="listingblock data-line-269">
<div class="content">
<pre>2 3 ADD 5 EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-273">
<p>Dans <a href="#figa08">Exemple d&#8217;exécution de Bitcoin Script</a>, on voit comment ce script est exécuté (de gauche à droite).</p>
</div>
<div id="figa08" class="imageblock data-line-277">
<div class="content">
<img src="images/mtln_aa08.png" alt="Exemple d&#8217;exécution de Bitcoin Script">
</div>
<div class="title">Figure 8. Exemple d&#8217;exécution de Bitcoin Script</div>
</div>
</div>
<div class="sect3 pagebreak-before less_space data-line-280">
<h4 id="_verrouillage_et_déverrouillage_de_scripts">Verrouillage et déverrouillage de scripts</h4>
<div class="paragraph data-line-282">
<p>Bitcoin Script est composé de deux parties :</p>
</div>
<div class="dlist data-line-284">
<dl>
<dt class="hdlist1">Scripts de verrouillage</dt>
<dd>
<p>Ceux-ci sont intégrés dans les sorties de transaction, définissant les conditions qui doivent être réalisées pour dépenser cette sortie. Par exemple, le porte-monnaie d&#8217;Alice ajoute un script de verrouillage à la sortie payant Bob, qui définit la condition selon laquelle la signature de Bob est requise pour le dépenser.</p>
</dd>
<dt class="hdlist1">Scripts de déverrouillage</dt>
<dd>
<p>Ceux-ci sont intégrés dans les entrées de transaction, réalisant les conditions définies par le script de verrouillage de la sortie référencée. Par exemple, Bob peut déverrouiller la sortie précédente en fournissant un script de déverrouillage contenant une signature numérique.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-288">
<p>En utilisant un modèle simplifié, pour la validation, le script de déverrouillage et le script de verrouillage sont concaténés et exécutés (P2SH et SegWit sont des exceptions). Par exemple, si quelqu&#8217;un a verrouillé une sortie de transaction avec le script de verrouillage "3 ADD 5 EQUAL", nous pourrions le passer avec le script de déverrouillage "2" dans une entrée de transaction. Toute personne validant cette transaction concatènerait notre script de déverrouillage (2) et le script de verrouillage (3 ADD 5 EQUAL) et exécuterait le résultat via le moteur d&#8217;exécution Bitcoin Script. Ils obtiendraient TRUE et nous pourrions dépenser la sortie.</p>
</div>
<div class="paragraph data-line-290">
<p>De toute évidence, cet exemple simplifié ferait un très mauvais choix pour verrouiller une sortie Bitcoin réelle car il n&#8217;y a pas de secret, juste de l&#8217;arithmétique de base. N&#8217;importe qui pourrait dépenser la sortie en fournissant la réponse "2". La plupart des scripts de verrouillage nécessitent donc de démontrer la connaissance d&#8217;un secret.</p>
</div>
</div>
<div class="sect3 data-line-292">
<h4 id="_verrouillage_à_une_clé_publique_signature">Verrouillage à une clé publique (Signature)</h4>
<div class="paragraph data-line-294">
<p>La forme la plus simple d&#8217;un script de verrouillage est celle qui nécessite une signature. Considérons la transaction d&#8217;Alice qui paie à Bob 50 000 satoshis. La sortie créée par Alice pour payer Bob aura un script de verrouillage nécessitant la signature de Bob et ressemblera à ceci :</p>
</div>
<div id="bob_locking_script" class="listingblock data-line-298">
<div class="title">Un script de verrouillage qui nécessite une signature numérique créée avec la clé privée de Bob</div>
<div class="content">
<pre>&lt;Bob Public Key&gt; CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-302">
<p>L&#8217;opérateur <code>CHECKSIG</code> prend deux éléments de la pile : une signature et une clé publique. Comme vous pouvez le voir, la clé publique de Bob est dans le script de verrouillage, donc ce qui manque est la signature correspondant à cette clé publique. Ce script de verrouillage ne peut être dépensé que par Bob, car seul Bob possède la clé privée correspondante nécessaire pour produire une signature numérique correspondant à la clé publique.</p>
</div>
<div class="paragraph data-line-304">
<p>Pour déverrouiller ce script de verrouillage, Bob fournirait un script de déverrouillage contenant uniquement sa signature numérique :</p>
</div>
<div id="bob_unlocking_script" class="listingblock data-line-308">
<div class="title">Un script de déverrouillage contenant (uniquement) une signature numérique créée avec la clé privée de Bob</div>
<div class="content">
<pre>&lt;Bob Signature&gt;</pre>
</div>
</div>
<div class="paragraph data-line-312">
<p>Dans <a href="#locking_unlocking_chain">Une chaîne de transaction montrant le script de verrouillage (sortie) et le script de déverrouillage (entrée)</a> vous pouvez voir le script de verrouillage dans la transaction d&#8217;Alice (dans la sortie qui paie Bob) et le script de déverrouillage (dans l&#8217;entrée qui dépense cette sortie) dans la transaction de Bob.</p>
</div>
<div id="locking_unlocking_chain" class="imageblock data-line-316">
<div class="content">
<img src="images/mtln_aa09.png" alt="Une chaîne de transaction montrant le script de verrouillage (sortie) et le script de déverrouillage (entrée)">
</div>
<div class="title">Figure 9. Une chaîne de transaction montrant le script de verrouillage (sortie) et le script de déverrouillage (entrée)</div>
</div>
<div class="paragraph data-line-318">
<p>Pour valider la transaction de Bob, un nœud Bitcoin ferait ce qui suit :</p>
</div>
<div class="olist arabic data-line-320">
<ol class="arabic">
<li class="data-line-320">
<p>Extraire le script de déverrouillage de l&#8217;entrée (&lt;Bob Signature&gt;).</p>
</li>
<li class="data-line-321">
<p>Rechercher le point de sortie qu&#8217;il tente de dépenser (a643e37...3213:0). Ceci est la transaction d&#8217;Alice et se trouverait sur la blockchain.</p>
</li>
<li class="data-line-322">
<p>Extraire le script de verrouillage de ce point de sortie (&lt;Bob PubKey&gt; CHECKSIG).</p>
</li>
<li class="data-line-323">
<p>Les concaténer en un seul script, en plaçant le script de déverrouillage devant le script de verrouillage (&lt;Bob Signature&gt; &lt;Bob PubKey&gt; CHECKSIG).</p>
</li>
<li class="data-line-324">
<p>Exécuter ce script sur le moteur d&#8217;exécution Bitcoin Script pour voir quel résultat est produit.</p>
</li>
<li class="data-line-325">
<p>Si le résultat est TRUE, déduire que la transaction de Bob est valide car elle a pu réaliser la condition de dépense pour dépenser ce point de sortie.</p>
</li>
</ol>
</div>
</div>
<div class="sect3 data-line-327">
<h4 id="_verrouillage_sur_un_hachage_secret">Verrouillage sur un hachage (Secret)</h4>
<div class="paragraph data-line-329">
<p>Un autre type de script de verrouillage, utilisé dans le Lightning Network, est un <em>hashlock</em>. Pour le déverrouiller, vous devez connaître le secret <em>préimage</em> du hachage.</p>
</div>
<div class="paragraph data-line-331">
<p>Pour démontrer cela, demandons à Bob de générer un nombre aléatoire R et de le garder secret :</p>
</div>
<div class="listingblock data-line-333">
<div class="content">
<pre>R = 1833462189</pre>
</div>
</div>
<div class="paragraph pagebreak-before data-line-338">
<p>Maintenant, Bob calcule le hachage SHA-256 de ce nombre :</p>
</div>
<div class="listingblock data-line-340">
<div class="content">
<pre>H = SHA256(R) =&gt;
H = SHA256(1833462189) =&gt;
H = 0ffd8bea4abdb0deafd6f2a8ad7941c13256a19248a7b0612407379e1460036a</pre>
</div>
</div>
<div class="paragraph data-line-346">
<p>Maintenant, Bob donne le hachage H que nous avons calculé précédemment à Alice, mais garde secret le nombre R. Rappelez-vous qu&#8217;en raison des propriétés des hachages cryptographiques, Alice ne peut pas "inverser" le calcul du hachage et deviner le nombre R.</p>
</div>
<div class="paragraph data-line-348">
<p>Alice crée une sortie payant 50 000 satoshis avec le script de verrouillage :</p>
</div>
<div class="listingblock data-line-350">
<div class="content">
<pre>HASH256 H EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-354">
<p>dans lequel H est la valeur de hachage réelle (0ffd8...036a) que Bob a donnée à Alice.</p>
</div>
<div class="paragraph data-line-356">
<p>Expliquons ce script :</p>
</div>
<div class="paragraph data-line-358">
<p>L&#8217;opérateur HASH256 extrait une valeur de la pile et calcule le hachage SHA-256 de cette valeur. Ensuite, il pousse le résultat sur la pile.</p>
</div>
<div class="paragraph data-line-360">
<p>La valeur H est poussée sur la pile, puis l&#8217;opérateur EQUAL vérifie si les deux valeurs sont identiques et pousse TRUE ou FALSE sur la pile en conséquence.</p>
</div>
<div class="paragraph data-line-362">
<p>Par conséquent, ce script de verrouillage ne fonctionnera que s&#8217;il est combiné avec un script de déverrouillage contenant R, de sorte qu&#8217;une fois concaténé, nous avons :</p>
</div>
<div class="listingblock data-line-364">
<div class="content">
<pre>R HASH256 H EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-368">
<p>Seul Bob connaît R, donc seul Bob peut produire une transaction avec un script de déverrouillage révélant la valeur secrète R.</p>
</div>
<div class="paragraph data-line-370">
<p>Fait intéressant, Bob peut donner la valeur R à n&#8217;importe qui d&#8217;autre, qui peut ensuite dépenser ce Bitcoin. Cela rend la valeur secrète R presque comme un "bon" bitcoin, puisque toute personne qui la possède peut dépenser la sortie créée par Alice. Nous verrons en quoi cette propriété est utile pour le Lightning Network !</p>
</div>
</div>
<div class="sect3 data-line-373">
<h4 id="multisig">Scripts multisignatures</h4>
<div class="paragraph data-line-375">
<p>Le langage Bitcoin Script fournit un bloc de construction multisignature (primitif), qui peut être utilisé pour mettre en place des services d&#8217;entiercement (escrow) et des configurations complexes de propriété entre plusieurs parties prenantes. Un arrangement qui nécessite plusieurs signatures pour dépenser des Bitcoin est appelé un <em>schéma multisignature, plus précisément spécifié comme un schéma _K-de-N</em>, où :</p>
</div>
<div class="ulist data-line-377">
<ul>
<li class="data-line-377">
<p><em>N</em> est le nombre total de signataires identifiés dans le schéma multisignature, et</p>
</li>
<li class="data-line-378">
<p><em>K</em> est le <em>quorum</em> ou <em>seuil</em> : le nombre minimum de signatures pour autoriser les dépenses.</p>
</li>
</ul>
</div>
<div class="paragraph pagebreak-before data-line-381">
<p>Le script pour une multisignature <em>K</em>-de-<em>N</em> est :</p>
</div>
<div class="listingblock data-line-383">
<div class="content">
<pre>K &lt;PubKey1&gt; &lt;PubKey2&gt; ... &lt;PubKeyN&gt; N CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-387">
<p>où <em>N</em> est le nombre total de clés publiques répertoriées (Clé Publique 1 à Clé Publique <em>N</em>) et <em>K</em> est le seuil de signatures requises pour dépenser la sortie.</p>
</div>
<div class="paragraph data-line-389">
<p>Le Lightning Network utilise un schéma multisignature 2-de-2 pour créer un canal de paiement. Par exemple, un canal de paiement entre Alice et Bob serait construit sur une multisignature 2-de-2 comme ceci :</p>
</div>
<div class="listingblock data-line-391">
<div class="content">
<pre>2 &lt;PubKey Alice&gt; &lt;PubKey Bob&gt; 2 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-395">
<p>Le script de verrouillage précédent peut se contenter d&#8217;un script de déverrouillage contenant une paire de signatures:<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
<div class="listingblock data-line-397">
<div class="content">
<pre>0 &lt;Sig Alice&gt; &lt;Sig Bob&gt;</pre>
</div>
</div>
<div class="paragraph data-line-400">
<p>Les deux scripts ensemble formeraient le script de validation combiné :</p>
</div>
<div class="listingblock data-line-402">
<div class="content">
<pre>0 &lt;Sig Alice&gt; &lt;Sig Bob&gt; 2 &lt;PubKey Alice&gt; &lt;PubKey Bob&gt; 2 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-406">
<p>Un script de verrouillage multisignature peut être représenté par une adresse Bitcoin, encodant le hachage du script de verrouillage. Par exemple, la transaction de financement initiale d&#8217;un canal de paiement Lightning est une transaction qui paie à une adresse qui encode un script de verrouillage d&#8217;un multisig 2-de-2 des deux partenaires de canal.</p>
</div>
</div>
<div class="sect3 data-line-408">
<h4 id="_scripts_timelock">Scripts Timelock</h4>
<div class="paragraph data-line-410">
<p>Un autre bloc de construction important qui existe dans Bitcoin et qui est largement utilisé dans le Lightning Network est un <em>timelock</em>. Un timelock est une restriction de dépenses qui nécessite qu&#8217;un certain temps ou une certaine hauteur de bloc se soit passé avant que les dépenses ne soient autorisées. C&#8217;est un peu comme un chèque postdaté tiré d&#8217;un compte bancaire qui ne peut être encaissé avant la date du chèque.</p>
</div>
<div class="paragraph data-line-412">
<p>Bitcoin a deux niveaux de timelocks : les timelocks au niveau de la transaction et les timelocks au niveau de la sortie.</p>
</div>
<div class="paragraph data-line-414">
<p>Un <em>timelock au niveau de la transaction</em> est enregistré dans le champ <code>nLockTime</code> de la transaction et empêche l&#8217;acceptation de la totalité de la transaction avant que le timelock ne soit passé. Les timelocks au niveau des transactions sont le mécanisme de timelock le plus couramment utilisé dans Bitcoin aujourd&#8217;hui.</p>
</div>
<div class="paragraph data-line-416">
<p>Un <em>timelock au niveau de la sortie</em> est créé par un opérateur de script. Il existe deux types de timelocks de sortie : les timelocks absolus et les timelocks relatifs.</p>
</div>
<div class="paragraph data-line-418">
<p>Les <em>timelocks absolus</em> au niveau de la sortie sont implémentés par l&#8217;opérateur CHECKLOCKTIMEVERIFY, qui est souvent abrégé dans la conversation par <em>CLTV</em>. Les timelocks absolus implémentent une contrainte de temps avec un horodatage (timestamp) absolu ou une hauteur de bloc, exprimant l&#8217;équivalent de "non dépensable avant le bloc 800 000".</p>
</div>
<div class="paragraph data-line-420">
<p>Les <em>timelocks relatifs</em> au niveau de la sortie sont implémentés par l&#8217;opérateur CHECKSEQUENCEVERIFY, souvent abrégé en conversation par <em>CSV</em>. Les timelocks relatifs implémentent une contrainte de dépenses relative à la confirmation de la transaction, exprimant l&#8217;équivalent de "ne peut pas être dépensé avant 1 024 blocs après confirmation".</p>
</div>
</div>
<div class="sect3 data-line-423">
<h4 id="conditional_scripts">Scripts avec plusieurs conditions</h4>
<div class="paragraph data-line-425">
<p>Une  des fonctionnalités les plus puissantes de Bitcoin Script est le contrôle de flux, également connu sous le nom de clauses conditionnelles. Vous êtes probablement familiarisé avec le contrôle de flux dans divers langages de programmation qui utilisent la construction IF...THEN...ELSE. Les clauses conditionnelles Bitcoin sont un peu différentes, mais sont essentiellement la même construction.</p>
</div>
<div class="paragraph data-line-427">
<p>À un niveau de base, les opcodes conditionnels bitcoin nous permettent de construire un script de verrouillage qui a deux façons d&#8217;être déverrouillé, en fonction d&#8217;un résultat TRUE/FALSE évaluant une condition logique. Par exemple, si x est TRUE, le script de verrouillage est A ELSE (sinon) le script de verrouillage est B.</p>
</div>
<div class="paragraph data-line-429">
<p>De plus, les expressions conditionnelles bitcoin peuvent être <em>imbriquées</em> indéfiniment, ce qui signifie qu&#8217;une clause conditionnelle peut en contenir une autre, qui en contient une autre, etc. Le contrôle de flux Bitcoin Script peut être utilisé pour construire des scripts très complexes avec des centaines voire des milliers de chemins d&#8217;exécution possibles. Il n&#8217;y a pas de limite à l&#8217;imbrication, mais les règles de consensus imposent une limite à la taille maximale, en octets, d&#8217;un script.</p>
</div>
<div class="paragraph data-line-431">
<p>Bitcoin implémente le contrôle de flux à l&#8217;aide des opcodes IF, ELSE, ENDIF et NOTIF. De plus, les expressions conditionnelles peuvent contenir des opérateurs booléens tels que BOOLAND, <span class="keep-together"><code>BOOLOR</code></span> et NOT.</p>
</div>
<div class="paragraph data-line-433">
<p>À première vue, vous pouvez trouver les scripts de contrôle de flux de Bitcoin déroutants. En effet, Bitcoin Script est un langage à pile. De la même manière que l&#8217;opération arithmétique \(1 + 1\) regarde "en arrière" lorsqu&#8217;elle est exprimée dans Bitcoin Script comme 1 1 ADD, les clauses de contrôle de flux sur
Bitcoin regardent également "en arrière".</p>
</div>
<div class="paragraph data-line-436">
<p>Dans la plupart des langages de programmation traditionnels (procéduraux), le contrôle de flux ressemble à ceci :</p>
</div>
<div class="listingblock data-line-439">
<div class="title">Pseudo-code de contrôle de flux dans la plupart des langages de programmation</div>
<div class="content">
<pre>si (condition):
  code à exécuter lorsque la condition est vraie
sinon:
  code à exécuter lorsque la condition est fausse
code à exécuter dans les deux cas</pre>
</div>
</div>
<div class="paragraph data-line-447">
<p>Dans un langage basé sur une pile comme Bitcoin Script, la condition logique vient <em>avant</em> le IF, ce qui le fait regarder "en arrière", comme ceci :</p>
</div>
<div class="listingblock data-line-450">
<div class="title">Contrôle de flux Bitcoin Script</div>
<div class="content">
<pre>condition
IF
  code à exécuter lorsque la condition est vraie
ELSE
  code à exécuter lorsque la condition est fausse
ENDIF
code à exécuter dans les deux cas</pre>
</div>
</div>
<div class="paragraph data-line-460">
<p>Lors de la lecture du Bitcoin Script, rappelez-vous que la condition évaluée vient <em>avant</em> l&#8217;opcode IF.</p>
</div>
</div>
<div class="sect3 data-line-462">
<h4 id="_utilisation_du_contrôle_de_flux_dans_les_scripts">Utilisation du contrôle de flux dans les scripts</h4>
<div class="paragraph data-line-464">
<p>Une utilisation très courante du contrôle de flux dans Bitcoin Script consiste à construire un script de verrouillage qui offre plusieurs chemins d&#8217;exécution, chacun une manière différente de réclamer l&#8217;UTXO.</p>
</div>
<div class="paragraph data-line-466">
<p>Regardons un exemple simple, où nous avons deux signataires, Alice et Bob, et l&#8217;un ou l&#8217;autre est en mesure de réclamer. Avec le multisig, cela serait exprimé sous la forme d&#8217;un script multisig 1-de-2. Pour les besoins de la démonstration, nous ferons la même chose avec une clause IF :</p>
</div>
<div class="listingblock data-line-468">
<div class="content">
<pre>IF
&lt;Pubkey d'Alice&gt;CHECKSIG
ELSE
&lt;Pubkey de Bob&gt; CHECKSIG
ENDIF</pre>
</div>
</div>
<div class="paragraph data-line-476">
<p>En regardant ce script de verrouillage, vous vous demandez peut-être : "Où est la condition ? Il n&#8217;y a rien avant la clause IF !"</p>
</div>
<div class="paragraph data-line-478">
<p>La condition ne fait pas partie du script de verrouillage. Au lieu de cela, la condition sera <em>offerte dans le script de déverrouillage</em>, permettant à Alice et Bob de "choisir" le chemin d&#8217;exécution qu&#8217;ils souhaitent.</p>
</div>
<div class="paragraph data-line-480">
<p>Alice réclame cela avec le script de déverrouillage :</p>
</div>
<div class="listingblock data-line-481">
<div class="content">
<pre>&lt;Sign. d'Alice&gt; 1</pre>
</div>
</div>
<div class="paragraph data-line-485">
<p>Le 1 à la fin sert de condition (TRUE) qui fera que la clause IF exécutera le premier chemin de réclamation pour lequel Alice a une signature.</p>
</div>
<div class="paragraph data-line-487">
<p>Pour que Bob puisse réclamer cela, il devrait choisir le deuxième chemin d&#8217;exécution en donnant une valeur FALSE à la clause IF :</p>
</div>
<div class="listingblock data-line-489">
<div class="content">
<pre>&lt;Sign. de Bob&gt; 0</pre>
</div>
</div>
<div class="paragraph data-line-493">
<p>Le script de déverrouillage de Bob place un 0 sur la pile, ce qui oblige la clause IF à exécuter le deuxième script (ELSE), qui nécessite la signature de Bob.</p>
</div>
<div class="paragraph data-line-495">
<p>Étant donné que chacune des deux conditions nécessite également une signature, Alice ne peut pas utiliser la deuxième clause et Bob ne peut pas utiliser la première clause ; ils n&#8217;ont pas les signatures nécessaires pour ça !</p>
</div>
<div class="paragraph data-line-497">
<p>Et comme les flux conditionnels peuvent être imbriqués, il en va de même pour les valeurs TRUE / FALSE dans le script de déverrouillage, pour naviguer dans un chemin complexe de conditions.</p>
</div>
<div class="paragraph data-line-499">
<p>Dans <a href="#htlc_script_example">Un script complexe utilisé dans le Lightning Network</a> vous pouvez voir un exemple du type de script complexe utilisé dans le Lightning Network, avec plusieurs conditions..<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup> Les scripts utilisés dans le Lightning Network sont hautement optimisés et compacts, afin de minimiser l&#8217;empreinte sur la chaîne, ainsi ils ne sont pas faciles à lire et à comprendre. Néanmoins, voyez si vous pouvez identifier certains des concepts de Bitcoin Script que nous avons appris dans ce chapitre.</p>
</div>
<div id="htlc_script_example" class="exampleblock data-line-503">
<div class="title">Example 1. Un script complexe utilisé dans le Lightning Network</div>
<div class="content">
<div class="listingblock data-line-504">
<div class="content">
<pre># Vers un nœud distant avec clé de révocation
DUP HASH160 &lt;RIPEMD160(SHA256(revocationpubkey))&gt; EQUAL
IF
    CHECKSIG
ELSE
    &lt;remote_htlcpubkey&gt; SWAP SIZE 32 EQUAL
    NOTIF
# Vers le nœud local via la transaction HTLC-timeout (avec un timelock).
        DROP 2 SWAP &lt;local_htlcpubkey&gt; 2 CHECKMULTISIG
    ELSE
        # Au nœud distant avec préimage.
HASH160&lt;RIPEMD160(payment_hash)&gt; EQUALVERIFIER
        CHECKSIG
    ENDIF
ENDIF</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Rappelez-vous que la monnaie ne doit pas nécessairement être la dernière sortie d&#8217;une transaction et est en fait indiscernable des autres sorties.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. Le premier argument (0) n&#8217;a aucune signification mais est requis en raison d&#8217;un bogue dans l&#8217;implémentation multisignature de Bitcoin. Ce problème est décrit dans <em>Maîtriser Bitcoin</em>, <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch07.asciidoc" data-href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch07.asciidoc">Chapitre 7</a>.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. Depuis <a href="https://github.com/lightningnetwork/lightning-rfc/blob/master/03-transactions.md" data-href="https://github.com/lightningnetwork/lightning-rfc/blob/master/03-transactions.md">BOLT #3</a>.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-04-28 02:36:54 -0400
</div>
</div>
</body>
</html>